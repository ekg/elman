/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
======================================================================
CMA-ES Search for MOM-E88
======================================================================
Search space (4 dimensions):
  n_heads: [32, 256] (int) - Total number of memory heads
  top_k: [8, 96] (int) - Active heads per token
  n_state: [16, 64] (e88_n_state) - State dimension (only 16,32,48,64 supported)
  depth: [8, 32] (int) - Number of layers
Target params: 200M Â± 30M
Training time per config: 5.0 min
Generations: 30
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~240
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 4 (seed=768611, Wed Jan 28 16:06:19 2026)

--- Generation 1/30 ---
  [Eval 1] Skip - params 162.4M vs target 200M
  [Eval 2] GPU 1 | n_heads=173, top_k=10, n_state=32, depth=30 | dim=256 | 173.1M params
  [Eval 3] GPU 2 | n_heads=138, top_k=39, n_state=32, depth=22 | dim=512 | 202.6M params
  [Eval 4] GPU 3 | n_heads=95, top_k=69, n_state=16, depth=10 | dim=3200 | 202.0M params
  [Eval 5] GPU 4 | n_heads=117, top_k=79, n_state=16, depth=25 | dim=1024 | 198.4M params
  [Eval 6] GPU 5 | n_heads=131, top_k=77, n_state=16, depth=16 | dim=1408 | 195.5M params  [Eval 7] GPU 6 | n_heads=151, top_k=42, n_state=32, depth=17 | dim=640 | 214.1M params

  [Eval 8] GPU 7 | n_heads=164, top_k=39, n_state=48, depth=17 | dim=384 | 208.1M params
  [Eval 2] Timeout
  [Eval 4] Timeout
  [Eval 5] Timeout
  [Eval 6] Timeout
  [Eval 3] Timeout
  [Eval 7] Timeout
  [Eval 8] Timeout
  *** NEW BEST: 10.0000 | {'n_heads': 192, 'top_k': 50, 'n_state': 48, 'depth': 17} | dim=0 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.000000000000000e+01 1.0e+00 2.62e-01  2e-01  3e-01 8:15.6

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 10.0000
Best params: {'n_heads': 192, 'top_k': 50, 'n_state': 48, 'depth': 17}
Total evaluations: 8

To train with best config:
python train.py --level MoME88 --dim 256 --n_heads 192 --top_k 50 --n_state 48 --depth 17 --lr 3e-4 --expansion 1.0 --use_gate 1 --gate_activation silu --train_minutes 30
