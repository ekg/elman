/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
======================================================================
CMA-ES Search for MOM-E88
======================================================================
Search space (4 dimensions):
  n_heads: [32, 256] (int) - Total number of memory heads
  top_k: [8, 96] (int) - Active heads per token
  n_state: [16, 64] (e88_n_state) - State dimension (only 16,32,48,64 supported)
  depth: [8, 32] (int) - Number of layers
Target params: 480M Â± 50M
Training time per config: 5.0 min
Generations: 30
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~240
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 4 (seed=697403, Wed Jan 28 17:11:46 2026)

--- Generation 1/30 ---
  [Eval 8] GPU 7 | n_heads=99, top_k=88, n_state=32, depth=32 | dim=1152 | 476.0M params
  [Eval 8] Loss: 2.5244
  [Eval 1] GPU 0 | n_heads=179, top_k=64, n_state=32, depth=8 | dim=2560 | 477.9M params
  [Eval 1] Loss: 1.9982
  [Eval 3] GPU 2 | n_heads=94, top_k=10, n_state=64, depth=9 | dim=2176 | 476.8M params
  [Eval 3] Loss: 1.8510
  [Eval 7] GPU 6 | n_heads=126, top_k=95, n_state=32, depth=9 | dim=3200 | 473.5M params
  [Eval 7] Loss: 2.0751
  [Eval 5] GPU 4 | n_heads=144, top_k=53, n_state=32, depth=10 | dim=2560 | 480.7M params
  [Eval 5] Loss: 2.0064
  [Eval 2] GPU 1 | n_heads=164, top_k=52, n_state=32, depth=18 | dim=1280 | 492.3M params
  [Eval 2] Loss: 2.0063
  [Eval 6] GPU 5 | n_heads=231, top_k=90, n_state=32, depth=25 | dim=640 | 481.2M params
  [Eval 6] Loss: 2.4307
  [Eval 4] GPU 3 | n_heads=153, top_k=29, n_state=32, depth=13 | dim=1792 | 464.6M params
  [Eval 4] Loss: 1.9723
  *** NEW BEST: 1.9982 | {'n_heads': 179, 'top_k': 64, 'n_state': 32, 'depth': 8} | dim=2560 ***
  *** NEW BEST: 1.8510 | {'n_heads': 94, 'top_k': 10, 'n_state': 64, 'depth': 9} | dim=2176 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.850973333333333e+00 1.0e+00 3.32e-01  3e-01  3e-01 5:19.3

--- Generation 2/30 ---
  [Eval 15] GPU 6 | n_heads=171, top_k=18, n_state=48, depth=21 | dim=640 | 446.7M params
  [Eval 15] Loss: 2.2714
  [Eval 9] GPU 0 | n_heads=154, top_k=33, n_state=32, depth=9 | dim=2688 | 485.8M params
  [Eval 9] Loss: 1.9254
  [Eval 11] GPU 2 | n_heads=41, top_k=15, n_state=48, depth=15 | dim=3968 | 477.4M params
  [Eval 11] Loss: 1.8241
  [Eval 10] GPU 1 | n_heads=66, top_k=44, n_state=48, depth=12 | dim=3072 | 474.6M params
  [Eval 10] Loss: 1.9903
  [Eval 14] GPU 5 | n_heads=165, top_k=9, n_state=32, depth=8 | dim=2816 | 484.7M params
  [Eval 14] Loss: 1.8675
  [Eval 16] GPU 7 | n_heads=209, top_k=65, n_state=48, depth=8 | dim=1536 | 499.2M params
  [Eval 16] Loss: 2.0107
  [Eval 13] GPU 4 | n_heads=147, top_k=29, n_state=48, depth=9 | dim=1920 | 494.1M params
  [Eval 13] Loss: 2.0560
  [Eval 12] GPU 3 | n_heads=189, top_k=60, n_state=48, depth=26 | dim=512 | 488.9M params
  [Eval 12] Loss: 2.5554
  *** NEW BEST: 1.8241 | {'n_heads': 41, 'top_k': 15, 'n_state': 48, 'depth': 15} | dim=3968 ***
    2     16 1.824094117647059e+00 1.2e+00 3.85e-01  3e-01  3e-01 10:38.2

--- Generation 3/30 ---
  [Eval 17] GPU 0 | n_heads=47, top_k=16, n_state=64, depth=15 | dim=2560 | 468.8M params
  [Eval 17] Loss: 1.9724
  [Eval 18] GPU 1 | n_heads=148, top_k=14, n_state=64, depth=15 | dim=896 | 514.3M params
  [Eval 18] Loss: 2.0446
  [Eval 19] GPU 2 | n_heads=77, top_k=66, n_state=48, depth=10 | dim=3200 | 480.4M params
  [Eval 19] Loss: 1.9949
  [Eval 23] GPU 6 | n_heads=47, top_k=47, n_state=64, depth=9 | dim=4352 | 478.6M params
  [Eval 23] Loss: 2.2106
  [Eval 22] GPU 5 | n_heads=88, top_k=12, n_state=64, depth=16 | dim=1280 | 466.6M params
  [Eval 22] Loss: 2.0560
  [Eval 24] GPU 7 | n_heads=51, top_k=10, n_state=64, depth=12 | dim=3072 | 488.2M params
  [Eval 24] Loss: 1.9406
  [Eval 21] GPU 4 | n_heads=77, top_k=37, n_state=64, depth=9 | dim=2688 | 482.9M params
  [Eval 21] Loss: 1.9533
  [Eval 20] GPU 3 | n_heads=91, top_k=48, n_state=64, depth=15 | dim=1408 | 497.6M params
  [Eval 20] Loss: 2.2618
    3     24 1.940598000000000e+00 1.6e+00 4.60e-01  3e-01  3e-01 15:57.4

--- Generation 4/30 ---
  [Eval 30] GPU 5 | n_heads=49, top_k=16, n_state=48, depth=15 | dim=3328 | 477.8M params
  [Eval 30] Loss: 1.8118
  [Eval 29] GPU 4 | n_heads=63, top_k=10, n_state=64, depth=14 | dim=2048 | 468.4M params
  [Eval 29] Loss: 1.9502
  [Eval 27] GPU 2 | n_heads=124, top_k=52, n_state=48, depth=13 | dim=1536 | 481.7M params
  [Eval 27] Loss: 2.0044
  [Eval 25] GPU 0 | n_heads=33, top_k=33, n_state=64, depth=10 | dim=5632 | 484.6M params
  [Eval 25] Loss: 1.9278
  [Eval 32] GPU 7 | n_heads=67, top_k=27, n_state=64, depth=8 | dim=3456 | 480.6M params
  [Eval 32] Loss: 2.2268
  [Eval 26] GPU 1 | n_heads=137, top_k=10, n_state=64, depth=14 | dim=1024 | 507.9M params
  [Eval 26] Loss: 2.0245
  [Eval 31] GPU 6 | n_heads=101, top_k=17, n_state=64, depth=9 | dim=2048 | 482.0M params
  [Eval 31] Loss: 2.2166
  [Eval 28] GPU 3 | n_heads=110, top_k=67, n_state=48, depth=8 | dim=2816 | 482.6M params
  [Eval 28] Loss: 2.3482
  *** NEW BEST: 1.8118 | {'n_heads': 49, 'top_k': 16, 'n_state': 48, 'depth': 15} | dim=3328 ***
    4     32 1.811767647058824e+00 1.9e+00 4.72e-01  3e-01  3e-01 21:16.3

--- Generation 5/30 ---
  [Eval 35] GPU 2 | n_heads=89, top_k=8, n_state=64, depth=10 | dim=2048 | 472.1M params
  [Eval 35] Loss: 1.8203
  [Eval 33] GPU 0 | n_heads=33, top_k=20, n_state=64, depth=12 | dim=4608 | 475.6M params
  [Eval 33] Loss: 1.9830
  [Eval 38] GPU 5 | n_heads=63, top_k=34, n_state=32, depth=12 | dim=4864 | 481.2M params
  [Eval 38] Loss: 1.9109
  [Eval 37] GPU 4 | n_heads=40, top_k=17, n_state=48, depth=14 | dim=4352 | 476.9M params
  [Eval 37] Loss: 1.8191
  [Eval 40] GPU 7 | n_heads=171, top_k=9, n_state=48, depth=19 | dim=768 | 485.0M params
  [Eval 40] Loss: 2.1471
  [Eval 39] GPU 6 | n_heads=48, top_k=13, n_state=64, depth=19 | dim=2048 | 484.9M params
  [Eval 39] Loss: 1.9734
  [Eval 36] GPU 3 | n_heads=245, top_k=78, n_state=32, depth=21 | dim=768 | 514.4M params
  [Eval 36] Loss: 2.2809
  [Eval 34] GPU 1 | n_heads=122, top_k=33, n_state=48, depth=9 | dim=2304 | 492.4M params
  [Eval 34] Loss: 1.9630
    5     40 1.819065714285714e+00 2.3e+00 4.25e-01  3e-01  3e-01 26:35.5

--- Generation 6/30 ---
  [Eval 45] GPU 4 | n_heads=65, top_k=31, n_state=48, depth=17 | dim=2176 | 468.8M params
  [Eval 45] Loss: 2.1139
  [Eval 42] GPU 1 | n_heads=33, top_k=8, n_state=64, depth=9 | dim=6144 | 476.0M params
  [Eval 42] Loss: 1.8288
  [Eval 44] GPU 3 | n_heads=36, top_k=29, n_state=64, depth=11 | dim=4608 | 475.3M params
  [Eval 44] Loss: 2.0826
  [Eval 46] GPU 5 | n_heads=79, top_k=12, n_state=64, depth=8 | dim=2944 | 482.3M params
  [Eval 46] Loss: 1.8634
  [Eval 43] GPU 2 | n_heads=43, top_k=8, n_state=64, depth=13 | dim=3328 | 483.6M params
  [Eval 43] Loss: 1.9729
  [Eval 47] GPU 6 | n_heads=54, top_k=8, n_state=48, depth=17 | dim=2688 | 481.6M params
  [Eval 47] Loss: 2.1532
  [Eval 48] GPU 7 | n_heads=41, top_k=8, n_state=48, depth=9 | dim=6656 | 481.1M params
  [Eval 48] Loss: 1.7905
  [Eval 41] GPU 0 | n_heads=62, top_k=8, n_state=48, depth=9 | dim=4352 | 474.2M params
  [Eval 41] Loss: 1.8201
  *** NEW BEST: 1.7905 | {'n_heads': 41, 'top_k': 8, 'n_state': 48, 'depth': 9} | dim=6656 ***
    6     48 1.790465000000000e+00 2.2e+00 3.51e-01  2e-01  2e-01 31:54.3

--- Generation 7/30 ---
  [Eval 50] GPU 1 | n_heads=62, top_k=27, n_state=64, depth=12 | dim=2432 | 469.4M params
  [Eval 50] Loss: 2.1792
  [Eval 51] GPU 2 | n_heads=95, top_k=8, n_state=64, depth=8 | dim=2432 | 478.8M params
  [Eval 51] Loss: 1.8326
  [Eval 56] GPU 7 | n_heads=88, top_k=19, n_state=48, depth=8 | dim=3456 | 474.3M params
  [Eval 56] Loss: 1.8441
  [Eval 49] GPU 0 | n_heads=65, top_k=34, n_state=48, depth=8 | dim=4736 | 480.8M params
  [Eval 49] Loss: 1.8938
  [Eval 55] GPU 6 | n_heads=52, top_k=11, n_state=48, depth=8 | dim=5888 | 479.0M params
  [Eval 55] Loss: 1.8401
  [Eval 54] GPU 5 | n_heads=46, top_k=11, n_state=64, depth=11 | dim=3712 | 488.2M params
  [Eval 54] Loss: 1.9380
  [Eval 52] GPU 3 | n_heads=51, top_k=8, n_state=48, depth=8 | dim=6016 | 480.1M params
  [Eval 52] Loss: 1.7766
  [Eval 53] GPU 4 | n_heads=32, top_k=32, n_state=64, depth=9 | dim=6400 | 480.9M params
  [Eval 53] Loss: 1.8824
  *** NEW BEST: 1.7766 | {'n_heads': 51, 'top_k': 8, 'n_state': 48, 'depth': 8} | dim=6016 ***
    7     56 1.776559000000000e+00 2.1e+00 3.22e-01  2e-01  2e-01 37:13.2

--- Generation 8/30 ---
  [Eval 58] GPU 1 | n_heads=69, top_k=19, n_state=48, depth=12 | dim=2944 | 475.4M params
  [Eval 58] Loss: 1.9247
  [Eval 61] Skip - params 412.2M vs target 480M
  [Eval 64] GPU 7 | n_heads=46, top_k=27, n_state=48, depth=8 | dim=6656 | 479.5M params
  [Eval 64] Loss: 1.9447
  [Eval 57] GPU 0 | n_heads=39, top_k=21, n_state=64, depth=11 | dim=4352 | 485.9M params
  [Eval 57] Loss: 1.8763
  [Eval 59] GPU 2 | n_heads=74, top_k=45, n_state=64, depth=17 | dim=1536 | 500.6M params
  [Eval 59] Loss: 2.3866
  [Eval 60] GPU 3 | n_heads=71, top_k=14, n_state=48, depth=14 | dim=2432 | 471.3M params
  [Eval 60] Loss: 1.8306
  [Eval 63] GPU 6 | n_heads=44, top_k=8, n_state=64, depth=9 | dim=4608 | 474.7M params
  [Eval 63] Loss: 1.8678
  [Eval 62] GPU 5 | n_heads=32, top_k=32, n_state=48, depth=14 | dim=5504 | 483.6M params
  [Eval 62] Loss: 2.0110
    8     64 1.830564705882353e+00 2.4e+00 3.23e-01  2e-01  2e-01 42:32.2

--- Generation 9/30 ---
  [Eval 69] GPU 4 | n_heads=95, top_k=15, n_state=48, depth=14 | dim=1792 | 464.1M params
  [Eval 69] Loss: 1.8667
  [Eval 67] GPU 2 | n_heads=32, top_k=18, n_state=64, depth=12 | dim=4736 | 474.1M params
  [Eval 67] Loss: 2.0363
  [Eval 68] GPU 3 | n_heads=32, top_k=12, n_state=64, depth=14 | dim=4096 | 478.2M params
  [Eval 68] Loss: 1.9260
  [Eval 71] GPU 6 | n_heads=64, top_k=14, n_state=48, depth=8 | dim=4864 | 486.3M params
  [Eval 71] Loss: 1.8106
  [Eval 72] GPU 7 | n_heads=39, top_k=8, n_state=64, depth=9 | dim=5248 | 479.7M params
  [Eval 72] Loss: 1.7988
  [Eval 66] GPU 1 | n_heads=87, top_k=19, n_state=48, depth=8 | dim=3584 | 486.3M params
  [Eval 66] Loss: 1.8459
  [Eval 65] GPU 0 | n_heads=38, top_k=14, n_state=48, depth=14 | dim=4608 | 479.9M params
  [Eval 65] Loss: 1.8608
  [Eval 70] GPU 5 | n_heads=75, top_k=8, n_state=64, depth=16 | dim=1536 | 477.5M params
  [Eval 70] Loss: 2.0175
    9     72 1.798756097560976e+00 2.5e+00 2.87e-01  1e-01  2e-01 47:51.2

--- Generation 10/30 ---
  [Eval 78] GPU 5 | n_heads=43, top_k=9, n_state=64, depth=10 | dim=4352 | 486.8M params
  [Eval 78] Loss: 1.8396
  [Eval 76] GPU 3 | n_heads=37, top_k=15, n_state=64, depth=13 | dim=3840 | 480.8M params
  [Eval 76] Loss: 1.9664
  [Eval 79] GPU 6 | n_heads=64, top_k=20, n_state=48, depth=10 | dim=3840 | 479.6M params
  [Eval 79] Loss: 1.8938
  [Eval 75] GPU 2 | n_heads=47, top_k=28, n_state=64, depth=10 | dim=3968 | 484.8M params
  [Eval 75] Loss: 1.8436
  [Eval 74] GPU 1 | n_heads=33, top_k=11, n_state=64, depth=8 | dim=6912 | 476.2M params
  [Eval 74] Loss: 1.8869
  [Eval 80] GPU 7 | n_heads=34, top_k=12, n_state=48, depth=17 | dim=4224 | 478.3M params
  [Eval 80] Loss: 1.7848
  [Eval 73] GPU 0 | n_heads=103, top_k=8, n_state=64, depth=8 | dim=2304 | 491.6M params
  [Eval 73] Loss: 1.9406
  [Eval 77] GPU 4 | n_heads=61, top_k=17, n_state=48, depth=10 | dim=3968 | 472.5M params
  [Eval 77] Loss: 1.8915
   10     80 1.784840000000000e+00 3.1e+00 2.63e-01  1e-01  2e-01 53:10.0

--- Generation 11/30 ---
  [Eval 86] GPU 5 | n_heads=32, top_k=15, n_state=48, depth=14 | dim=5504 | 483.6M params
  [Eval 86] Loss: 1.8660
  [Eval 84] GPU 3 | n_heads=36, top_k=8, n_state=48, depth=12 | dim=5632 | 476.8M params
  [Eval 84] Loss: 1.7971
  [Eval 87] GPU 6 | n_heads=35, top_k=24, n_state=48, depth=17 | dim=4096 | 477.3M params
  [Eval 87] Loss: 1.9435
  [Eval 88] GPU 7 | n_heads=68, top_k=16, n_state=64, depth=9 | dim=3072 | 487.6M params
  [Eval 88] Loss: 1.8881
  [Eval 81] GPU 0 | n_heads=35, top_k=18, n_state=48, depth=9 | dim=7808 | 482.6M params
  [Eval 81] Loss: 1.8930
  [Eval 85] GPU 4 | n_heads=52, top_k=23, n_state=64, depth=9 | dim=3968 | 482.5M params
  [Eval 85] Loss: 2.2507
  [Eval 82] GPU 1 | n_heads=33, top_k=8, n_state=48, depth=13 | dim=5760 | 484.5M params
  [Eval 82] Loss: 1.8081
  [Eval 83] GPU 2 | n_heads=38, top_k=8, n_state=48, depth=12 | dim=5376 | 480.1M params
  [Eval 83] Loss: 1.8305
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     88 1.797078571428572e+00 3.5e+00 2.94e-01  1e-01  3e-01 58:27.2

--- Generation 12/30 ---
  [Eval 91] Skip - params 428.2M vs target 480M
  [Eval 90] GPU 1 | n_heads=60, top_k=8, n_state=16, depth=17 | dim=7040 | 477.8M params
  [Eval 90] Loss: 1.9821
  [Eval 95] GPU 6 | n_heads=32, top_k=21, n_state=48, depth=17 | dim=4480 | 477.7M params
  [Eval 95] Loss: 1.9013
  [Eval 92] GPU 3 | n_heads=37, top_k=19, n_state=64, depth=14 | dim=3584 | 483.2M params
  [Eval 92] Loss: 1.9698
  [Eval 93] GPU 4 | n_heads=69, top_k=16, n_state=32, depth=18 | dim=2944 | 477.8M params
  [Eval 93] Loss: 1.9184
  [Eval 94] GPU 5 | n_heads=61, top_k=8, n_state=32, depth=13 | dim=4608 | 478.2M params
  [Eval 94] Loss: 1.8656
  [Eval 89] GPU 0 | n_heads=32, top_k=12, n_state=48, depth=18 | dim=4224 | 476.8M params
  [Eval 89] Loss: 1.8528
  [Eval 96] GPU 7 | n_heads=52, top_k=10, n_state=16, depth=20 | dim=6912 | 478.6M params
  [Eval 96] Loss: 1.9516
   12     96 1.852758823529412e+00 4.2e+00 3.07e-01  1e-01  3e-01 63:44.3

--- Generation 13/30 ---
  [Eval 100] GPU 3 | n_heads=60, top_k=26, n_state=64, depth=17 | dim=1792 | 474.0M params
  [Eval 100] Loss: 2.2275
  [Eval 104] GPU 7 | n_heads=58, top_k=13, n_state=48, depth=10 | dim=4224 | 478.4M params
  [Eval 104] Loss: 1.8198
  [Eval 102] GPU 5 | n_heads=66, top_k=15, n_state=48, depth=19 | dim=1920 | 469.4M params
  [Eval 102] Loss: 1.9019
  [Eval 101] GPU 4 | n_heads=32, top_k=9, n_state=48, depth=14 | dim=5504 | 483.6M params
  [Eval 101] Loss: 1.8333
  [Eval 97] GPU 0 | n_heads=40, top_k=8, n_state=48, depth=12 | dim=5120 | 481.1M params
  [Eval 97] Loss: 1.8192
  [Eval 99] GPU 2 | n_heads=42, top_k=17, n_state=48, depth=14 | dim=4224 | 485.8M params
  [Eval 99] Loss: 1.9343
  [Eval 98] GPU 1 | n_heads=43, top_k=18, n_state=48, depth=11 | dim=5248 | 485.7M params
  [Eval 98] Loss: 1.8485
  [Eval 103] GPU 6 | n_heads=39, top_k=18, n_state=48, depth=12 | dim=5248 | 480.9M params
  [Eval 103] Loss: 1.8902
   13    104 1.819160000000000e+00 4.4e+00 2.71e-01  1e-01  2e-01 69:02.6

--- Generation 14/30 ---
  [Eval 105] GPU 0 | n_heads=58, top_k=11, n_state=48, depth=15 | dim=2816 | 478.1M params
  [Eval 105] Loss: 1.8613
  [Eval 107] GPU 2 | n_heads=113, top_k=8, n_state=32, depth=13 | dim=2560 | 490.6M params
  [Eval 107] Loss: 1.9237
  [Eval 109] GPU 4 | n_heads=40, top_k=8, n_state=32, depth=16 | dim=5760 | 483.8M params
  [Eval 109] Loss: 1.8574
  [Eval 111] GPU 6 | n_heads=33, top_k=8, n_state=48, depth=10 | dim=7424 | 480.8M params
  [Eval 111] Loss: 1.8492
  [Eval 108] GPU 3 | n_heads=76, top_k=12, n_state=48, depth=15 | dim=2176 | 483.4M params
  [Eval 108] Loss: 1.9939
  [Eval 112] GPU 7 | n_heads=77, top_k=8, n_state=32, depth=15 | dim=3200 | 482.9M params
  [Eval 112] Loss: 1.8835
  [Eval 106] GPU 1 | n_heads=38, top_k=17, n_state=64, depth=8 | dim=6016 | 476.5M params
  [Eval 106] Loss: 1.8608
  [Eval 110] GPU 5 | n_heads=38, top_k=10, n_state=64, depth=10 | dim=4864 | 481.3M params
  [Eval 110] Loss: 1.8400
   14    112 1.840015000000000e+00 4.6e+00 2.39e-01  9e-02  2e-01 74:20.3

--- Generation 15/30 ---
  [Eval 120] GPU 7 | n_heads=53, top_k=11, n_state=48, depth=11 | dim=4224 | 481.1M params
  [Eval 120] Loss: 1.8347
  [Eval 116] GPU 3 | n_heads=36, top_k=11, n_state=64, depth=9 | dim=5632 | 475.5M params
  [Eval 116] Loss: 1.8676
  [Eval 119] GPU 6 | n_heads=45, top_k=9, n_state=64, depth=15 | dim=2688 | 471.4M params
  [Eval 119] Loss: 1.9480
  [Eval 117] GPU 4 | n_heads=33, top_k=10, n_state=48, depth=14 | dim=5248 | 475.3M params
  [Eval 117] Loss: 1.7839
  [Eval 113] GPU 0 | n_heads=33, top_k=8, n_state=48, depth=12 | dim=6144 | 477.2M params
  [Eval 113] Loss: 1.8890
  [Eval 114] GPU 1 | n_heads=42, top_k=9, n_state=64, depth=8 | dim=5504 | 481.4M params
  [Eval 114] Loss: 1.7686
  [Eval 115] GPU 2 | n_heads=33, top_k=10, n_state=64, depth=10 | dim=5632 | 484.6M params
  [Eval 115] Loss: 1.8596
  [Eval 118] GPU 5 | n_heads=52, top_k=8, n_state=64, depth=9 | dim=3968 | 482.5M params
  [Eval 118] Loss: 1.8049
  *** NEW BEST: 1.7686 | {'n_heads': 42, 'top_k': 9, 'n_state': 64, 'depth': 8} | dim=5504 ***
   15    120 1.768557000000000e+00 4.4e+00 2.26e-01  8e-02  2e-01 79:38.4

--- Generation 16/30 ---
  [Eval 124] Skip - params 424.9M vs target 480M
  [Eval 125] GPU 4 | n_heads=33, top_k=9, n_state=48, depth=11 | dim=6784 | 483.1M params
  [Eval 125] Loss: 1.8337
  [Eval 123] GPU 2 | n_heads=50, top_k=8, n_state=64, depth=11 | dim=3328 | 475.5M params
  [Eval 123] Loss: 1.8286
  [Eval 127] GPU 6 | n_heads=40, top_k=22, n_state=64, depth=9 | dim=5120 | 479.9M params
  [Eval 127] Loss: 1.9877
  [Eval 122] GPU 1 | n_heads=35, top_k=9, n_state=48, depth=10 | dim=7040 | 483.3M params
  [Eval 122] Loss: 1.8501
  [Eval 121] GPU 0 | n_heads=52, top_k=11, n_state=64, depth=10 | dim=3584 | 484.1M params
  [Eval 121] Loss: 1.8930
  [Eval 128] GPU 7 | n_heads=41, top_k=13, n_state=64, depth=8 | dim=5632 | 481.0M params
  [Eval 128] Loss: 1.8164
  [Eval 126] GPU 5 | n_heads=33, top_k=14, n_state=48, depth=16 | dim=4608 | 476.8M params
  [Eval 126] Loss: 1.8579
   16    128 1.816394000000000e+00 4.3e+00 1.84e-01  6e-02  1e-01 84:55.6

--- Generation 17/30 ---
  [Eval 129] GPU 0 | n_heads=54, top_k=9, n_state=48, depth=9 | dim=4992 | 474.2M params
  [Eval 129] Loss: 1.8675
  [Eval 136] GPU 7 | n_heads=44, top_k=19, n_state=64, depth=12 | dim=3456 | 474.4M params
  [Eval 136] Loss: 1.9549
  [Eval 131] GPU 2 | n_heads=36, top_k=10, n_state=64, depth=9 | dim=5632 | 475.5M params
  [Eval 131] Loss: 1.8678
  [Eval 132] GPU 3 | n_heads=32, top_k=10, n_state=64, depth=10 | dim=5760 | 480.8M params
  [Eval 132] Loss: 1.8214
  [Eval 133] GPU 4 | n_heads=34, top_k=8, n_state=48, depth=9 | dim=7936 | 476.7M params
  [Eval 133] Loss: 1.8824
  [Eval 135] GPU 6 | n_heads=32, top_k=8, n_state=64, depth=12 | dim=4736 | 474.1M params
  [Eval 135] Loss: 1.8298
  [Eval 130] GPU 1 | n_heads=35, top_k=12, n_state=64, depth=10 | dim=5248 | 478.7M params
  [Eval 130] Loss: 1.8573
  [Eval 134] GPU 5 | n_heads=32, top_k=15, n_state=64, depth=8 | dim=7168 | 479.0M params
  [Eval 134] Loss: 1.9272
   17    136 1.821389000000000e+00 4.2e+00 1.38e-01  4e-02  1e-01 90:13.2

--- Generation 18/30 ---
  [Eval 141] GPU 4 | n_heads=36, top_k=11, n_state=48, depth=11 | dim=6144 | 476.9M params
  [Eval 141] Loss: 1.8230
  [Eval 144] GPU 7 | n_heads=33, top_k=8, n_state=64, depth=11 | dim=5120 | 484.5M params
  [Eval 144] Loss: 1.8542
  [Eval 138] GPU 1 | n_heads=32, top_k=9, n_state=48, depth=12 | dim=6400 | 482.2M params
  [Eval 138] Loss: 1.8164
  [Eval 137] GPU 0 | n_heads=32, top_k=9, n_state=64, depth=8 | dim=7168 | 479.0M params
  [Eval 137] Loss: 1.8333
  [Eval 143] GPU 6 | n_heads=32, top_k=8, n_state=64, depth=9 | dim=6400 | 480.9M params
  [Eval 143] Loss: 1.8316
  [Eval 140] GPU 3 | n_heads=37, top_k=12, n_state=64, depth=9 | dim=5504 | 477.5M params
  [Eval 140] Loss: 1.8760
  [Eval 139] GPU 2 | n_heads=60, top_k=8, n_state=48, depth=10 | dim=4096 | 479.8M params
  [Eval 139] Loss: 1.8648
  [Eval 142] GPU 5 | n_heads=32, top_k=8, n_state=64, depth=9 | dim=6400 | 480.9M params
  [Eval 142] Loss: 1.8110
   18    144 1.811018000000000e+00 4.4e+00 1.14e-01  3e-02  8e-02 95:30.8

--- Generation 19/30 ---
  [Eval 148] GPU 3 | n_heads=32, top_k=8, n_state=64, depth=10 | dim=5760 | 480.8M params
  [Eval 148] Loss: 1.8296
  [Eval 145] GPU 0 | n_heads=32, top_k=8, n_state=48, depth=13 | dim=5888 | 480.4M params
  [Eval 145] Loss: 1.8164
  [Eval 146] GPU 1 | n_heads=33, top_k=9, n_state=48, depth=11 | dim=6784 | 483.1M params
  [Eval 146] Loss: 1.8141
  [Eval 149] GPU 4 | n_heads=33, top_k=8, n_state=48, depth=11 | dim=6784 | 483.1M params
  [Eval 149] Loss: 1.8260
  [Eval 147] GPU 2 | n_heads=34, top_k=8, n_state=48, depth=9 | dim=7936 | 476.7M params
  [Eval 147] Loss: 1.8824
  [Eval 150] GPU 5 | n_heads=32, top_k=9, n_state=64, depth=8 | dim=7168 | 479.0M params
  [Eval 150] Loss: 1.8599
  [Eval 152] GPU 7 | n_heads=32, top_k=8, n_state=64, depth=11 | dim=5248 | 481.7M params
  [Eval 152] Loss: 1.8257
  [Eval 151] GPU 6 | n_heads=32, top_k=9, n_state=48, depth=11 | dim=6912 | 477.5M params
  [Eval 151] Loss: 1.8389
   19    152 1.814116000000000e+00 4.1e+00 1.25e-01  3e-02  9e-02 100:48.2

--- Generation 20/30 ---
  [Eval 159] GPU 6 | n_heads=32, top_k=10, n_state=64, depth=10 | dim=5760 | 480.8M params
  [Eval 159] Loss: 1.8441
  [Eval 155] GPU 2 | n_heads=35, top_k=9, n_state=48, depth=11 | dim=6400 | 483.1M params
  [Eval 155] Loss: 1.8622
  [Eval 160] GPU 7 | n_heads=40, top_k=8, n_state=48, depth=13 | dim=4736 | 482.0M params
  [Eval 160] Loss: 1.8076
  [Eval 154] GPU 1 | n_heads=38, top_k=9, n_state=64, depth=12 | dim=4096 | 486.1M params
  [Eval 154] Loss: 1.8919
  [Eval 157] GPU 4 | n_heads=38, top_k=9, n_state=64, depth=8 | dim=6016 | 476.5M params
  [Eval 157] Loss: 1.8108
  [Eval 158] GPU 5 | n_heads=32, top_k=8, n_state=48, depth=13 | dim=5888 | 480.4M params
  [Eval 158] Loss: 1.8212
  [Eval 153] GPU 0 | n_heads=32, top_k=9, n_state=48, depth=11 | dim=6912 | 477.5M params
  [Eval 153] Loss: 1.8376
  [Eval 156] GPU 3 | n_heads=38, top_k=9, n_state=48, depth=11 | dim=5888 | 482.2M params
  [Eval 156] Loss: 1.8257
   20    160 1.807606000000000e+00 5.0e+00 1.25e-01  3e-02  9e-02 106:05.9

--- Generation 21/30 ---
  [Eval 165] GPU 4 | n_heads=33, top_k=10, n_state=64, depth=8 | dim=6912 | 476.2M params
  [Eval 165] Loss: 1.8426
  [Eval 162] GPU 1 | n_heads=44, top_k=8, n_state=64, depth=9 | dim=4608 | 474.7M params
  [Eval 162] Loss: 1.8297
  [Eval 167] GPU 6 | n_heads=34, top_k=8, n_state=64, depth=11 | dim=4864 | 474.1M params
  [Eval 167] Loss: 1.7804
  [Eval 161] GPU 0 | n_heads=34, top_k=9, n_state=64, depth=9 | dim=6016 | 480.0M params
  [Eval 161] Loss: 1.8410
  [Eval 166] GPU 5 | n_heads=32, top_k=8, n_state=64, depth=10 | dim=5760 | 480.8M params
  [Eval 166] Loss: 1.8219
  [Eval 168] GPU 7 | n_heads=39, top_k=11, n_state=64, depth=9 | dim=5248 | 479.7M params
  [Eval 168] Loss: 1.8020
  [Eval 164] GPU 3 | n_heads=43, top_k=10, n_state=48, depth=13 | dim=4352 | 475.8M params
  [Eval 164] Loss: 1.8805
  [Eval 163] GPU 2 | n_heads=46, top_k=9, n_state=48, depth=14 | dim=3840 | 483.4M params
  [Eval 163] Loss: 1.8916
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   21    168 1.780428947368421e+00 5.0e+00 1.04e-01  2e-02  8e-02 111:23.7

--- Generation 22/30 ---
  [Eval 174] GPU 5 | n_heads=32, top_k=9, n_state=48, depth=11 | dim=6912 | 477.5M params
  [Eval 174] Loss: 1.8229
  [Eval 169] GPU 0 | n_heads=33, top_k=9, n_state=48, depth=10 | dim=7424 | 480.8M params
  [Eval 169] Loss: 1.8612
  [Eval 172] GPU 3 | n_heads=41, top_k=8, n_state=64, depth=12 | dim=3712 | 475.0M params
  [Eval 172] Loss: 1.7807
  [Eval 171] GPU 2 | n_heads=37, top_k=8, n_state=64, depth=12 | dim=4096 | 473.5M params
  [Eval 171] Loss: 1.8109
  [Eval 170] GPU 1 | n_heads=34, top_k=10, n_state=64, depth=8 | dim=6784 | 481.3M params
  [Eval 170] Loss: 1.8048
  [Eval 173] GPU 4 | n_heads=37, top_k=8, n_state=64, depth=9 | dim=5504 | 477.5M params
  [Eval 173] Loss: 1.7897
  [Eval 176] GPU 7 | n_heads=34, top_k=8, n_state=48, depth=12 | dim=6016 | 481.3M params
  [Eval 176] Loss: 1.8183
  [Eval 175] GPU 6 | n_heads=32, top_k=10, n_state=64, depth=9 | dim=6400 | 480.9M params
  [Eval 175] Loss: 1.8327
   22    176 1.780721621621622e+00 5.1e+00 9.70e-02  2e-02  7e-02 116:42.9

--- Generation 23/30 ---
  [Eval 177] GPU 0 | n_heads=40, top_k=9, n_state=64, depth=9 | dim=5120 | 479.9M params
  [Eval 177] Loss: 1.8621
  [Eval 180] GPU 3 | n_heads=40, top_k=8, n_state=48, depth=13 | dim=4736 | 482.0M params
  [Eval 180] Loss: 1.7965
  [Eval 184] GPU 7 | n_heads=38, top_k=8, n_state=64, depth=9 | dim=5376 | 478.9M params
  [Eval 184] Loss: 1.8524
  [Eval 182] GPU 5 | n_heads=43, top_k=8, n_state=64, depth=10 | dim=4352 | 486.8M params
  [Eval 182] Loss: 1.8369
  [Eval 178] GPU 1 | n_heads=35, top_k=8, n_state=48, depth=12 | dim=5888 | 484.7M params
  [Eval 178] Loss: 1.8146
  [Eval 183] GPU 6 | n_heads=39, top_k=8, n_state=64, depth=12 | dim=3968 | 483.2M params
  [Eval 183] Loss: 1.9010
  [Eval 181] GPU 4 | n_heads=43, top_k=8, n_state=64, depth=10 | dim=4352 | 486.8M params
  [Eval 181] Loss: 1.8426
  [Eval 179] GPU 2 | n_heads=35, top_k=8, n_state=64, depth=11 | dim=4736 | 475.0M params
  [Eval 179] Loss: 1.8286
   23    184 1.796462000000000e+00 4.9e+00 1.03e-01  2e-02  8e-02 122:01.8

--- Generation 24/30 ---
  [Eval 187] GPU 2 | n_heads=33, top_k=8, n_state=48, depth=13 | dim=5760 | 484.5M params
  [Eval 187] Loss: 1.8300
  [Eval 186] GPU 1 | n_heads=32, top_k=8, n_state=48, depth=12 | dim=6400 | 482.2M params
  [Eval 186] Loss: 1.8032
  [Eval 190] GPU 5 | n_heads=42, top_k=8, n_state=48, depth=14 | dim=4224 | 485.8M params
  [Eval 190] Loss: 1.8588
  [Eval 191] GPU 6 | n_heads=33, top_k=8, n_state=48, depth=12 | dim=6144 | 477.2M params
  [Eval 191] Loss: 1.8297
  [Eval 185] GPU 0 | n_heads=36, top_k=8, n_state=48, depth=13 | dim=5248 | 481.2M params
  [Eval 185] Loss: 1.8275
  [Eval 188] GPU 3 | n_heads=34, top_k=8, n_state=48, depth=12 | dim=6016 | 481.3M params
  [Eval 188] Loss: 1.8156
  [Eval 192] GPU 7 | n_heads=32, top_k=8, n_state=64, depth=11 | dim=5248 | 481.7M params
  [Eval 192] Loss: 1.8277
  [Eval 189] GPU 4 | n_heads=47, top_k=8, n_state=48, depth=12 | dim=4352 | 479.9M params
  [Eval 189] Loss: 1.8604
   24    192 1.803169000000000e+00 5.7e+00 1.02e-01  2e-02  8e-02 127:21.5

--- Generation 25/30 ---
  [Eval 197] GPU 4 | n_heads=35, top_k=8, n_state=48, depth=13 | dim=5376 | 479.3M params
  [Eval 197] Loss: 1.8567
  [Eval 195] GPU 2 | n_heads=38, top_k=9, n_state=64, depth=11 | dim=4352 | 473.6M params
  [Eval 195] Loss: 1.8067
  [Eval 199] GPU 6 | n_heads=33, top_k=8, n_state=48, depth=14 | dim=5248 | 475.3M params
  [Eval 199] Loss: 1.8342
  [Eval 194] GPU 1 | n_heads=33, top_k=8, n_state=48, depth=12 | dim=6144 | 477.2M params
  [Eval 194] Loss: 1.8517
  [Eval 193] GPU 0 | n_heads=48, top_k=8, n_state=48, depth=13 | dim=3968 | 483.9M params
  [Eval 193] Loss: 1.8287
  [Eval 198] GPU 5 | n_heads=43, top_k=8, n_state=48, depth=14 | dim=4096 | 482.2M params
  [Eval 198] Loss: 1.8662
  [Eval 200] GPU 7 | n_heads=39, top_k=8, n_state=48, depth=12 | dim=5248 | 480.9M params
  [Eval 200] Loss: 1.8230
  [Eval 196] GPU 3 | n_heads=32, top_k=8, n_state=64, depth=10 | dim=5760 | 480.8M params
  [Eval 196] Loss: 1.8400
   25    200 1.806728125000000e+00 6.1e+00 9.21e-02  2e-02  7e-02 132:40.3

--- Generation 26/30 ---
  [Eval 202] GPU 1 | n_heads=38, top_k=9, n_state=64, depth=10 | dim=4864 | 481.3M params
  [Eval 202] Loss: 1.8095
  [Eval 204] GPU 3 | n_heads=59, top_k=8, n_state=64, depth=11 | dim=2816 | 474.3M params
  [Eval 204] Loss: 1.7990
  [Eval 203] GPU 2 | n_heads=34, top_k=8, n_state=48, depth=11 | dim=6528 | 478.8M params
  [Eval 203] Loss: 1.8537
  [Eval 201] GPU 0 | n_heads=40, top_k=8, n_state=64, depth=12 | dim=3840 | 479.5M params
  [Eval 201] Loss: 1.7620
  [Eval 205] GPU 4 | n_heads=44, top_k=8, n_state=64, depth=12 | dim=3456 | 474.4M params
  [Eval 205] Loss: 1.8163
  [Eval 207] GPU 6 | n_heads=49, top_k=8, n_state=64, depth=10 | dim=3712 | 472.6M params
  [Eval 207] Loss: 1.8310
  [Eval 206] GPU 5 | n_heads=41, top_k=9, n_state=64, depth=11 | dim=4096 | 480.6M params
  [Eval 206] Loss: 1.8663
  [Eval 208] GPU 7 | n_heads=39, top_k=8, n_state=64, depth=11 | dim=4352 | 485.9M params
  [Eval 208] Loss: 1.8646
  *** NEW BEST: 1.7620 | {'n_heads': 40, 'top_k': 8, 'n_state': 64, 'depth': 12} | dim=3840 ***
   26    208 1.762018918918919e+00 6.4e+00 9.47e-02  2e-02  8e-02 137:58.6

--- Generation 27/30 ---
  [Eval 209] GPU 0 | n_heads=62, top_k=8, n_state=64, depth=12 | dim=2432 | 469.4M params
  [Eval 209] Loss: 1.8653
  [Eval 215] GPU 6 | n_heads=58, top_k=9, n_state=64, depth=11 | dim=2944 | 487.5M params
  [Eval 215] Loss: 1.9935
  [Eval 211] GPU 2 | n_heads=42, top_k=8, n_state=48, depth=13 | dim=4480 | 478.5M params
  [Eval 211] Loss: 1.7992
  [Eval 213] GPU 4 | n_heads=41, top_k=8, n_state=64, depth=12 | dim=3712 | 475.0M params
  [Eval 213] Loss: 1.7722
  [Eval 212] GPU 3 | n_heads=45, top_k=8, n_state=64, depth=12 | dim=3456 | 485.1M params
  [Eval 212] Loss: 1.9036
  [Eval 210] GPU 1 | n_heads=46, top_k=8, n_state=64, depth=10 | dim=3968 | 474.5M params
  [Eval 210] Loss: 1.7837
  [Eval 216] GPU 7 | n_heads=41, top_k=8, n_state=64, depth=11 | dim=4096 | 480.6M params
  [Eval 216] Loss: 1.8591
  [Eval 214] GPU 5 | n_heads=40, top_k=8, n_state=64, depth=11 | dim=4224 | 483.6M params
  [Eval 214] Loss: 1.8552
   27    216 1.772172222222222e+00 6.2e+00 8.69e-02  2e-02  7e-02 143:17.3

--- Generation 28/30 ---
  [Eval 220] GPU 3 | n_heads=50, top_k=8, n_state=64, depth=13 | dim=2816 | 475.3M params
  [Eval 220] Loss: 1.8327
  [Eval 217] GPU 0 | n_heads=36, top_k=8, n_state=64, depth=12 | dim=4224 | 475.2M params
  [Eval 217] Loss: 1.7771
  [Eval 219] GPU 2 | n_heads=51, top_k=8, n_state=64, depth=12 | dim=3072 | 488.2M params
  [Eval 219] Loss: 1.9564
  [Eval 218] GPU 1 | n_heads=50, top_k=8, n_state=48, depth=13 | dim=3840 | 487.7M params
  [Eval 218] Loss: 1.8432
  [Eval 221] GPU 4 | n_heads=41, top_k=9, n_state=64, depth=12 | dim=3712 | 475.0M params
  [Eval 221] Loss: 1.8739
  [Eval 224] GPU 7 | n_heads=33, top_k=9, n_state=64, depth=11 | dim=5120 | 484.5M params
  [Eval 224] Loss: 1.8864
  [Eval 223] GPU 6 | n_heads=49, top_k=8, n_state=64, depth=12 | dim=3200 | 488.8M params
  [Eval 223] Loss: 1.9909
  [Eval 222] GPU 5 | n_heads=48, top_k=8, n_state=64, depth=12 | dim=3200 | 478.9M params
  [Eval 222] Loss: 1.8320
   28    224 1.777052631578947e+00 6.1e+00 8.26e-02  2e-02  6e-02 148:36.0

--- Generation 29/30 ---
  [Eval 230] GPU 5 | n_heads=45, top_k=8, n_state=48, depth=14 | dim=3840 | 472.9M params
  [Eval 230] Loss: 1.7957
  [Eval 229] GPU 4 | n_heads=44, top_k=8, n_state=64, depth=12 | dim=3456 | 474.4M params
  [Eval 229] Loss: 1.8183
  [Eval 231] GPU 6 | n_heads=42, top_k=8, n_state=48, depth=12 | dim=4864 | 479.7M params
  [Eval 231] Loss: 1.8716
  [Eval 225] GPU 0 | n_heads=34, top_k=8, n_state=48, depth=13 | dim=5504 | 476.9M params
  [Eval 225] Loss: 1.8514
  [Eval 227] GPU 2 | n_heads=37, top_k=8, n_state=48, depth=13 | dim=5120 | 482.3M params
  [Eval 227] Loss: 1.8365
  [Eval 226] GPU 1 | n_heads=47, top_k=8, n_state=48, depth=13 | dim=3968 | 473.9M params
  [Eval 226] Loss: 1.7968
  [Eval 232] GPU 7 | n_heads=45, top_k=8, n_state=48, depth=13 | dim=4224 | 483.2M params
  [Eval 232] Loss: 1.8183
  [Eval 228] GPU 3 | n_heads=35, top_k=8, n_state=48, depth=13 | dim=5376 | 479.3M params
  [Eval 228] Loss: 1.7992
   29    232 1.795718421052632e+00 7.0e+00 1.04e-01  2e-02  9e-02 153:54.3

--- Generation 30/30 ---
  [Eval 237] GPU 4 | n_heads=60, top_k=9, n_state=48, depth=14 | dim=2944 | 482.5M params
  [Eval 237] Loss: 1.9274
  [Eval 234] GPU 1 | n_heads=56, top_k=8, n_state=64, depth=10 | dim=3328 | 483.8M params
  [Eval 234] Loss: 1.8558
  [Eval 238] GPU 5 | n_heads=39, top_k=8, n_state=48, depth=13 | dim=4864 | 482.8M params
  [Eval 238] Loss: 1.8343
  [Eval 236] GPU 3 | n_heads=32, top_k=8, n_state=48, depth=12 | dim=6400 | 482.2M params
  [Eval 236] Loss: 1.8140
  [Eval 233] GPU 0 | n_heads=46, top_k=9, n_state=48, depth=17 | dim=3200 | 489.0M params
  [Eval 233] Loss: 2.1359
  [Eval 239] GPU 6 | n_heads=38, top_k=8, n_state=64, depth=11 | dim=4352 | 473.6M params
  [Eval 239] Loss: 1.7765
  [Eval 235] GPU 2 | n_heads=49, top_k=8, n_state=48, depth=15 | dim=3328 | 477.8M params
  [Eval 235] Loss: 1.8435
  [Eval 240] GPU 7 | n_heads=57, top_k=8, n_state=48, depth=13 | dim=3328 | 481.4M params
  [Eval 240] Loss: 1.8583
   30    240 1.776524324324324e+00 8.0e+00 1.02e-01  2e-02  9e-02 159:13.0

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.7620
Best params: {'n_heads': 40, 'top_k': 8, 'n_state': 64, 'depth': 12}
Total evaluations: 240

To train with best config:
python train.py --level MoME88 --dim 3840 --n_heads 40 --top_k 8 --n_state 64 --depth 12 --lr 3e-4 --expansion 1.0 --use_gate 1 --gate_activation silu --train_minutes 30
