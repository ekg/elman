# Job 3: 0
# GPU: 3
# Command: python train.py --level 0 --dim 640 --expansion 2.0 --data data/pile.txt --depth 20 --batch_size 32 --chunk_size 512 --lr 3e-4 --warmup_steps 100 --seed 42 --bf16 --train_minutes 10 --output benchmark_results/all_models_20260119_213946/0
# Started: 2026-01-19T21:39:56.176962
============================================================

Using device: cuda
Output directory: benchmark_results/all_models_20260119_213946/0/level0_100m_20260119_214002
Auto r_h_mode: none (level 0 has bounded/no W_h)
Model: Level 0, 131,300,480 parameters

Starting training from step 0...
Batch size: 32, Chunk size: 512
Gradient accumulation: 1, Effective batch: 32

Time-based training: 10.0 minutes
step     10 | loss 5.2726 | lr 2.70e-05 | grad 12.81 | tok/s 18644
step     20 | loss 4.0324 | lr 5.70e-05 | grad 14.25 | tok/s 44043
step     30 | loss 4.4245 | lr 8.70e-05 | grad 5.84 | tok/s 46704
step     40 | loss 3.3345 | lr 1.17e-04 | grad 3.81 | tok/s 46459
step     50 | loss 2.7165 | lr 1.47e-04 | grad 3.41 | tok/s 46429
step     60 | loss 2.8684 | lr 1.77e-04 | grad 4.25 | tok/s 45545
step     70 | loss 2.5295 | lr 2.07e-04 | grad 2.11 | tok/s 43944
step     80 | loss 2.8494 | lr 2.37e-04 | grad 3.00 | tok/s 45595
step     90 | loss 2.7706 | lr 2.67e-04 | grad 3.36 | tok/s 44053
step    100 | loss 2.4027 | lr 2.97e-04 | grad 1.08 | tok/s 44547
step    110 | loss 2.4683 | lr 6.94e-06 | grad 2.09 | tok/s 41586
step    120 | loss 2.6418 | lr 2.69e-05 | grad 1.15 | tok/s 41533
step    130 | loss 2.5171 | lr 5.89e-05 | grad 0.91 | tok/s 42416
step    140 | loss 2.2858 | lr 9.99e-05 | grad 0.78 | tok/s 42574
step    150 | loss 2.1846 | lr 1.46e-04 | grad 1.63 | tok/s 40622
step    160 | loss 2.0882 | lr 1.92e-04 | grad 1.25 | tok/s 41054
step    170 | loss 2.2938 | lr 2.35e-04 | grad 2.88 | tok/s 42439
step    180 | loss 2.2917 | lr 2.69e-04 | grad 1.16 | tok/s 42587
step    190 | loss 2.0236 | lr 2.91e-04 | grad 1.05 | tok/s 43188
step    200 | loss 1.6918 | lr 3.00e-04 | grad 1.00 | tok/s 44937
step    210 | loss 2.3277 | lr 2.94e-04 | grad 1.34 | tok/s 43366
step    220 | loss 2.1748 | lr 2.74e-04 | grad 0.83 | tok/s 44741
step    230 | loss 2.0282 | lr 2.42e-04 | grad 1.01 | tok/s 43098
step    240 | loss 2.0282 | lr 2.01e-04 | grad 1.25 | tok/s 43858
step    250 | loss 2.0089 | lr 1.55e-04 | grad 0.97 | tok/s 43418
step    260 | loss 2.0667 | lr 1.09e-04 | grad 0.54 | tok/s 41576
step    270 | loss 1.9255 | lr 6.65e-05 | grad 0.73 | tok/s 43021
step    280 | loss 1.8174 | lr 3.24e-05 | grad 1.23 | tok/s 42997
step    290 | loss 1.8245 | lr 9.84e-06 | grad 0.67 | tok/s 45247
step    300 | loss 1.7918 | lr 1.07e-06 | grad 0.64 | tok/s 45648
step    310 | loss 1.7901 | lr 6.94e-06 | grad 0.58 | tok/s 45261
step    320 | loss 1.8840 | lr 2.69e-05 | grad 1.59 | tok/s 43642
step    330 | loss 1.9105 | lr 5.89e-05 | grad 0.52 | tok/s 42761
step    340 | loss 1.9239 | lr 9.99e-05 | grad 1.42 | tok/s 43547
step    350 | loss 1.9194 | lr 1.46e-04 | grad 0.70 | tok/s 42121
step    360 | loss 1.8907 | lr 1.92e-04 | grad 1.65 | tok/s 42413
step    370 | loss 1.7458 | lr 2.35e-04 | grad 0.81 | tok/s 43544
step    380 | loss 2.2252 | lr 2.69e-04 | grad 0.87 | tok/s 44990
step    390 | loss 1.9125 | lr 2.91e-04 | grad 0.98 | tok/s 42920
step    400 | loss 2.0073 | lr 3.00e-04 | grad 2.16 | tok/s 43952
step    410 | loss 1.7568 | lr 2.94e-04 | grad 1.62 | tok/s 42304
step    420 | loss 1.8853 | lr 2.74e-04 | grad 0.86 | tok/s 42402
step    430 | loss 2.0292 | lr 2.42e-04 | grad 0.92 | tok/s 42481
step    440 | loss 2.0275 | lr 2.01e-04 | grad 0.63 | tok/s 44057
step    450 | loss 1.8315 | lr 1.55e-04 | grad 0.56 | tok/s 42844
step    460 | loss 1.7970 | lr 1.09e-04 | grad 0.53 | tok/s 42689
step    470 | loss 1.7832 | lr 6.65e-05 | grad 0.74 | tok/s 43730
step    480 | loss 1.6729 | lr 3.24e-05 | grad 0.47 | tok/s 42069
step    490 | loss 1.6569 | lr 9.84e-06 | grad 0.44 | tok/s 43114
step    500 | loss 2.5512 | lr 1.07e-06 | grad 0.76 | tok/s 44068
step    510 | loss 1.6677 | lr 6.94e-06 | grad 0.50 | tok/s 43303
step    520 | loss 1.7425 | lr 2.69e-05 | grad 0.43 | tok/s 44497
step    530 | loss 2.2463 | lr 5.89e-05 | grad 0.45 | tok/s 43309
step    540 | loss 1.6720 | lr 9.99e-05 | grad 0.77 | tok/s 43474
step    550 | loss 1.5745 | lr 1.46e-04 | grad 0.53 | tok/s 45200
step    560 | loss 1.4397 | lr 1.92e-04 | grad 0.48 | tok/s 45299
step    570 | loss 1.7025 | lr 2.35e-04 | grad 1.55 | tok/s 44354
step    580 | loss 2.0088 | lr 2.69e-04 | grad 0.88 | tok/s 43738
step    590 | loss 2.2882 | lr 2.91e-04 | grad 0.99 | tok/s 42871
step    600 | loss 1.8290 | lr 3.00e-04 | grad 1.14 | tok/s 43028
step    610 | loss 1.7854 | lr 2.94e-04 | grad 1.01 | tok/s 44791
step    620 | loss 1.7620 | lr 2.74e-04 | grad 0.65 | tok/s 42650
step    630 | loss 1.6475 | lr 2.42e-04 | grad 0.63 | tok/s 44028
step    640 | loss 1.9255 | lr 2.01e-04 | grad 0.66 | tok/s 44422
step    650 | loss 1.6830 | lr 1.55e-04 | grad 0.80 | tok/s 43240
step    660 | loss 2.0076 | lr 1.09e-04 | grad 4.12 | tok/s 43000
step    670 | loss 1.8145 | lr 6.65e-05 | grad 1.24 | tok/s 44156
step    680 | loss 1.7701 | lr 3.24e-05 | grad 0.75 | tok/s 42528
step    690 | loss 1.7690 | lr 9.84e-06 | grad 1.02 | tok/s 43456
step    700 | loss 1.8837 | lr 1.07e-06 | grad 1.08 | tok/s 43011
step    710 | loss 1.8054 | lr 6.94e-06 | grad 0.82 | tok/s 43632
step    720 | loss 1.8785 | lr 2.68e-05 | grad 1.05 | tok/s 43466
step    730 | loss 1.8604 | lr 5.89e-05 | grad 0.93 | tok/s 43556
step    740 | loss 1.8070 | lr 9.99e-05 | grad 1.35 | tok/s 43436
step    750 | loss 1.6061 | lr 1.46e-04 | grad 0.96 | tok/s 42715
step    760 | loss 1.9865 | lr 1.92e-04 | grad 0.50 | tok/s 43323
step    770 | loss 1.6454 | lr 2.35e-04 | grad 0.90 | tok/s 43517
step    780 | loss 1.7019 | lr 2.69e-04 | grad 0.65 | tok/s 43244
step    790 | loss 1.6226 | lr 2.91e-04 | grad 0.51 | tok/s 43986
step    800 | loss 1.6155 | lr 3.00e-04 | grad 0.76 | tok/s 44169
step    810 | loss 1.7266 | lr 2.94e-04 | grad 1.32 | tok/s 43268
step    820 | loss 2.4014 | lr 2.74e-04 | grad 0.98 | tok/s 44862
step    830 | loss 1.8104 | lr 2.42e-04 | grad 0.57 | tok/s 45626
step    840 | loss 1.5086 | lr 2.01e-04 | grad 0.49 | tok/s 45306
step    850 | loss 2.0464 | lr 1.55e-04 | grad 1.05 | tok/s 43751
step    860 | loss 1.7629 | lr 1.09e-04 | grad 0.78 | tok/s 42248
step    870 | loss 1.6897 | lr 6.65e-05 | grad 0.67 | tok/s 43719
step    880 | loss 1.7668 | lr 3.24e-05 | grad 0.92 | tok/s 43410
step    890 | loss 1.6666 | lr 9.84e-06 | grad 0.70 | tok/s 43261
step    900 | loss 2.1039 | lr 1.07e-06 | grad 0.79 | tok/s 42452
step    910 | loss 1.7081 | lr 6.94e-06 | grad 0.57 | tok/s 42900
step    920 | loss 1.6953 | lr 2.68e-05 | grad 0.63 | tok/s 42921
step    930 | loss 1.7943 | lr 5.89e-05 | grad 1.16 | tok/s 42679
step    940 | loss 1.6853 | lr 9.99e-05 | grad 1.14 | tok/s 41810
step    950 | loss 1.7717 | lr 1.46e-04 | grad 0.86 | tok/s 43594
step    960 | loss 1.5073 | lr 1.92e-04 | grad 0.42 | tok/s 45682
step    970 | loss 1.3373 | lr 2.35e-04 | grad 0.38 | tok/s 46293
step    980 | loss 1.4993 | lr 2.69e-04 | grad 1.23 | tok/s 44332
step    990 | loss 1.8101 | lr 2.91e-04 | grad 0.60 | tok/s 43415
step   1000 | loss 1.7132 | lr 3.00e-04 | grad 0.48 | tok/s 42344
  >>> saved checkpoint: checkpoint_step_001000_loss_1.7132.pt
step   1010 | loss 1.8929 | lr 2.94e-04 | grad 1.22 | tok/s 34231
step   1020 | loss 1.5645 | lr 2.74e-04 | grad 0.67 | tok/s 43221
step   1030 | loss 2.0117 | lr 2.42e-04 | grad 0.64 | tok/s 42907
step   1040 | loss 1.6198 | lr 2.01e-04 | grad 0.98 | tok/s 43305
step   1050 | loss 1.6212 | lr 1.55e-04 | grad 0.54 | tok/s 43944
step   1060 | loss 1.7879 | lr 1.09e-04 | grad 1.08 | tok/s 43798
step   1070 | loss 1.9039 | lr 6.65e-05 | grad 0.64 | tok/s 45305
step   1080 | loss 2.3080 | lr 3.24e-05 | grad 0.82 | tok/s 44171
step   1090 | loss 1.9892 | lr 9.84e-06 | grad 0.70 | tok/s 42514
step   1100 | loss 1.6742 | lr 1.07e-06 | grad 0.55 | tok/s 42959
step   1110 | loss 1.6314 | lr 6.93e-06 | grad 0.63 | tok/s 43458
step   1120 | loss 1.8684 | lr 2.68e-05 | grad 0.59 | tok/s 44007
step   1130 | loss 1.6746 | lr 5.89e-05 | grad 0.59 | tok/s 42279
step   1140 | loss 1.5421 | lr 9.99e-05 | grad 0.49 | tok/s 43178
step   1150 | loss 1.8121 | lr 1.46e-04 | grad 0.83 | tok/s 42810
step   1160 | loss 1.4985 | lr 1.92e-04 | grad 0.42 | tok/s 42397
step   1170 | loss 1.7777 | lr 2.35e-04 | grad 0.61 | tok/s 42436
step   1180 | loss 1.5365 | lr 2.69e-04 | grad 0.55 | tok/s 44939
step   1190 | loss 1.3807 | lr 2.91e-04 | grad 0.44 | tok/s 44554
step   1200 | loss 1.3011 | lr 3.00e-04 | grad 0.52 | tok/s 44631
step   1210 | loss 1.2760 | lr 2.94e-04 | grad 0.52 | tok/s 44544
step   1220 | loss 1.3235 | lr 2.74e-04 | grad 0.70 | tok/s 44035
step   1230 | loss 1.5524 | lr 2.42e-04 | grad 0.61 | tok/s 42522
step   1240 | loss 1.6140 | lr 2.01e-04 | grad 0.53 | tok/s 41832
step   1250 | loss 1.6868 | lr 1.55e-04 | grad 2.62 | tok/s 43055
step   1260 | loss 1.7385 | lr 1.09e-04 | grad 1.80 | tok/s 43053
step   1270 | loss 1.8101 | lr 6.65e-05 | grad 1.00 | tok/s 42548
step   1280 | loss 1.6408 | lr 3.24e-05 | grad 0.64 | tok/s 42003
step   1290 | loss 1.5898 | lr 9.84e-06 | grad 0.66 | tok/s 41884
step   1300 | loss 1.6373 | lr 1.07e-06 | grad 0.58 | tok/s 41574
step   1310 | loss 1.7118 | lr 6.93e-06 | grad 0.55 | tok/s 41884
step   1320 | loss 1.6975 | lr 2.68e-05 | grad 0.86 | tok/s 42479
step   1330 | loss 1.6198 | lr 5.89e-05 | grad 0.45 | tok/s 42392
step   1340 | loss 1.5429 | lr 9.99e-05 | grad 0.75 | tok/s 42744
step   1350 | loss 1.5608 | lr 1.46e-04 | grad 1.09 | tok/s 43674
step   1360 | loss 1.5180 | lr 1.92e-04 | grad 0.51 | tok/s 41321
step   1370 | loss 1.6207 | lr 2.35e-04 | grad 0.49 | tok/s 42080
step   1380 | loss 1.7058 | lr 2.69e-04 | grad 0.67 | tok/s 43553
step   1390 | loss 1.6359 | lr 2.91e-04 | grad 1.14 | tok/s 42587
step   1400 | loss 1.6633 | lr 3.00e-04 | grad 4.62 | tok/s 44004
step   1410 | loss 1.6627 | lr 2.94e-04 | grad 0.89 | tok/s 44763
step   1420 | loss 1.7140 | lr 2.74e-04 | grad 0.62 | tok/s 42109
step   1430 | loss 1.5251 | lr 2.42e-04 | grad 0.71 | tok/s 41569
step   1440 | loss 1.4396 | lr 2.01e-04 | grad 0.50 | tok/s 43979
step   1450 | loss 1.4707 | lr 1.55e-04 | grad 1.30 | tok/s 44439
step   1460 | loss 1.5494 | lr 1.09e-04 | grad 0.46 | tok/s 41503
step   1470 | loss 1.6507 | lr 6.65e-05 | grad 1.46 | tok/s 43326
step   1480 | loss 1.5277 | lr 3.24e-05 | grad 1.48 | tok/s 43586
step   1490 | loss 1.6742 | lr 9.84e-06 | grad 1.60 | tok/s 43863
step   1500 | loss 1.7737 | lr 1.07e-06 | grad 1.55 | tok/s 42483
step   1510 | loss 1.6633 | lr 6.93e-06 | grad 0.80 | tok/s 44264
step   1520 | loss 1.6125 | lr 2.68e-05 | grad 0.95 | tok/s 44206
step   1530 | loss 1.5805 | lr 5.89e-05 | grad 0.44 | tok/s 43839
step   1540 | loss 1.5557 | lr 9.99e-05 | grad 0.41 | tok/s 42876
step   1550 | loss 1.5225 | lr 1.46e-04 | grad 1.67 | tok/s 45008
step   1560 | loss 2.0472 | lr 1.92e-04 | grad 0.96 | tok/s 43365
step   1570 | loss 1.5629 | lr 2.35e-04 | grad 0.90 | tok/s 42801
step   1580 | loss 1.7059 | lr 2.69e-04 | grad 0.76 | tok/s 44604
step   1590 | loss 1.5355 | lr 2.91e-04 | grad 0.53 | tok/s 43160
step   1600 | loss 1.6437 | lr 3.00e-04 | grad 0.63 | tok/s 42418
step   1610 | loss 1.4651 | lr 2.94e-04 | grad 0.54 | tok/s 44969
step   1620 | loss 1.6328 | lr 2.74e-04 | grad 0.50 | tok/s 45261
step   1630 | loss 1.6196 | lr 2.42e-04 | grad 0.52 | tok/s 46511
step   1640 | loss 1.5688 | lr 2.01e-04 | grad 0.51 | tok/s 44826

Training complete! Final step: 1645
