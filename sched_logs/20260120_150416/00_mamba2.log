# Job 0: mamba2
# GPU: 0
# Command: python train.py --level mamba2 --dim 896 --data data/pile.txt --depth 20 --batch_size 32 --chunk_size 512 --lr 3e-4 --warmup_steps 100 --seed 42 --bf16 --train_minutes 10 --output benchmark_results/e88_100m_v2/mamba2
# Started: 2026-01-20T15:04:16.055203
============================================================

Using device: cuda
Output directory: benchmark_results/e88_100m_v2/mamba2/levelmamba2_100m_20260120_150422
Model: Level mamba2, 101,936,528 parameters

Starting training from step 0...
Batch size: 32, Chunk size: 512
Gradient accumulation: 1, Effective batch: 32

Time-based training: 10.0 minutes
step     10 | loss 5.4576 | lr 2.70e-05 | grad 5.00 | tok/s 4724
step     20 | loss 4.3086 | lr 5.70e-05 | grad 6.47 | tok/s 24968
step     30 | loss 4.5682 | lr 8.70e-05 | grad 3.27 | tok/s 26518
step     40 | loss 3.1654 | lr 1.17e-04 | grad 1.87 | tok/s 26280
step     50 | loss 2.3871 | lr 1.47e-04 | grad 1.48 | tok/s 26341
step     60 | loss 2.7602 | lr 1.77e-04 | grad 3.28 | tok/s 25540
step     70 | loss 2.4723 | lr 2.07e-04 | grad 1.88 | tok/s 24790
step     80 | loss 2.8032 | lr 2.37e-04 | grad 3.17 | tok/s 25735
step     90 | loss 2.7417 | lr 2.67e-04 | grad 4.06 | tok/s 24878
step    100 | loss 2.2439 | lr 2.97e-04 | grad 1.20 | tok/s 24939
step    110 | loss 2.2792 | lr 6.94e-06 | grad 1.96 | tok/s 24346
step    120 | loss 2.4867 | lr 2.69e-05 | grad 1.52 | tok/s 24222
step    130 | loss 2.3556 | lr 5.89e-05 | grad 1.16 | tok/s 24676
step    140 | loss 2.0978 | lr 9.99e-05 | grad 1.00 | tok/s 24606
step    150 | loss 1.9592 | lr 1.46e-04 | grad 1.89 | tok/s 23662
step    160 | loss 1.8688 | lr 1.92e-04 | grad 1.62 | tok/s 23972
step    170 | loss 2.0565 | lr 2.35e-04 | grad 3.31 | tok/s 24555
step    180 | loss 2.0397 | lr 2.69e-04 | grad 1.27 | tok/s 24513
step    190 | loss 1.7566 | lr 2.91e-04 | grad 1.27 | tok/s 25061
step    200 | loss 1.3559 | lr 3.00e-04 | grad 1.05 | tok/s 25710
step    210 | loss 2.1284 | lr 2.94e-04 | grad 1.72 | tok/s 24511
step    220 | loss 1.9220 | lr 2.74e-04 | grad 1.30 | tok/s 25274
step    230 | loss 1.8173 | lr 2.42e-04 | grad 1.48 | tok/s 24620
step    240 | loss 1.7887 | lr 2.01e-04 | grad 1.52 | tok/s 24798
step    250 | loss 1.7931 | lr 1.55e-04 | grad 1.30 | tok/s 26167
step    260 | loss 1.8792 | lr 1.09e-04 | grad 0.86 | tok/s 55771
step    270 | loss 1.7243 | lr 6.65e-05 | grad 0.95 | tok/s 57949
step    280 | loss 1.6077 | lr 3.24e-05 | grad 1.73 | tok/s 57959
step    290 | loss 1.6129 | lr 9.84e-06 | grad 0.76 | tok/s 60874
step    300 | loss 1.5956 | lr 1.07e-06 | grad 0.86 | tok/s 60926
step    310 | loss 1.5796 | lr 6.94e-06 | grad 0.68 | tok/s 60829
step    320 | loss 1.6804 | lr 2.69e-05 | grad 1.66 | tok/s 58615
step    330 | loss 1.7105 | lr 5.89e-05 | grad 0.79 | tok/s 57203
step    340 | loss 1.7105 | lr 9.99e-05 | grad 2.16 | tok/s 58450
step    350 | loss 1.7269 | lr 1.46e-04 | grad 0.92 | tok/s 56701
step    360 | loss 1.6732 | lr 1.92e-04 | grad 2.34 | tok/s 57416
step    370 | loss 1.5129 | lr 2.35e-04 | grad 1.01 | tok/s 58476
step    380 | loss 1.9880 | lr 2.69e-04 | grad 1.06 | tok/s 59887
step    390 | loss 1.7113 | lr 2.91e-04 | grad 1.46 | tok/s 57797
step    400 | loss 1.8063 | lr 3.00e-04 | grad 2.44 | tok/s 59254
step    410 | loss 1.5792 | lr 2.94e-04 | grad 2.34 | tok/s 57338
step    420 | loss 1.7146 | lr 2.74e-04 | grad 1.22 | tok/s 56931
step    430 | loss 1.8055 | lr 2.42e-04 | grad 1.21 | tok/s 56814
step    440 | loss 1.8216 | lr 2.01e-04 | grad 0.89 | tok/s 58883
step    450 | loss 1.6810 | lr 1.55e-04 | grad 0.77 | tok/s 57475
step    460 | loss 1.6693 | lr 1.09e-04 | grad 0.67 | tok/s 57665
step    470 | loss 1.6155 | lr 6.65e-05 | grad 1.03 | tok/s 58354
step    480 | loss 1.5189 | lr 3.24e-05 | grad 0.61 | tok/s 56269
step    490 | loss 1.5149 | lr 9.84e-06 | grad 0.64 | tok/s 57358
step    500 | loss 2.4372 | lr 1.07e-06 | grad 0.98 | tok/s 59136
step    510 | loss 1.5668 | lr 6.94e-06 | grad 0.70 | tok/s 57836
step    520 | loss 1.6067 | lr 2.69e-05 | grad 0.63 | tok/s 59665
step    530 | loss 2.0996 | lr 5.89e-05 | grad 0.67 | tok/s 58360
step    540 | loss 1.4944 | lr 9.99e-05 | grad 1.06 | tok/s 58321
step    550 | loss 1.4274 | lr 1.46e-04 | grad 0.59 | tok/s 59912
step    560 | loss 1.3013 | lr 1.92e-04 | grad 0.65 | tok/s 60608
step    570 | loss 1.5535 | lr 2.35e-04 | grad 1.98 | tok/s 59276
step    580 | loss 1.8473 | lr 2.69e-04 | grad 0.88 | tok/s 58397
step    590 | loss 2.1076 | lr 2.91e-04 | grad 1.00 | tok/s 57314
step    600 | loss 1.6597 | lr 3.00e-04 | grad 1.39 | tok/s 57450
step    610 | loss 1.6278 | lr 2.94e-04 | grad 1.26 | tok/s 60248
step    620 | loss 1.6207 | lr 2.74e-04 | grad 0.89 | tok/s 57115
step    630 | loss 1.5222 | lr 2.42e-04 | grad 0.84 | tok/s 58903
step    640 | loss 1.7519 | lr 2.01e-04 | grad 0.96 | tok/s 59162
step    650 | loss 1.5459 | lr 1.55e-04 | grad 0.91 | tok/s 57971
step    660 | loss 1.8148 | lr 1.09e-04 | grad 5.78 | tok/s 57131
step    670 | loss 1.6848 | lr 6.65e-05 | grad 1.84 | tok/s 59068
step    680 | loss 1.6215 | lr 3.24e-05 | grad 1.04 | tok/s 57037
step    690 | loss 1.6460 | lr 9.84e-06 | grad 1.48 | tok/s 57501
step    700 | loss 1.7577 | lr 1.07e-06 | grad 1.59 | tok/s 57710
step    710 | loss 1.6741 | lr 6.94e-06 | grad 1.13 | tok/s 58110
step    720 | loss 1.7479 | lr 2.68e-05 | grad 1.61 | tok/s 57846
step    730 | loss 1.7250 | lr 5.89e-05 | grad 1.19 | tok/s 58496
step    740 | loss 1.6587 | lr 9.99e-05 | grad 1.70 | tok/s 57944
step    750 | loss 1.4767 | lr 1.46e-04 | grad 1.19 | tok/s 57202
step    760 | loss 1.7447 | lr 1.92e-04 | grad 0.68 | tok/s 57913
step    770 | loss 1.5312 | lr 2.35e-04 | grad 0.97 | tok/s 57587
step    780 | loss 1.5764 | lr 2.69e-04 | grad 0.80 | tok/s 58044
step    790 | loss 1.4846 | lr 2.91e-04 | grad 0.56 | tok/s 58736
step    800 | loss 1.4793 | lr 3.00e-04 | grad 0.94 | tok/s 58586
step    810 | loss 1.5873 | lr 2.94e-04 | grad 1.80 | tok/s 58102
step    820 | loss 2.3022 | lr 2.74e-04 | grad 1.38 | tok/s 59815
step    830 | loss 1.7624 | lr 2.42e-04 | grad 0.70 | tok/s 60383
step    840 | loss 1.4265 | lr 2.01e-04 | grad 0.66 | tok/s 60498
step    850 | loss 1.8545 | lr 1.55e-04 | grad 1.07 | tok/s 57453
step    860 | loss 1.6241 | lr 1.09e-04 | grad 0.88 | tok/s 56408
step    870 | loss 1.5410 | lr 6.65e-05 | grad 0.89 | tok/s 58075
step    880 | loss 1.6043 | lr 3.24e-05 | grad 1.08 | tok/s 57771
step    890 | loss 1.5478 | lr 9.84e-06 | grad 0.91 | tok/s 57905
step    900 | loss 1.9340 | lr 1.07e-06 | grad 0.89 | tok/s 56294
step    910 | loss 1.5607 | lr 6.94e-06 | grad 0.74 | tok/s 57427
step    920 | loss 1.5764 | lr 2.68e-05 | grad 0.78 | tok/s 57260
step    930 | loss 1.6621 | lr 5.89e-05 | grad 1.49 | tok/s 57019
step    940 | loss 1.5802 | lr 9.99e-05 | grad 1.62 | tok/s 56654
step    950 | loss 1.6225 | lr 1.46e-04 | grad 1.04 | tok/s 57840
step    960 | loss 1.4079 | lr 1.92e-04 | grad 0.62 | tok/s 60646
step    970 | loss 1.2519 | lr 2.35e-04 | grad 0.45 | tok/s 60614
step    980 | loss 1.3990 | lr 2.69e-04 | grad 2.50 | tok/s 58890
step    990 | loss 1.6755 | lr 2.91e-04 | grad 0.71 | tok/s 57377
step   1000 | loss 1.5887 | lr 3.00e-04 | grad 0.63 | tok/s 55782
  >>> saved checkpoint: checkpoint_step_001000_loss_1.5887.pt
step   1010 | loss 1.7170 | lr 2.94e-04 | grad 1.12 | tok/s 45368
step   1020 | loss 1.4156 | lr 2.74e-04 | grad 0.80 | tok/s 57691
step   1030 | loss 1.8924 | lr 2.42e-04 | grad 0.86 | tok/s 56536
step   1040 | loss 1.5014 | lr 2.01e-04 | grad 1.09 | tok/s 57765
step   1050 | loss 1.5245 | lr 1.55e-04 | grad 0.68 | tok/s 58009
step   1060 | loss 1.6252 | lr 1.09e-04 | grad 1.34 | tok/s 58074
step   1070 | loss 1.7622 | lr 6.65e-05 | grad 0.84 | tok/s 58290
step   1080 | loss 2.1821 | lr 3.24e-05 | grad 0.99 | tok/s 57361
step   1090 | loss 1.8838 | lr 9.84e-06 | grad 0.85 | tok/s 58079
step   1100 | loss 1.5599 | lr 1.07e-06 | grad 0.64 | tok/s 57588
step   1110 | loss 1.5143 | lr 6.93e-06 | grad 0.84 | tok/s 58579
step   1120 | loss 1.7263 | lr 2.68e-05 | grad 0.78 | tok/s 59223
step   1130 | loss 1.5767 | lr 5.89e-05 | grad 0.66 | tok/s 56323
step   1140 | loss 1.4475 | lr 9.99e-05 | grad 0.59 | tok/s 57763
step   1150 | loss 1.6909 | lr 1.46e-04 | grad 1.06 | tok/s 57595
step   1160 | loss 1.4009 | lr 1.92e-04 | grad 0.54 | tok/s 56881
step   1170 | loss 1.7230 | lr 2.35e-04 | grad 0.77 | tok/s 57570
step   1180 | loss 1.4576 | lr 2.69e-04 | grad 0.67 | tok/s 60558
step   1190 | loss 1.3071 | lr 2.91e-04 | grad 0.57 | tok/s 60668
step   1200 | loss 1.2297 | lr 3.00e-04 | grad 0.55 | tok/s 60506
step   1210 | loss 1.2090 | lr 2.94e-04 | grad 0.63 | tok/s 60611
step   1220 | loss 1.2541 | lr 2.74e-04 | grad 0.87 | tok/s 59955
step   1230 | loss 1.4389 | lr 2.42e-04 | grad 0.72 | tok/s 58099
step   1240 | loss 1.5061 | lr 2.01e-04 | grad 0.70 | tok/s 56897
step   1250 | loss 1.5979 | lr 1.55e-04 | grad 3.23 | tok/s 58573
step   1260 | loss 1.6291 | lr 1.09e-04 | grad 2.52 | tok/s 58624
step   1270 | loss 1.6958 | lr 6.65e-05 | grad 1.20 | tok/s 57914
step   1280 | loss 1.5407 | lr 3.24e-05 | grad 0.77 | tok/s 57173
step   1290 | loss 1.4960 | lr 9.84e-06 | grad 0.72 | tok/s 57102
step   1300 | loss 1.5387 | lr 1.07e-06 | grad 0.68 | tok/s 56756
step   1310 | loss 1.6122 | lr 6.93e-06 | grad 0.68 | tok/s 56539
step   1320 | loss 1.6040 | lr 2.68e-05 | grad 1.08 | tok/s 57512
step   1330 | loss 1.5145 | lr 5.89e-05 | grad 0.58 | tok/s 57661
step   1340 | loss 1.4267 | lr 9.99e-05 | grad 0.84 | tok/s 57718
step   1350 | loss 1.4355 | lr 1.46e-04 | grad 1.33 | tok/s 59232
step   1360 | loss 1.4254 | lr 1.92e-04 | grad 0.66 | tok/s 56202
step   1370 | loss 1.5143 | lr 2.35e-04 | grad 0.68 | tok/s 56994
step   1380 | loss 1.5803 | lr 2.69e-04 | grad 0.76 | tok/s 57546
step   1390 | loss 1.5151 | lr 2.91e-04 | grad 1.28 | tok/s 56079
step   1400 | loss 1.5591 | lr 3.00e-04 | grad 9.25 | tok/s 58472
step   1410 | loss 1.5290 | lr 2.94e-04 | grad 0.86 | tok/s 59036
step   1420 | loss 1.5929 | lr 2.74e-04 | grad 0.73 | tok/s 56077
step   1430 | loss 1.4221 | lr 2.42e-04 | grad 0.67 | tok/s 54926
step   1440 | loss 1.3531 | lr 2.01e-04 | grad 0.57 | tok/s 57841
step   1450 | loss 1.3517 | lr 1.55e-04 | grad 1.55 | tok/s 59142
step   1460 | loss 1.4680 | lr 1.09e-04 | grad 0.53 | tok/s 55214
step   1470 | loss 1.5594 | lr 6.65e-05 | grad 2.03 | tok/s 57218
step   1480 | loss 1.4349 | lr 3.24e-05 | grad 1.52 | tok/s 57721
step   1490 | loss 1.5670 | lr 9.84e-06 | grad 1.98 | tok/s 57839
step   1500 | loss 1.6736 | lr 1.07e-06 | grad 1.84 | tok/s 56190
step   1510 | loss 1.5559 | lr 6.93e-06 | grad 1.02 | tok/s 59119
step   1520 | loss 1.5085 | lr 2.68e-05 | grad 1.12 | tok/s 58510
step   1530 | loss 1.4837 | lr 5.89e-05 | grad 0.53 | tok/s 58230
step   1540 | loss 1.4513 | lr 9.99e-05 | grad 0.48 | tok/s 57005
step   1550 | loss 1.4301 | lr 1.46e-04 | grad 2.94 | tok/s 59351
step   1560 | loss 1.8838 | lr 1.92e-04 | grad 0.98 | tok/s 57755
step   1570 | loss 1.4625 | lr 2.35e-04 | grad 0.96 | tok/s 56716
step   1580 | loss 1.5973 | lr 2.69e-04 | grad 1.02 | tok/s 58541
step   1590 | loss 1.4100 | lr 2.91e-04 | grad 0.61 | tok/s 57257
step   1600 | loss 1.5556 | lr 3.00e-04 | grad 0.72 | tok/s 56010
step   1610 | loss 1.3594 | lr 2.94e-04 | grad 0.73 | tok/s 59419
step   1620 | loss 1.5272 | lr 2.74e-04 | grad 0.55 | tok/s 58459
step   1630 | loss 1.4882 | lr 2.42e-04 | grad 0.71 | tok/s 58789
step   1640 | loss 1.4444 | lr 2.01e-04 | grad 0.59 | tok/s 56779
step   1650 | loss 1.4615 | lr 1.55e-04 | grad 0.88 | tok/s 55973
step   1660 | loss 1.4620 | lr 1.09e-04 | grad 0.55 | tok/s 56456
step   1670 | loss 1.4890 | lr 6.65e-05 | grad 1.70 | tok/s 58645
step   1680 | loss 1.8942 | lr 3.24e-05 | grad 0.52 | tok/s 58720
step   1690 | loss 1.4433 | lr 9.84e-06 | grad 0.88 | tok/s 57430
step   1700 | loss 1.6783 | lr 1.07e-06 | grad 0.52 | tok/s 58602
step   1710 | loss 1.4879 | lr 6.93e-06 | grad 0.93 | tok/s 56932
step   1720 | loss 1.4485 | lr 2.68e-05 | grad 0.64 | tok/s 57142
step   1730 | loss 1.5693 | lr 5.89e-05 | grad 0.76 | tok/s 57124
step   1740 | loss 1.4879 | lr 9.99e-05 | grad 0.58 | tok/s 58083
step   1750 | loss 1.4136 | lr 1.46e-04 | grad 0.52 | tok/s 56023
step   1760 | loss 1.5918 | lr 1.92e-04 | grad 0.62 | tok/s 56586
step   1770 | loss 1.5526 | lr 2.35e-04 | grad 0.51 | tok/s 57987
step   1780 | loss 1.4482 | lr 2.69e-04 | grad 0.93 | tok/s 55871

Training complete! Final step: 1784
