/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'n_heads': 104, 'n_state': 32, 'depth': 32}
Encoded x0: ['0.417', '0.333', '0.600']
======================================================================
CMA-ES Search for E88
======================================================================
Search space (3 dimensions):
  n_heads: [64, 160] (int) - Number of attention heads
  n_state: [16, 64] (e88_n_state) - State dimension (only 16,32,48,64 supported by fused kernel)
  depth: [20, 40] (int) - Number of layers
Target params: 480M Â± 30M
Training time per config: 10.0 min
Generations: 15
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~120
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 3 (seed=663961, Tue Jan 27 14:06:30 2026)

--- Generation 1/15 ---
  [Eval 2] GPU 1 | n_heads=85, n_state=32, depth=33 | dim=1024 | 462.7M params
  [Eval 2] Loss: 1.5856
  [Eval 1] Skip - params 440.7M vs target 480M
  [Eval 4] GPU 3 | n_heads=97, n_state=32, depth=31 | dim=1024 | 496.0M params
  [Eval 4] Loss: 1.5696
  [Eval 5] GPU 4 | n_heads=128, n_state=48, depth=31 | dim=512 | 489.8M params
  [Eval 5] Loss: 1.8345
  [Eval 6] GPU 5 | n_heads=96, n_state=32, depth=34 | dim=896 | 471.1M params
  [Eval 6] Loss: 1.6502
  [Eval 8] GPU 7 | n_heads=116, n_state=32, depth=32 | dim=768 | 459.2M params
  [Eval 8] Loss: 1.6783
  [Eval 3] GPU 2 | n_heads=105, n_state=16, depth=31 | dim=1792 | 473.0M params
  [Eval 3] Loss: 1.5610
  [Eval 7] GPU 6 | n_heads=86, n_state=32, depth=34 | dim=1024 | 482.4M params
  [Eval 7] Loss: 1.5906
  *** NEW BEST: 10.0000 | {'n_heads': 105, 'n_state': 48, 'depth': 34} | dim=0 ***
  *** NEW BEST: 1.5856 | {'n_heads': 85, 'n_state': 32, 'depth': 33} | dim=1024 ***
  *** NEW BEST: 1.5610 | {'n_heads': 105, 'n_state': 16, 'depth': 31} | dim=1792 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.561034693877551e+00 1.0e+00 1.24e-01  1e-01  1e-01 10:18.0

--- Generation 2/15 ---
  [Eval 9] GPU 0 | n_heads=91, n_state=32, depth=32 | dim=1024 | 480.4M params
  [Eval 9] Loss: 1.5815
  [Eval 16] GPU 7 | n_heads=80, n_state=32, depth=29 | dim=1280 | 478.5M params
  [Eval 16] Loss: 1.5523
  [Eval 10] GPU 1 | n_heads=99, n_state=32, depth=29 | dim=1024 | 473.6M params
  [Eval 10] Loss: 1.5557
  [Eval 14] GPU 5 | n_heads=81, n_state=32, depth=32 | dim=1152 | 481.1M params
  [Eval 14] Loss: 1.5631
  [Eval 12] GPU 3 | n_heads=108, n_state=32, depth=28 | dim=1024 | 498.8M params
  [Eval 12] Loss: 1.5571
  [Eval 11] GPU 2 | n_heads=95, n_state=32, depth=32 | dim=1024 | 501.5M params
  [Eval 11] Loss: 1.5987
  [Eval 13] GPU 4 | n_heads=104, n_state=32, depth=36 | dim=768 | 463.2M params
  [Eval 13] Loss: 1.6935
  [Eval 15] GPU 6 | n_heads=107, n_state=16, depth=30 | dim=1792 | 466.5M params
  [Eval 15] Loss: 1.5890
  *** NEW BEST: 1.5557 | {'n_heads': 99, 'n_state': 32, 'depth': 29} | dim=1024 ***
  *** NEW BEST: 1.5523 | {'n_heads': 80, 'n_state': 32, 'depth': 29} | dim=1280 ***
    2     16 1.552256097560976e+00 1.1e+00 1.51e-01  1e-01  2e-01 20:35.4

--- Generation 3/15 ---
  [Eval 19] GPU 2 | n_heads=95, n_state=32, depth=30 | dim=1024 | 470.2M params
  [Eval 19] Loss: 1.5629
  [Eval 18] GPU 1 | n_heads=89, n_state=48, depth=26 | dim=896 | 499.9M params
  [Eval 18] Loss: 1.5438
  [Eval 17] GPU 0 | n_heads=88, n_state=32, depth=23 | dim=1408 | 459.2M params
  [Eval 17] Loss: 1.5666
  [Eval 23] GPU 6 | n_heads=91, n_state=16, depth=33 | dim=1920 | 467.6M params
  [Eval 23] Loss: 1.8961
  [Eval 21] GPU 4 | n_heads=85, n_state=16, depth=26 | dim=2688 | 481.9M params
  [Eval 21] Loss: 1.4537
  [Eval 20] GPU 3 | n_heads=107, n_state=32, depth=31 | dim=896 | 478.8M params
  [Eval 20] Loss: 1.6321
  [Eval 22] GPU 5 | n_heads=99, n_state=32, depth=31 | dim=1024 | 506.3M params
  [Eval 22] Loss: 1.5859
  [Eval 24] GPU 7 | n_heads=94, n_state=32, depth=29 | dim=1152 | 505.9M params
  [Eval 24] Loss: 1.5469
  *** NEW BEST: 1.5438 | {'n_heads': 89, 'n_state': 48, 'depth': 26} | dim=896 ***
  *** NEW BEST: 1.4537 | {'n_heads': 85, 'n_state': 16, 'depth': 26} | dim=2688 ***
    3     24 1.453705000000000e+00 1.5e+00 1.65e-01  2e-01  2e-01 30:52.9

--- Generation 4/15 ---
  [Eval 29] GPU 4 | n_heads=91, n_state=32, depth=27 | dim=1152 | 456.0M params
  [Eval 29] Loss: 1.5749
  [Eval 31] GPU 6 | n_heads=100, n_state=16, depth=24 | dim=2432 | 473.5M params
  [Eval 31] Loss: 1.6191
  [Eval 30] GPU 5 | n_heads=92, n_state=32, depth=26 | dim=1280 | 493.3M params
  [Eval 30] Loss: 1.4829
  [Eval 25] GPU 0 | n_heads=84, n_state=32, depth=24 | dim=1536 | 499.0M params
  [Eval 25] Loss: 1.4594
  [Eval 26] GPU 1 | n_heads=101, n_state=32, depth=28 | dim=1024 | 466.5M params
  [Eval 26] Loss: 1.5568
  [Eval 27] GPU 2 | n_heads=102, n_state=48, depth=30 | dim=640 | 472.2M params
  [Eval 27] Loss: 1.8629
  [Eval 32] GPU 7 | n_heads=136, n_state=32, depth=35 | dim=640 | 490.7M params
  [Eval 32] Loss: 1.6122
  [Eval 28] GPU 3 | n_heads=72, n_state=16, depth=22 | dim=3712 | 477.3M params
  [Eval 28] Loss: 1.5226
    4     32 1.459411000000000e+00 1.5e+00 1.71e-01  1e-01  2e-01 41:12.4

--- Generation 5/15 ---
  [Eval 33] GPU 0 | n_heads=77, n_state=32, depth=25 | dim=1536 | 476.5M params
  [Eval 33] Loss: 1.5798
  [Eval 39] GPU 6 | n_heads=76, n_state=32, depth=25 | dim=1536 | 470.3M params
  [Eval 39] Loss: 1.5745
  [Eval 38] GPU 5 | n_heads=76, n_state=32, depth=20 | dim=1920 | 470.4M params
  [Eval 38] Loss: 1.7115
  [Eval 36] GPU 3 | n_heads=101, n_state=32, depth=22 | dim=1280 | 458.3M params
  [Eval 36] Loss: 1.5249
  [Eval 35] GPU 2 | n_heads=65, n_state=32, depth=23 | dim=2048 | 493.5M params
  [Eval 35] Loss: 1.4415
  [Eval 34] GPU 1 | n_heads=76, n_state=32, depth=21 | dim=1920 | 493.9M params
  [Eval 34] Loss: 1.4463
  [Eval 37] GPU 4 | n_heads=121, n_state=32, depth=20 | dim=1280 | 499.1M params
  [Eval 37] Loss: 1.4825
  [Eval 40] GPU 7 | n_heads=109, n_state=16, depth=29 | dim=1920 | 492.2M params
  [Eval 40] Loss: 1.4805
  *** NEW BEST: 1.4463 | {'n_heads': 76, 'n_state': 32, 'depth': 21} | dim=1920 ***
  *** NEW BEST: 1.4415 | {'n_heads': 65, 'n_state': 32, 'depth': 23} | dim=2048 ***
    5     40 1.441499000000000e+00 1.7e+00 1.77e-01  1e-01  2e-01 51:38.4

--- Generation 6/15 ---
  [Eval 42] GPU 1 | n_heads=75, n_state=32, depth=24 | dim=1664 | 482.7M params
  [Eval 42] Loss: 1.4443
  [Eval 48] GPU 7 | n_heads=76, n_state=32, depth=26 | dim=1536 | 489.1M params
  [Eval 48] Loss: 1.4516
  [Eval 43] GPU 2 | n_heads=94, n_state=32, depth=24 | dim=1280 | 465.3M params
  [Eval 43] Loss: 1.5374
  [Eval 46] GPU 5 | n_heads=78, n_state=32, depth=24 | dim=1536 | 463.4M params
  [Eval 46] Loss: 1.5200
  [Eval 47] GPU 6 | n_heads=78, n_state=16, depth=20 | dim=3840 | 486.3M params
  [Eval 47] Loss: 1.4281
  [Eval 45] GPU 4 | n_heads=76, n_state=32, depth=26 | dim=1536 | 489.1M params
  [Eval 45] Loss: 1.4650
  [Eval 44] GPU 3 | n_heads=79, n_state=32, depth=28 | dim=1408 | 501.8M params
  [Eval 44] Loss: 1.4939
  [Eval 41] GPU 0 | n_heads=65, n_state=32, depth=20 | dim=2304 | 482.9M params
  [Eval 41] Loss: 1.4277
  *** NEW BEST: 1.4277 | {'n_heads': 65, 'n_state': 32, 'depth': 20} | dim=2304 ***
    6     48 1.427727000000000e+00 1.8e+00 1.93e-01  2e-01  2e-01 62:06.0

--- Generation 7/15 ---
  [Eval 54] GPU 5 | n_heads=74, n_state=32, depth=26 | dim=1536 | 476.2M params
  [Eval 54] Loss: 1.5333
  [Eval 50] GPU 1 | n_heads=71, n_state=16, depth=22 | dim=3840 | 486.9M params
  [Eval 50] Loss: 1.4152
  [Eval 56] GPU 7 | n_heads=71, n_state=16, depth=20 | dim=4224 | 487.0M params
  [Eval 56] Loss: 1.4035
  [Eval 53] GPU 4 | n_heads=71, n_state=32, depth=20 | dim=2048 | 468.8M params
  [Eval 53] Loss: 1.7459
  [Eval 55] GPU 6 | n_heads=75, n_state=32, depth=21 | dim=1920 | 487.4M params
  [Eval 55] Loss: 1.4519
  [Eval 51] GPU 2 | n_heads=80, n_state=32, depth=20 | dim=1920 | 495.1M params
  [Eval 51] Loss: 1.4256
  [Eval 52] GPU 3 | n_heads=64, n_state=16, depth=20 | dim=4608 | 479.0M params
  [Eval 52] Loss: 1.5162
  [Eval 49] GPU 0 | n_heads=76, n_state=16, depth=20 | dim=3840 | 473.8M params
  [Eval 49] Loss: 1.5443
  *** NEW BEST: 1.4152 | {'n_heads': 71, 'n_state': 16, 'depth': 22} | dim=3840 ***
  *** NEW BEST: 1.4035 | {'n_heads': 71, 'n_state': 16, 'depth': 20} | dim=4224 ***
    7     56 1.403512000000000e+00 2.0e+00 1.93e-01  1e-01  2e-01 72:41.8

--- Generation 8/15 ---
  [Eval 58] GPU 1 | n_heads=71, n_state=32, depth=22 | dim=1920 | 483.4M params
  [Eval 58] Loss: 1.4213
  [Eval 59] GPU 2 | n_heads=101, n_state=16, depth=23 | dim=2560 | 482.4M params
  [Eval 59] Loss: 1.4531
  [Eval 61] GPU 4 | n_heads=83, n_state=32, depth=22 | dim=1664 | 489.7M params
  [Eval 61] Loss: 1.4315
  [Eval 57] GPU 0 | n_heads=67, n_state=16, depth=28 | dim=3200 | 487.2M params
  [Eval 57] Loss: 1.4494
  [Eval 63] GPU 6 | n_heads=66, n_state=16, depth=21 | dim=4224 | 475.4M params
  [Eval 63] Loss: 1.5202
  [Eval 62] GPU 5 | n_heads=64, n_state=16, depth=25 | dim=3712 | 482.1M params
  [Eval 62] Loss: 1.4076
  [Eval 60] GPU 3 | n_heads=70, n_state=16, depth=23 | dim=3712 | 485.1M params
  [Eval 60] Loss: 1.4444
  [Eval 64] GPU 7 | n_heads=66, n_state=16, depth=25 | dim=3584 | 480.0M params
  [Eval 64] Loss: 1.4418
    8     64 1.407581000000000e+00 2.0e+00 1.83e-01  1e-01  2e-01 83:16.4

--- Generation 9/15 ---
  [Eval 65] GPU 0 | n_heads=70, n_state=16, depth=27 | dim=3072 | 471.2M params
  [Eval 65] Loss: 1.5660
  [Eval 69] GPU 4 | n_heads=77, n_state=16, depth=20 | dim=3840 | 480.1M params
  [Eval 69] Loss: 1.4378
  [Eval 70] GPU 5 | n_heads=73, n_state=16, depth=27 | dim=2944 | 470.9M params
  [Eval 70] Loss: 1.6045
  [Eval 67] GPU 2 | n_heads=75, n_state=16, depth=25 | dim=3200 | 486.9M params
  [Eval 67] Loss: 1.4485
  [Eval 68] GPU 3 | n_heads=72, n_state=16, depth=33 | dim=2432 | 468.8M params
  [Eval 68] Loss: 1.6392
  [Eval 66] GPU 1 | n_heads=65, n_state=32, depth=24 | dim=1920 | 482.8M params
  [Eval 66] Loss: 1.4338
  [Eval 71] GPU 6 | n_heads=64, n_state=32, depth=20 | dim=2304 | 475.4M params
  [Eval 71] Loss: 1.6371
  [Eval 72] GPU 7 | n_heads=82, n_state=32, depth=21 | dim=1792 | 497.3M params
  [Eval 72] Loss: 1.4389
    9     72 1.433752000000000e+00 2.7e+00 1.73e-01  1e-01  2e-01 93:43.8

--- Generation 10/15 ---
  [Eval 78] GPU 5 | n_heads=80, n_state=16, depth=20 | dim=3712 | 482.1M params
  [Eval 78] Loss: 1.4241
  [Eval 75] GPU 2 | n_heads=70, n_state=16, depth=27 | dim=3072 | 471.2M params
  [Eval 75] Loss: 1.5595
  [Eval 73] GPU 0 | n_heads=82, n_state=32, depth=20 | dim=1792 | 473.7M params
  [Eval 73] Loss: 1.5084
  [Eval 74] GPU 1 | n_heads=75, n_state=32, depth=21 | dim=1920 | 487.4M params
  [Eval 74] Loss: 1.4294
  [Eval 80] GPU 7 | n_heads=66, n_state=32, depth=24 | dim=1920 | 490.2M params
  [Eval 80] Loss: 1.4429
  [Eval 79] GPU 6 | n_heads=73, n_state=16, depth=25 | dim=3200 | 473.9M params
  [Eval 79] Loss: 1.5982
  [Eval 76] GPU 3 | n_heads=70, n_state=32, depth=20 | dim=2176 | 491.1M params
  [Eval 76] Loss: 1.4155
  [Eval 77] GPU 4 | n_heads=67, n_state=16, depth=20 | dim=4352 | 473.6M params
  [Eval 77] Loss: 1.5210
   10     80 1.415467000000000e+00 2.3e+00 1.43e-01  9e-02  1e-01 104:13.4

--- Generation 11/15 ---
  [Eval 87] GPU 6 | n_heads=68, n_state=32, depth=23 | dim=1920 | 484.0M params
  [Eval 87] Loss: 1.4291
  [Eval 82] GPU 1 | n_heads=72, n_state=32, depth=23 | dim=1792 | 478.3M params
  [Eval 82] Loss: 1.7862
  [Eval 86] GPU 5 | n_heads=68, n_state=32, depth=24 | dim=1792 | 471.4M params
  [Eval 86] Loss: 1.7767
  [Eval 83] GPU 2 | n_heads=88, n_state=16, depth=20 | dim=3328 | 475.4M params
  [Eval 83] Loss: 1.5247
  [Eval 84] GPU 3 | n_heads=73, n_state=32, depth=21 | dim=1920 | 474.4M params
  [Eval 84] Loss: 1.7221
  [Eval 88] GPU 7 | n_heads=79, n_state=32, depth=21 | dim=1792 | 479.1M params
  [Eval 88] Loss: 1.5123
  [Eval 85] GPU 4 | n_heads=73, n_state=32, depth=20 | dim=2048 | 482.0M params
  [Eval 85] Loss: 1.4305
  [Eval 81] GPU 0 | n_heads=65, n_state=16, depth=29 | dim=3200 | 489.5M params
  [Eval 81] Loss: 1.4559
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     88 1.429107000000000e+00 2.4e+00 1.91e-01  2e-01  2e-01 114:33.3

--- Generation 12/15 ---
  [Eval 93] Skip - params 445.9M vs target 480M
  [Eval 91] GPU 2 | n_heads=85, n_state=48, depth=20 | dim=1152 | 472.3M params
  [Eval 91] Loss: 1.5948
  [Eval 92] GPU 3 | n_heads=72, n_state=32, depth=20 | dim=2048 | 475.4M params
  [Eval 92] Loss: 1.6570
  [Eval 90] GPU 1 | n_heads=66, n_state=32, depth=21 | dim=2176 | 486.2M params
  [Eval 90] Loss: 1.4145
  [Eval 94] GPU 5 | n_heads=90, n_state=32, depth=22 | dim=1536 | 490.1M params
  [Eval 94] Loss: 1.4298
  [Eval 96] GPU 7 | n_heads=64, n_state=16, depth=24 | dim=3840 | 478.8M params
  [Eval 96] Loss: 1.5267
  [Eval 95] GPU 6 | n_heads=65, n_state=32, depth=20 | dim=2304 | 482.9M params
  [Eval 95] Loss: 1.4247
  [Eval 89] GPU 0 | n_heads=84, n_state=16, depth=20 | dim=3584 | 488.7M params
  [Eval 89] Loss: 1.4443
   12     96 1.414537000000000e+00 2.5e+00 2.23e-01  2e-01  2e-01 124:57.7

--- Generation 13/15 ---
  [Eval 100] GPU 3 | n_heads=64, n_state=32, depth=21 | dim=2176 | 471.5M params
  [Eval 100] Loss: 1.6173
  [Eval 98] GPU 1 | n_heads=64, n_state=16, depth=21 | dim=4352 | 475.0M params
  [Eval 98] Loss: 1.5195
  [Eval 103] GPU 6 | n_heads=86, n_state=16, depth=22 | dim=3072 | 471.7M params
  [Eval 103] Loss: 1.5549
  [Eval 97] GPU 0 | n_heads=83, n_state=32, depth=21 | dim=1664 | 467.4M params
  [Eval 97] Loss: 1.5532
  [Eval 101] GPU 4 | n_heads=69, n_state=48, depth=23 | dim=1280 | 489.9M params
  [Eval 101] Loss: 1.5488
  [Eval 102] GPU 5 | n_heads=64, n_state=32, depth=20 | dim=2304 | 475.4M params
  [Eval 102] Loss: 1.5975
  [Eval 99] GPU 2 | n_heads=64, n_state=48, depth=23 | dim=1408 | 499.9M params
  [Eval 99] Loss: 1.5542
  [Eval 104] GPU 7 | n_heads=69, n_state=48, depth=21 | dim=1408 | 492.1M params
  [Eval 104] Loss: 1.5214
   13    104 1.519509000000000e+00 2.2e+00 2.35e-01  2e-01  2e-01 135:27.1

--- Generation 14/15 ---
  [Eval 108] GPU 3 | n_heads=65, n_state=32, depth=22 | dim=2048 | 472.1M params
  [Eval 108] Loss: 1.6495
  [Eval 111] GPU 6 | n_heads=91, n_state=32, depth=25 | dim=1280 | 469.2M params
  [Eval 111] Loss: 1.5563
  [Eval 106] GPU 1 | n_heads=64, n_state=32, depth=20 | dim=2304 | 475.4M params
  [Eval 106] Loss: 1.5765
  [Eval 107] GPU 2 | n_heads=72, n_state=32, depth=24 | dim=1664 | 463.4M params
  [Eval 107] Loss: 1.5512
  [Eval 105] GPU 0 | n_heads=95, n_state=32, depth=21 | dim=1536 | 493.8M params
  [Eval 105] Loss: 1.4642
  [Eval 112] GPU 7 | n_heads=74, n_state=32, depth=28 | dim=1408 | 470.1M params
  [Eval 112] Loss: 1.5798
  [Eval 109] GPU 4 | n_heads=76, n_state=16, depth=23 | dim=3328 | 472.1M params
  [Eval 109] Loss: 1.5519
  [Eval 110] GPU 5 | n_heads=93, n_state=48, depth=27 | dim=768 | 465.0M params
  [Eval 110] Loss: 1.8093
   14    112 1.464231000000000e+00 2.4e+00 2.83e-01  2e-01  3e-01 145:59.2

--- Generation 15/15 ---
  [Eval 113] GPU 0 | n_heads=65, n_state=32, depth=22 | dim=2048 | 472.1M params
  [Eval 113] Loss: 1.7605
  [Eval 119] GPU 6 | n_heads=72, n_state=32, depth=23 | dim=1792 | 478.3M params
  [Eval 119] Loss: 1.5177
  [Eval 115] GPU 2 | n_heads=129, n_state=32, depth=30 | dim=768 | 478.7M params
  [Eval 115] Loss: 1.7332
  [Eval 120] GPU 7 | n_heads=76, n_state=32, depth=20 | dim=1920 | 470.4M params
  [Eval 120] Loss: 1.6680
  [Eval 117] GPU 4 | n_heads=65, n_state=16, depth=20 | dim=4608 | 486.5M params
  [Eval 117] Loss: 1.4210
  [Eval 114] GPU 1 | n_heads=134, n_state=16, depth=30 | dim=1536 | 500.6M params
  [Eval 114] Loss: 1.5011
  [Eval 116] GPU 3 | n_heads=87, n_state=32, depth=22 | dim=1536 | 473.8M params
  [Eval 116] Loss: 1.5506
  [Eval 118] GPU 5 | n_heads=65, n_state=32, depth=21 | dim=2176 | 478.8M params
  [Eval 118] Loss: 1.6594
   15    120 1.421020000000000e+00 2.3e+00 3.19e-01  2e-01  3e-01 156:25.4

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.4035
Best params: {'n_heads': 71, 'n_state': 16, 'depth': 20}
Total evaluations: 120

To train with best config:
python train.py --level E88 --dim 4224 --n_heads 71 --n_state 16 --depth 20 --lr 3e-4 --expansion 1.0 --use_gate 1 --gate_activation silu --train_minutes 30
