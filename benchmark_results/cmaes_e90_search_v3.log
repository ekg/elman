/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
======================================================================
CMA-ES Search for E90
======================================================================
Search space (3 dimensions):
  n_heads: [32, 128] (int) - Number of heads
  config_idx: [0, 3] (e90_config) - Fast/slow config index
  depth: [12, 32] (int) - Number of layers
Target params: 500M Â± 50M
Training time per config: 2.0 min
Generations: 20
Population: 4
GPUs: [4, 5, 6, 7] (4 parallel)
Total evaluations: ~80
Estimated time: ~40 min (0.7 hours)
======================================================================
(2_w,4mirr1)-aCMA-ES (mu_w=1.5,w_1=80%) in dimension 3 (seed=792247, Thu Jan 29 14:02:31 2026)

--- Generation 1/20 ---
  [Eval 4] GPU 7 | n_heads=61, config_idx=1, depth=13 | dim=4224 | 500.2M params
  [Eval 4] Loss: 1.9749
  [Eval 3] GPU 6 | n_heads=123, config_idx=1, depth=13 | dim=2048 | 488.5M params
  [Eval 3] Loss: 1.9335
  [Eval 2] GPU 5 | n_heads=70, config_idx=1, depth=19 | dim=2560 | 508.0M params
  [Eval 2] Loss: 1.9634
  [Eval 1] GPU 4 | n_heads=76, config_idx=1, depth=21 | dim=2048 | 487.6M params
  [Eval 1] Loss: 1.9884
  *** NEW BEST: 1.9884 | {'n_heads': 76, 'config_idx': 1, 'depth': 21} | dim=2048 ***
  *** NEW BEST: 1.9634 | {'n_heads': 70, 'config_idx': 1, 'depth': 19} | dim=2560 ***
  *** NEW BEST: 1.9335 | {'n_heads': 123, 'config_idx': 1, 'depth': 13} | dim=2048 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      4 1.933511111111111e+00 1.0e+00 3.25e-01  3e-01  3e-01 2:16.3

--- Generation 2/20 ---
  [Eval 7] GPU 6 | n_heads=71, config_idx=1, depth=26 | dim=1792 | 493.4M params
  [Eval 7] Loss: 2.2923
  [Eval 6] GPU 5 | n_heads=125, config_idx=3, depth=20 | dim=640 | 469.0M params
  [Eval 6] Loss: 3.2916
  [Eval 5] GPU 4 | n_heads=116, config_idx=1, depth=15 | dim=1920 | 498.3M params
  [Eval 5] Loss: 2.1147
  [Eval 8] GPU 7 | n_heads=112, config_idx=1, depth=14 | dim=2176 | 509.0M params
  [Eval 8] Loss: 2.0373
    2      8 2.037300000000000e+00 1.3e+00 2.77e-01  3e-01  3e-01 4:33.3

--- Generation 3/20 ---
  [Eval 9] GPU 4 | n_heads=85, config_idx=0, depth=14 | dim=3840 | 499.1M params
  [Eval 9] Loss: 1.8186
  [Eval 11] GPU 6 | n_heads=88, config_idx=1, depth=15 | dim=2560 | 504.2M params
  [Eval 11] Loss: 2.0037
  [Eval 12] GPU 7 | n_heads=123, config_idx=1, depth=22 | dim=1280 | 516.5M params
  [Eval 12] Loss: 2.4988
  [Eval 10] GPU 5 | n_heads=120, config_idx=1, depth=12 | dim=2304 | 495.0M params
  [Eval 10] Loss: 1.9765
  *** NEW BEST: 1.8186 | {'n_heads': 85, 'config_idx': 0, 'depth': 14} | dim=3840 ***
    3     12 1.818556521739130e+00 1.4e+00 3.71e-01  3e-01  3e-01 6:49.8

--- Generation 4/20 ---
  [Eval 13] GPU 4 | n_heads=82, config_idx=0, depth=21 | dim=2688 | 505.3M params
  [Eval 13] Loss: 2.0214
  [Eval 14] GPU 5 | n_heads=58, config_idx=0, depth=17 | dim=4608 | 496.5M params
  [Eval 14] Loss: 1.8367
  [Eval 15] GPU 6 | n_heads=87, config_idx=1, depth=13 | dim=2944 | 496.9M params
  [Eval 15] Loss: 1.9182
  [Eval 16] GPU 7 | n_heads=105, config_idx=2, depth=18 | dim=1280 | 515.7M params
  [Eval 16] Loss: 2.1516
    4     16 1.836717391304348e+00 1.3e+00 3.50e-01  3e-01  3e-01 9:05.9

--- Generation 5/20 ---
  [Eval 20] GPU 7 | n_heads=42, config_idx=1, depth=19 | dim=4224 | 503.4M params
  [Eval 20] Loss: 1.8721
  [Eval 19] GPU 6 | n_heads=32, config_idx=1, depth=15 | dim=6912 | 496.2M params
  [Eval 19] Loss: 1.9863
  [Eval 17] GPU 4 | n_heads=32, config_idx=1, depth=18 | dim=5760 | 495.9M params
  [Eval 17] Loss: 1.9638
  [Eval 18] GPU 5 | n_heads=77, config_idx=0, depth=13 | dim=4608 | 504.0M params
  [Eval 18] Loss: 1.8429
    5     20 1.842921739130435e+00 1.3e+00 2.68e-01  2e-01  2e-01 11:22.1

--- Generation 6/20 ---
  [Eval 23] GPU 6 | n_heads=53, config_idx=0, depth=15 | dim=5760 | 500.7M params
  [Eval 23] Loss: 1.9700
  [Eval 24] GPU 7 | n_heads=71, config_idx=1, depth=12 | dim=3968 | 504.8M params
  [Eval 24] Loss: 1.8519
  [Eval 22] GPU 5 | n_heads=100, config_idx=1, depth=15 | dim=2176 | 486.9M params
  [Eval 22] Loss: 1.9230
  [Eval 21] GPU 4 | n_heads=103, config_idx=0, depth=15 | dim=2944 | 496.6M params
  [Eval 21] Loss: 1.8526
    6     24 1.851856521739131e+00 1.4e+00 2.18e-01  2e-01  2e-01 13:37.9

--- Generation 7/20 ---
  [Eval 27] GPU 6 | n_heads=90, config_idx=0, depth=13 | dim=3968 | 507.1M params
  [Eval 27] Loss: 1.8263
  [Eval 26] GPU 5 | n_heads=98, config_idx=0, depth=12 | dim=3840 | 493.3M params
  [Eval 26] Loss: 1.9102
  [Eval 28] GPU 7 | n_heads=69, config_idx=1, depth=12 | dim=4096 | 506.4M params
  [Eval 28] Loss: 1.8530
  [Eval 25] GPU 4 | n_heads=91, config_idx=0, depth=17 | dim=2944 | 497.2M params
  [Eval 25] Loss: 1.8698
    7     28 1.826272727272727e+00 1.4e+00 1.71e-01  1e-01  1e-01 15:53.9

--- Generation 8/20 ---
  [Eval 29] GPU 4 | n_heads=70, config_idx=1, depth=13 | dim=3712 | 504.3M params
  [Eval 29] Loss: 1.8587
  [Eval 32] GPU 7 | n_heads=84, config_idx=0, depth=13 | dim=4224 | 503.9M params
  [Eval 32] Loss: 1.9174
  [Eval 30] GPU 5 | n_heads=90, config_idx=1, depth=14 | dim=2688 | 505.4M params
  [Eval 30] Loss: 1.8638
  [Eval 31] GPU 6 | n_heads=86, config_idx=0, depth=15 | dim=3584 | 504.9M params
  [Eval 31] Loss: 1.9030
    8     32 1.858681818181818e+00 1.4e+00 1.47e-01  1e-01  1e-01 18:10.8

--- Generation 9/20 ---
  [Eval 34] GPU 5 | n_heads=93, config_idx=1, depth=12 | dim=2944 | 490.3M params
  [Eval 34] Loss: 1.8362
  [Eval 35] GPU 6 | n_heads=88, config_idx=0, depth=14 | dim=3712 | 499.5M params
  [Eval 35] Loss: 1.9153
  [Eval 36] GPU 7 | n_heads=54, config_idx=1, depth=14 | dim=4480 | 505.9M params
  [Eval 36] Loss: 1.9359
  [Eval 33] GPU 4 | n_heads=75, config_idx=1, depth=13 | dim=3456 | 503.0M params
  [Eval 33] Loss: 1.8405
    9     36 1.836171428571429e+00 1.4e+00 1.37e-01  1e-01  1e-01 20:27.1

--- Generation 10/20 ---
  [Eval 38] GPU 5 | n_heads=79, config_idx=1, depth=12 | dim=3584 | 507.2M params
  [Eval 38] Loss: 1.9338
  [Eval 37] GPU 4 | n_heads=93, config_idx=1, depth=12 | dim=2944 | 490.3M params
  [Eval 37] Loss: 1.9287
  [Eval 39] GPU 6 | n_heads=77, config_idx=0, depth=12 | dim=4992 | 504.1M params
  [Eval 39] Loss: 1.8659
  [Eval 40] GPU 7 | n_heads=94, config_idx=1, depth=14 | dim=2560 | 502.7M params
  [Eval 40] Loss: 1.9118
   10     40 1.865937500000000e+00 1.4e+00 1.09e-01  8e-02  8e-02 22:43.4

--- Generation 11/20 ---
  [Eval 42] GPU 5 | n_heads=83, config_idx=0, depth=16 | dim=3456 | 501.2M params
  [Eval 42] Loss: 1.9191
  [Eval 44] GPU 7 | n_heads=88, config_idx=0, depth=13 | dim=3968 | 495.9M params
  [Eval 44] Loss: 1.9013
  [Eval 41] GPU 4 | n_heads=92, config_idx=0, depth=14 | dim=3584 | 504.1M params
  [Eval 41] Loss: 1.8099
  [Eval 43] GPU 6 | n_heads=79, config_idx=0, depth=12 | dim=4864 | 503.9M params
  [Eval 43] Loss: 1.8469
  *** NEW BEST: 1.8099 | {'n_heads': 92, 'config_idx': 0, 'depth': 14} | dim=3584 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     44 1.809900000000000e+00 1.5e+00 1.32e-01  1e-01  1e-01 24:59.0

--- Generation 12/20 ---
  [Eval 45] GPU 4 | n_heads=88, config_idx=0, depth=13 | dim=3968 | 495.9M params
  [Eval 45] Loss: 1.9007
  [Eval 46] GPU 5 | n_heads=84, config_idx=0, depth=13 | dim=4224 | 503.9M params
  [Eval 46] Loss: 1.8328
  [Eval 47] GPU 6 | n_heads=84, config_idx=0, depth=13 | dim=4224 | 503.9M params
  [Eval 47] Loss: 1.8356
  [Eval 48] GPU 7 | n_heads=87, config_idx=1, depth=12 | dim=3200 | 498.6M params
  [Eval 48] Loss: 1.8490
   12     48 1.832845833333334e+00 1.2e+00 1.36e-01  1e-01  1e-01 27:15.6

--- Generation 13/20 ---
  [Eval 49] GPU 4 | n_heads=111, config_idx=0, depth=13 | dim=3200 | 504.2M params
  [Eval 49] Loss: 1.7999
  [Eval 52] GPU 7 | n_heads=91, config_idx=0, depth=16 | dim=3200 | 508.7M params
  [Eval 52] Loss: 1.8563
  [Eval 50] GPU 5 | n_heads=71, config_idx=0, depth=15 | dim=4352 | 506.4M params
  [Eval 50] Loss: 1.9112
  [Eval 51] GPU 6 | n_heads=97, config_idx=0, depth=13 | dim=3584 | 493.6M params
  [Eval 51] Loss: 1.8074
  *** NEW BEST: 1.7999 | {'n_heads': 111, 'config_idx': 0, 'depth': 13} | dim=3200 ***
   13     52 1.799852380952381e+00 1.3e+00 1.80e-01  1e-01  2e-01 29:31.5

--- Generation 14/20 ---
  [Eval 54] GPU 5 | n_heads=117, config_idx=1, depth=13 | dim=2176 | 493.7M params
  [Eval 54] Loss: 1.9811
  [Eval 53] GPU 4 | n_heads=121, config_idx=0, depth=12 | dim=3200 | 507.3M params
  [Eval 53] Loss: 1.9103
  [Eval 55] GPU 6 | n_heads=99, config_idx=0, depth=13 | dim=3584 | 503.8M params
  [Eval 55] Loss: 1.8065
  [Eval 56] GPU 7 | n_heads=93, config_idx=1, depth=14 | dim=2560 | 497.3M params
  [Eval 56] Loss: 1.9974
   14     56 1.806471428571429e+00 1.4e+00 1.67e-01  1e-01  2e-01 31:47.9

--- Generation 15/20 ---
  [Eval 60] GPU 7 | n_heads=111, config_idx=0, depth=14 | dim=2944 | 499.5M params
  [Eval 60] Loss: 1.9152
  [Eval 57] GPU 4 | n_heads=113, config_idx=0, depth=12 | dim=3328 | 492.8M params
  [Eval 57] Loss: 1.9020
  [Eval 58] GPU 5 | n_heads=101, config_idx=0, depth=13 | dim=3456 | 495.6M params
  [Eval 58] Loss: 1.9224
  [Eval 59] GPU 6 | n_heads=114, config_idx=0, depth=13 | dim=3072 | 497.1M params
  [Eval 59] Loss: 1.7914
  *** NEW BEST: 1.7914 | {'n_heads': 114, 'config_idx': 0, 'depth': 13} | dim=3072 ***
   15     60 1.791400000000000e+00 1.4e+00 1.84e-01  1e-01  2e-01 34:04.4

--- Generation 16/20 ---
  [Eval 62] GPU 5 | n_heads=119, config_idx=0, depth=12 | dim=3200 | 499.0M params
  [Eval 62] Loss: 1.8089
  [Eval 61] GPU 4 | n_heads=116, config_idx=0, depth=13 | dim=3072 | 505.8M params
  [Eval 61] Loss: 1.8155
  [Eval 64] GPU 7 | n_heads=101, config_idx=0, depth=12 | dim=3840 | 508.3M params
  [Eval 64] Loss: 1.8209
  [Eval 63] GPU 6 | n_heads=127, config_idx=0, depth=16 | dim=2304 | 511.0M params
  [Eval 63] Loss: 2.1207
   16     64 1.808909090909091e+00 1.4e+00 1.60e-01  1e-01  1e-01 36:20.9

--- Generation 17/20 ---
  [Eval 66] GPU 5 | n_heads=127, config_idx=0, depth=13 | dim=2816 | 507.5M params
  [Eval 66] Loss: 1.9029
  [Eval 65] GPU 4 | n_heads=104, config_idx=0, depth=14 | dim=3200 | 508.7M params
  [Eval 65] Loss: 1.9106
  [Eval 67] GPU 6 | n_heads=127, config_idx=1, depth=13 | dim=2048 | 504.4M params
  [Eval 67] Loss: 1.9733
  [Eval 68] GPU 7 | n_heads=106, config_idx=0, depth=13 | dim=3328 | 500.8M params
  [Eval 68] Loss: 1.8240
   17     68 1.824031818181818e+00 1.4e+00 1.20e-01  7e-02  1e-01 38:37.3

--- Generation 18/20 ---
  [Eval 69] GPU 4 | n_heads=108, config_idx=0, depth=13 | dim=3200 | 490.6M params
  [Eval 69] Loss: 1.9037
  [Eval 71] GPU 6 | n_heads=110, config_idx=0, depth=13 | dim=3200 | 499.7M params
  [Eval 71] Loss: 1.9068
  [Eval 72] GPU 7 | n_heads=126, config_idx=0, depth=13 | dim=2816 | 503.5M params
  [Eval 72] Loss: 1.9014
  [Eval 70] GPU 5 | n_heads=123, config_idx=0, depth=14 | dim=2688 | 505.3M params
  [Eval 70] Loss: 1.8437
   18     72 1.843700000000000e+00 1.5e+00 1.38e-01  9e-02  1e-01 40:53.8

--- Generation 19/20 ---
  [Eval 73] GPU 4 | n_heads=124, config_idx=0, depth=12 | dim=3072 | 499.1M params
  [Eval 73] Loss: 1.8936
  [Eval 74] GPU 5 | n_heads=125, config_idx=0, depth=14 | dim=2560 | 489.0M params
  [Eval 74] Loss: 1.8412
  [Eval 76] GPU 7 | n_heads=114, config_idx=0, depth=12 | dim=3328 | 497.1M params
  [Eval 76] Loss: 1.9097
  [Eval 75] GPU 6 | n_heads=96, config_idx=0, depth=14 | dim=3456 | 507.2M params
  [Eval 75] Loss: 1.8078
   19     76 1.807823809523809e+00 1.8e+00 1.86e-01  1e-01  2e-01 43:09.9

--- Generation 20/20 ---
  [Eval 79] GPU 6 | n_heads=102, config_idx=0, depth=16 | dim=2816 | 501.7M params
  [Eval 79] Loss: 1.9877
  [Eval 77] GPU 4 | n_heads=90, config_idx=0, depth=15 | dim=3328 | 490.6M params
  [Eval 77] Loss: 1.9161
  [Eval 78] GPU 5 | n_heads=102, config_idx=0, depth=13 | dim=3456 | 500.5M params
  [Eval 78] Loss: 1.9091
  [Eval 80] GPU 7 | n_heads=109, config_idx=0, depth=16 | dim=2688 | 511.7M params
  [Eval 80] Loss: 1.9005
   20     80 1.900515789473684e+00 1.8e+00 1.90e-01  1e-01  2e-01 45:26.4

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.7914
Best params: {'n_heads': 114, 'config_idx': 0, 'depth': 13}
Total evaluations: 80

To train with best config:
python train.py --level E90 --dim 3072 --n_heads 114 --k_fast 8 --k_slow 16 --depth 13 --lr 3e-4 --use_gate 1 --gate_activation silu --train_minutes 30
