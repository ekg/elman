Loading data from data/fineweb_100mb.txt...

Creating mamba2 model with ~50m parameters...
Created Mamba2 model: dim=672, depth=18, expand=2, params=50,928,750

============================================================
Training: mamba2
Parameters: 50.93M
============================================================
[mamba2] step    1 | loss 5.7188 | ppl 304.5 | grad 4.34 | 607 tok/s | 13486ms/step
[mamba2] step  100 | loss 1.8281 | ppl 6.2 | grad 1.91 | 33725 tok/s | 113ms/step
[mamba2] step  200 | loss 1.6562 | ppl 5.2 | grad 1.60 | 46328 tok/s | 107ms/step
[mamba2] step  300 | loss 1.4062 | ppl 4.1 | grad 1.28 | 52889 tok/s | 111ms/step
[mamba2] step  400 | loss 1.4922 | ppl 4.4 | grad 1.31 | 56951 tok/s | 116ms/step
[mamba2] step  500 | loss 1.2969 | ppl 3.7 | grad 1.16 | 59958 tok/s | 107ms/step
[mamba2] step  600 | loss 1.5547 | ppl 4.7 | grad 1.47 | 62215 tok/s | 106ms/step
[mamba2] step  700 | loss 1.3594 | ppl 3.9 | grad 1.25 | 63965 tok/s | 107ms/step
[mamba2] step  800 | loss 1.3906 | ppl 4.0 | grad 1.52 | 65351 tok/s | 106ms/step
[mamba2] step  900 | loss 1.7891 | ppl 6.0 | grad 1.95 | 66469 tok/s | 110ms/step
[mamba2] step 1000 | loss 1.5078 | ppl 4.5 | grad 1.36 | 67339 tok/s | 115ms/step

mamba2 Final: loss=1.9091, grad=1.74, time=121.7s

======================================================================
BENCHMARK SUMMARY
======================================================================
Model           Params       Final Loss   Grad Norm    Time (s)  
----------------------------------------------------------------------
mamba2          50.93M       1.9091       1.74         121.7     

Results saved to: benchmark_results/compare
