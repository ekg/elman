/home/erikg/elman/elman/models/multiscale_elman.py:83: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  logit = torch.log(torch.tensor(decay / (1 - decay)))
======================================================================
E10 LOW-K SWEEP (k=1,2,4,8)
======================================================================
E1:       dim=1280, depth=6, params=49,505,280
E10 k=1: dim=1184, depth=6, params=50,800,704
E10 k=2: dim=1088, depth=6, params=50,030,592
E10 k=4: dim=960, depth=6, params=50,054,400
E10 k=8: dim=800, depth=6, params=50,179,200

Total: 5 configs

======================================================================
LAUNCHING 5 JOBS
======================================================================
[START] GPU 0: e1 (dim=1280, k=1, batch=256)
[START] GPU 1: e10_k1 (dim=1184, k=1, batch=256)
[START] GPU 2: e10_k2 (dim=1088, k=2, batch=224)
[START] GPU 3: e10_k4 (dim=960, k=4, batch=192)
[START] GPU 4: e10_k8 (dim=800, k=8, batch=160)

--- 0/5 done, 5 running ---
[DONE] GPU 1: e10_k1 (30s)
[DONE] GPU 2: e10_k2 (30s)
[DONE] GPU 3: e10_k4 (30s)
[DONE] GPU 4: e10_k8 (30s)

--- 4/5 done, 1 running ---

--- 4/5 done, 1 running ---

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.7344 | Avg100 2.0884 | 114550 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.7344 | Avg100 2.0884 | 114550 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.7344 | Avg100 2.0884 | 114550 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.7344 | Avg100 2.0884 | 114550 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.6406 | Avg100 1.6666 | 111930 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.6406 | Avg100 1.6666 | 111930 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.6406 | Avg100 1.6666 | 111930 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.6406 | Avg100 1.6666 | 111930 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5469 | Avg100 1.5891 | 111228 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5469 | Avg100 1.5891 | 111228 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5469 | Avg100 1.5891 | 111228 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5469 | Avg100 1.5891 | 111228 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5078 | Avg100 1.5520 | 110691 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5078 | Avg100 1.5520 | 110691 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5078 | Avg100 1.5520 | 110691 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5078 | Avg100 1.5520 | 110691 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...1.5469 | Avg100 1.5195 | 110515 tok/s | Mem 20.5GB

--- 4/5 done, 1 running ---
  GPU 0 e1: ...s | Last100=1.5154 | 111598 tok/s | PeakMem=20.5GB
[DONE] GPU 0: e1 (630s)

======================================================================
FINAL RESULTS (sorted by loss)
======================================================================
Name         k    dim   params       Loss     Tok/s      Mem
----------------------------------------------------------------------
e10_k2       2    1088  50,030,592   1.4033   196,544    25.3GB
e10_k4       4    960   50,054,400   1.4127   190,353    26.8GB
e10_k1       1    1184  50,800,704   1.4176   216,851    25.2GB
e10_k8       8    800   50,179,200   1.4430   158,439    29.2GB
e1           1    1280  49,505,280   1.5154   111,598    20.5GB
