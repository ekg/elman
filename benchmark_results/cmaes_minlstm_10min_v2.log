/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'expansion': 2, 'depth': 20}
Encoded x0: ['0.333', '0.286']
======================================================================
CMA-ES Search for MINLSTM
======================================================================
Search space (2 dimensions):
  expansion: [1, 4] (int) - Expansion factor
  depth: [12, 40] (int) - Number of layers
Target params: 480M Â± 30M
Training time per config: 10.0 min
Generations: 15
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~120
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 2 (seed=524595, Mon Jan 26 23:59:57 2026)

--- Generation 1/15 ---
  [Eval 2] Skip - params 446.2M vs target 480M
  [Eval 7] GPU 6 | expansion=2, depth=19 | dim=1280 | 498.4M params
  [Eval 7] Loss: 1.9075
  [Eval 6] Skip - params 531.1M vs target 480M
  [Eval 4] GPU 3 | expansion=1, depth=12 | dim=2816 | 476.5M params
  [Eval 4] Loss: 1.7240
  [Eval 1] GPU 0 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 1] Loss: 1.7213
  [Eval 5] GPU 4 | expansion=2, depth=22 | dim=1152 | 467.4M params
  [Eval 5] Loss: 2.1266
  [Eval 3] GPU 2 | expansion=1, depth=28 | dim=1792 | 450.0M params
  [Eval 3] Loss: 1.7246
  [Eval 8] GPU 7 | expansion=1, depth=14 | dim=2560 | 459.4M params
  [Eval 8] Loss: 1.7168
  *** NEW BEST: 1.7213 | {'expansion': 1, 'depth': 22} | dim=2048 ***
  *** NEW BEST: 1.7168 | {'expansion': 1, 'depth': 14} | dim=2560 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.716766000000000e+00 1.0e+00 2.15e-01  2e-01  2e-01 10:13.4

--- Generation 2/15 ---
  [Eval 15] Skip - params 531.1M vs target 480M
  [Eval 13] GPU 4 | expansion=1, depth=23 | dim=2048 | 482.9M params
  [Eval 13] Loss: 1.5741
  [Eval 11] GPU 2 | expansion=2, depth=12 | dim=1536 | 453.4M params
  [Eval 11] Loss: 2.0512
  [Eval 9] GPU 0 | expansion=2, depth=16 | dim=1408 | 507.9M params
  [Eval 9] Loss: 1.9016
  [Eval 12] GPU 3 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 12] Loss: 1.7263
  [Eval 16] GPU 7 | expansion=1, depth=15 | dim=2560 | 492.2M params
  [Eval 16] Loss: 1.5646
  [Eval 10] GPU 1 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 10] Loss: 1.5733
  [Eval 14] GPU 5 | expansion=2, depth=16 | dim=1408 | 507.9M params
  [Eval 14] Loss: 1.8866
  *** NEW BEST: 1.5733 | {'expansion': 1, 'depth': 21} | dim=2176 ***
  *** NEW BEST: 1.5646 | {'expansion': 1, 'depth': 15} | dim=2560 ***
    2     16 1.564604000000000e+00 1.1e+00 2.06e-01  2e-01  2e-01 20:27.8

--- Generation 3/15 ---
  [Eval 23] GPU 6 | expansion=1, depth=18 | dim=2304 | 478.3M params
  [Eval 23] Loss: 1.7316
  [Eval 17] GPU 0 | expansion=2, depth=18 | dim=1280 | 472.2M params
  [Eval 17] Loss: 2.1064
  [Eval 22] GPU 5 | expansion=2, depth=23 | dim=1152 | 488.7M params
  [Eval 22] Loss: 1.9275
  [Eval 20] GPU 3 | expansion=1, depth=15 | dim=2560 | 492.2M params
  [Eval 20] Loss: 1.5631
  [Eval 18] GPU 1 | expansion=2, depth=24 | dim=1152 | 509.9M params
  [Eval 18] Loss: 1.9513
  [Eval 21] GPU 4 | expansion=2, depth=28 | dim=1024 | 470.0M params
  [Eval 21] Loss: 2.1781
  [Eval 24] GPU 7 | expansion=1, depth=28 | dim=1792 | 450.0M params
  [Eval 24] Loss: 1.7230
  [Eval 19] GPU 2 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 19] Loss: 1.5706
  *** NEW BEST: 1.5631 | {'expansion': 1, 'depth': 15} | dim=2560 ***
    3     24 1.563067000000000e+00 1.3e+00 2.27e-01  2e-01  2e-01 30:41.4

--- Generation 4/15 ---
  [Eval 26] Skip - params 446.0M vs target 480M
  [Eval 25] GPU 0 | expansion=2, depth=12 | dim=1536 | 453.4M params
  [Eval 25] Loss: 2.0512
  [Eval 30] Skip - params 444.4M vs target 480M
  [Eval 28] GPU 3 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 28] Loss: 1.5697
  [Eval 31] GPU 6 | expansion=2, depth=15 | dim=1408 | 476.2M params
  [Eval 31] Loss: 2.0933
  [Eval 29] GPU 4 | expansion=1, depth=18 | dim=2304 | 478.3M params
  [Eval 29] Loss: 1.7256
  [Eval 32] GPU 7 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 32] Loss: 1.5712
  [Eval 27] GPU 2 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 27] Loss: 1.5767
    4     32 1.569730000000000e+00 1.2e+00 2.50e-01  2e-01  2e-01 40:55.6

--- Generation 5/15 ---
  [Eval 39] GPU 6 | expansion=2, depth=22 | dim=1152 | 467.4M params
  [Eval 39] Loss: 2.1328
  [Eval 34] Skip - params 520.4M vs target 480M
  [Eval 37] GPU 4 | expansion=2, depth=29 | dim=1024 | 486.8M params
  [Eval 37] Loss: 1.9665
  [Eval 35] GPU 2 | expansion=2, depth=22 | dim=1152 | 467.4M params
  [Eval 35] Loss: 2.1328
  [Eval 40] GPU 7 | expansion=1, depth=13 | dim=2688 | 470.3M params
  [Eval 40] Loss: 1.7179
  [Eval 38] GPU 5 | expansion=2, depth=27 | dim=1024 | 453.2M params
  [Eval 38] Loss: 2.1505
  [Eval 33] GPU 0 | expansion=1, depth=26 | dim=1920 | 479.7M params
  [Eval 33] Loss: 1.7497
  [Eval 36] GPU 3 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 36] Loss: 1.5705
    5     40 1.570464000000000e+00 1.4e+00 2.04e-01  1e-01  2e-01 51:09.6

--- Generation 6/15 ---
  [Eval 43] Skip - params 436.5M vs target 480M
  [Eval 42] GPU 1 | expansion=1, depth=26 | dim=1920 | 479.7M params
  [Eval 42] Loss: 1.7346
  [Eval 48] GPU 7 | expansion=1, depth=20 | dim=2176 | 474.1M params
  [Eval 48] Loss: 1.7271
  [Eval 46] GPU 5 | expansion=1, depth=31 | dim=1792 | 498.2M params
  [Eval 46] Loss: 1.5608
  [Eval 45] GPU 4 | expansion=1, depth=20 | dim=2176 | 474.1M params
  [Eval 45] Loss: 1.7259
  [Eval 47] GPU 6 | expansion=2, depth=24 | dim=1152 | 509.9M params
  [Eval 47] Loss: 1.9339
  [Eval 41] GPU 0 | expansion=1, depth=12 | dim=2816 | 476.5M params
  [Eval 41] Loss: 1.7261
  [Eval 44] GPU 3 | expansion=1, depth=17 | dim=2432 | 503.4M params
  [Eval 44] Loss: 1.5698
  *** NEW BEST: 1.5608 | {'expansion': 1, 'depth': 31} | dim=1792 ***
    6     48 1.560760000000000e+00 1.5e+00 2.02e-01  1e-01  2e-01 61:24.8

--- Generation 7/15 ---
  [Eval 55] GPU 6 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 55] Loss: 1.7315
  [Eval 50] Skip - params 514.3M vs target 480M
  [Eval 53] GPU 4 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 53] Loss: 1.5715
  [Eval 52] GPU 3 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 52] Loss: 1.5706
  [Eval 49] GPU 0 | expansion=1, depth=34 | dim=1664 | 471.1M params
  [Eval 49] Loss: 1.7549
  [Eval 51] GPU 2 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 51] Loss: 1.7279
  [Eval 54] GPU 5 | expansion=1, depth=30 | dim=1792 | 482.1M params
  [Eval 54] Loss: 1.5826
  [Eval 56] GPU 7 | expansion=1, depth=17 | dim=2432 | 503.4M params
  [Eval 56] Loss: 1.5792
    7     56 1.570614000000000e+00 2.0e+00 1.60e-01  7e-02  2e-01 71:40.8

--- Generation 8/15 ---
  [Eval 61] Skip - params 524.6M vs target 480M
  [Eval 64] GPU 7 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 64] Loss: 1.5723
  [Eval 62] GPU 5 | expansion=1, depth=16 | dim=2432 | 473.8M params
  [Eval 62] Loss: 1.7345
  [Eval 58] GPU 1 | expansion=1, depth=28 | dim=1792 | 450.0M params
  [Eval 58] Loss: 1.7234
  [Eval 57] GPU 0 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 57] Loss: 1.5762
  [Eval 63] GPU 6 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 63] Loss: 1.5694
  [Eval 59] GPU 2 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 59] Loss: 1.7213
  [Eval 60] GPU 3 | expansion=1, depth=13 | dim=2688 | 470.3M params
  [Eval 60] Loss: 1.7188
    8     64 1.569390000000000e+00 2.2e+00 1.82e-01  9e-02  2e-01 81:54.5

--- Generation 9/15 ---
  [Eval 67] GPU 2 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 67] Loss: 1.7213
  [Eval 65] GPU 0 | expansion=1, depth=27 | dim=1920 | 498.2M params
  [Eval 65] Loss: 1.5802
  [Eval 69] GPU 4 | expansion=1, depth=23 | dim=2048 | 482.9M params
  [Eval 69] Loss: 1.5722
  [Eval 71] GPU 6 | expansion=1, depth=17 | dim=2432 | 503.4M params
  [Eval 71] Loss: 1.5728
  [Eval 66] GPU 1 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 66] Loss: 1.5803
  [Eval 70] GPU 5 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 70] Loss: 1.5699
  [Eval 72] GPU 7 | expansion=1, depth=16 | dim=2432 | 473.8M params
  [Eval 72] Loss: 1.7357
  [Eval 68] GPU 3 | expansion=1, depth=20 | dim=2176 | 474.1M params
  [Eval 68] Loss: 1.7349
    9     72 1.569874000000000e+00 1.9e+00 1.48e-01  7e-02  1e-01 92:09.2

--- Generation 10/15 ---
  [Eval 75] GPU 2 | expansion=1, depth=20 | dim=2176 | 474.1M params
  [Eval 75] Loss: 1.7276
  [Eval 73] GPU 0 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 73] Loss: 1.7271
  [Eval 80] GPU 7 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 80] Loss: 1.7292
  [Eval 79] GPU 6 | expansion=1, depth=26 | dim=1920 | 479.7M params
  [Eval 79] Loss: 1.7497
  [Eval 77] GPU 4 | expansion=1, depth=23 | dim=2048 | 482.9M params
  [Eval 77] Loss: 1.5671
  [Eval 74] GPU 1 | expansion=1, depth=17 | dim=2432 | 503.4M params
  [Eval 74] Loss: 1.5676
  [Eval 78] GPU 5 | expansion=1, depth=23 | dim=2048 | 482.9M params
  [Eval 78] Loss: 1.5691
  [Eval 76] GPU 3 | expansion=1, depth=27 | dim=1920 | 498.2M params
  [Eval 76] Loss: 1.5687
   10     80 1.567057000000000e+00 1.8e+00 1.05e-01  4e-02  8e-02 102:23.7

--- Generation 11/15 ---
  [Eval 88] GPU 7 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 88] Loss: 1.5694
  [Eval 84] GPU 3 | expansion=1, depth=27 | dim=1920 | 498.2M params
  [Eval 84] Loss: 1.5688
  [Eval 85] GPU 4 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 85] Loss: 1.5726
  [Eval 86] GPU 5 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 86] Loss: 1.5699
  [Eval 87] GPU 6 | expansion=1, depth=23 | dim=2048 | 482.9M params
  [Eval 87] Loss: 1.5668
  [Eval 82] GPU 1 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 82] Loss: 1.5707
  [Eval 81] GPU 0 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 81] Loss: 1.5824
  [Eval 83] GPU 2 | expansion=1, depth=15 | dim=2560 | 492.2M params
  [Eval 83] Loss: 1.5751
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     88 1.566770000000000e+00 1.8e+00 1.08e-01  5e-02  8e-02 112:38.3

--- Generation 12/15 ---
  [Eval 94] GPU 5 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 94] Loss: 1.7309
  [Eval 93] GPU 4 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 93] Loss: 1.7213
  [Eval 95] GPU 6 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 95] Loss: 1.7315
  [Eval 91] GPU 2 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 91] Loss: 1.7308
  [Eval 90] GPU 1 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 90] Loss: 1.5694
  [Eval 96] GPU 7 | expansion=1, depth=27 | dim=1920 | 498.2M params
  [Eval 96] Loss: 1.5727
  [Eval 92] GPU 3 | expansion=1, depth=27 | dim=1920 | 498.2M params
  [Eval 92] Loss: 1.5687
  [Eval 89] GPU 0 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 89] Loss: 1.5692
   12     96 1.568684000000000e+00 1.7e+00 1.02e-01  4e-02  8e-02 122:52.6

--- Generation 13/15 ---
  [Eval 103] GPU 6 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 103] Loss: 1.7315
  [Eval 97] GPU 0 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 97] Loss: 1.5692
  [Eval 102] GPU 5 | expansion=1, depth=26 | dim=1920 | 479.7M params
  [Eval 102] Loss: 1.7410
  [Eval 98] GPU 1 | expansion=1, depth=26 | dim=1920 | 479.7M params
  [Eval 98] Loss: 1.7380
  [Eval 101] GPU 4 | expansion=1, depth=25 | dim=1920 | 461.3M params
  [Eval 101] Loss: 1.7279
  [Eval 104] GPU 7 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 104] Loss: 1.7292
  [Eval 100] GPU 3 | expansion=1, depth=23 | dim=2048 | 482.9M params
  [Eval 100] Loss: 1.5716
  [Eval 99] GPU 2 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 99] Loss: 1.5720
   13    104 1.569174000000000e+00 2.2e+00 1.26e-01  5e-02  1e-01 133:07.1

--- Generation 14/15 ---
  [Eval 109] GPU 4 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 109] Loss: 1.5715
  [Eval 111] GPU 6 | expansion=1, depth=18 | dim=2304 | 478.3M params
  [Eval 111] Loss: 1.7264
  [Eval 112] GPU 7 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 112] Loss: 1.5733
  [Eval 106] GPU 1 | expansion=1, depth=19 | dim=2304 | 504.9M params
  [Eval 106] Loss: 1.5797
  [Eval 108] GPU 3 | expansion=1, depth=16 | dim=2432 | 473.8M params
  [Eval 108] Loss: 1.7347
  [Eval 107] GPU 2 | expansion=1, depth=17 | dim=2432 | 503.4M params
  [Eval 107] Loss: 1.5717
  [Eval 105] GPU 0 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 105] Loss: 1.7198
  [Eval 110] GPU 5 | expansion=1, depth=21 | dim=2176 | 497.7M params
  [Eval 110] Loss: 1.5694
   14    112 1.569427000000000e+00 3.2e+00 1.30e-01  5e-02  1e-01 143:22.4

--- Generation 15/15 ---
  [Eval 117] GPU 4 | expansion=1, depth=22 | dim=2048 | 461.9M params
  [Eval 117] Loss: 1.7213
  [Eval 120] GPU 7 | expansion=1, depth=20 | dim=2176 | 474.1M params
  [Eval 120] Loss: 1.7271
  [Eval 113] GPU 0 | expansion=1, depth=18 | dim=2304 | 478.3M params
  [Eval 113] Loss: 1.7289
  [Eval 114] GPU 1 | expansion=1, depth=15 | dim=2560 | 492.2M params
  [Eval 114] Loss: 1.5659
  [Eval 119] GPU 6 | expansion=1, depth=28 | dim=1792 | 450.0M params
  [Eval 119] Loss: 1.7238
  [Eval 115] GPU 2 | expansion=1, depth=18 | dim=2304 | 478.3M params
  [Eval 115] Loss: 1.7273
  [Eval 118] GPU 5 | expansion=1, depth=18 | dim=2304 | 478.3M params
  [Eval 118] Loss: 1.7256
  [Eval 116] GPU 3 | expansion=1, depth=24 | dim=2048 | 503.8M params
  [Eval 116] Loss: 1.5685
   15    120 1.565931000000000e+00 2.4e+00 1.20e-01  5e-02  1e-01 153:37.5

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.5608
Best params: {'expansion': 1, 'depth': 31}
Total evaluations: 120

To train with best config:
python train.py --level minlstm --dim 1792 --depth 31 --expansion 1 --lr 3e-4 --train_minutes 30
