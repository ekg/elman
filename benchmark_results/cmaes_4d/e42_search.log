CMA-ES 4D Search for e42
Started: 2026-02-02T18:56:12.255374
Command: python cmaes_search.py --model e42 --train_minutes 30 --converge 0.01 --gpus 0,1,2,3,4,5,6,7 --params 480M --output benchmark_results/cmaes_4d --start_from_best
======================================================================

/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'dim': 2944, 'expansion': 1, 'depth': 19, 'spectral_radius': 0.999, 'mamba2_init': 0, 'lr': 0.0003}
Encoded x0: ['0.938', '0.000', '0.194', '0.982', '0.250', '0.739']
======================================================================
CMA-ES Search for E42
======================================================================
Search space (6 dimensions):
  dim: [1024, 3072] (int_mult128) - Model dimension
  expansion: [1, 3] (int) - Expansion factor for d_inner
  depth: [12, 48] (int) - Number of layers
  spectral_radius: [0.95, 0.9999] (float) - Target spectral radius for W (stability)
  mamba2_init: [0, 1] (binary) - Init strategy (0=xavier, 1=mamba2)
  lr: [1e-05, 0.001] (log) - Learning rate (log scale)
Target params: 480M Â± 50M
Training time per config: 30.0 min
Convergence mode: stop when improvement < 0.01
Max generations: 1000
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 6 (seed=231597, Mon Feb  2 18:56:12 2026)

--- Generation 1 (converge threshold: 0.01) ---
  [Eval 1] GPU 0 | dim=3072, expansion=1, depth=16, spectral_radius=0.9922, mamba2_init=1, lr=0.0002978 | dim=3072 | 453.9M params
  [Eval 1] NaN/diverged (loss=inf)
  [Eval 3] GPU 2 | dim=2816, expansion=1, depth=12, spectral_radius=0.9899, mamba2_init=0, lr=0.0001178 | dim=2816 | 286.3M params
  [Eval 3] Loss: 1.4958
  [Eval 6] GPU 5 | dim=2816, expansion=1, depth=18, spectral_radius=0.9946, mamba2_init=0, lr=0.0004015 | dim=2816 | 429.0M params
  [Eval 6] Loss: 1.6328
  [Eval 2] GPU 1 | dim=3072, expansion=1, depth=12, spectral_radius=0.9895, mamba2_init=0, lr=0.0006837 | dim=3072 | 340.6M params
  [Eval 2] Loss: 1.7286
  [Eval 5] GPU 4 | dim=2816, expansion=1, depth=17, spectral_radius=0.9884, mamba2_init=0, lr=0.0003642 | dim=2816 | 405.2M params
  [Eval 5] Loss: 1.6659
  [Eval 4] GPU 3 | dim=3072, expansion=1, depth=12, spectral_radius=0.9952, mamba2_init=0, lr=0.0001872 | dim=3072 | 340.6M params
  [Eval 4] Loss: 1.5787
  [Eval 7] GPU 6 | dim=2944, expansion=1, depth=26, spectral_radius=0.9838, mamba2_init=0, lr=0.0002072 | dim=2944 | 676.9M params
  [Eval 7] Loss: 1.6807
  [Eval 8] GPU 7 | dim=2688, expansion=1, depth=22, spectral_radius=0.9937, mamba2_init=0, lr=0.0001615 | dim=2688 | 477.7M params
  [Eval 8] Loss: 1.5826
  *** NEW BEST: 10.0000 | {'dim': 3072, 'expansion': 1, 'depth': 16, 'spectral_radius': 0.9922387788025994, 'mamba2_init': 1, 'lr': 0.00029781525064105787} | dim=0 ***
  *** NEW BEST: 1.7286 | {'dim': 3072, 'expansion': 1, 'depth': 12, 'spectral_radius': 0.989540767057889, 'mamba2_init': 0, 'lr': 0.000683730717697503} | dim=3072 ***
  *** NEW BEST: 1.4958 | {'dim': 2816, 'expansion': 1, 'depth': 12, 'spectral_radius': 0.9898648379375575, 'mamba2_init': 0, 'lr': 0.0001177552169072427} | dim=2816 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.495822000000000e+00 1.0e+00 1.58e-01  1e-01  2e-01 30:21.2
  Generation best: 1.4958 | Overall best: 1.4958 | Improvement: inf

--- Generation 2 (converge threshold: 0.01) ---
  [Eval 11] GPU 2 | dim=2304, expansion=1, depth=12, spectral_radius=0.9998, mamba2_init=0, lr=0.0003303 | dim=2304 | 191.8M params
  [Eval 11] Loss: 1.4397
  [Eval 13] GPU 4 | dim=2944, expansion=1, depth=12, spectral_radius=0.9808, mamba2_init=0, lr=3.508e-05 | dim=2944 | 312.8M params
  [Eval 13] Loss: 1.5086
  [Eval 12] GPU 3 | dim=2688, expansion=1, depth=12, spectral_radius=0.9997, mamba2_init=0, lr=0.0003549 | dim=2688 | 260.9M params
  [Eval 12] Loss: 1.5388
  [Eval 16] GPU 7 | dim=2816, expansion=1, depth=19, spectral_radius=0.9899, mamba2_init=0, lr=0.0001817 | dim=2816 | 452.8M params
  [Eval 16] Loss: 1.5664
  [Eval 15] GPU 6 | dim=2816, expansion=1, depth=17, spectral_radius=0.9992, mamba2_init=0, lr=4.246e-05 | dim=2816 | 405.2M params
  [Eval 15] Loss: 1.4895
  [Eval 14] GPU 5 | dim=3072, expansion=1, depth=14, spectral_radius=0.9998, mamba2_init=0, lr=6.393e-05 | dim=3072 | 397.2M params
  [Eval 14] Loss: 1.5647
  [Eval 9] GPU 0 | dim=2816, expansion=1, depth=22, spectral_radius=0.9967, mamba2_init=0, lr=0.0001674 | dim=2816 | 524.2M params
  [Eval 9] Loss: 1.5608
  [Eval 10] GPU 1 | dim=2560, expansion=1, depth=33, spectral_radius=0.9935, mamba2_init=0, lr=0.0001077 | dim=2560 | 649.6M params
  [Eval 10] Loss: 1.5400
  *** NEW BEST: 1.4397 | {'dim': 2304, 'expansion': 1, 'depth': 12, 'spectral_radius': 0.9998232415600209, 'mamba2_init': 0, 'lr': 0.0003302951185930548} | dim=2304 ***
    2     16 1.439699000000000e+00 1.4e+00 1.68e-01  1e-01  2e-01 60:41.1
  Generation best: 1.4397 | Overall best: 1.4397 | Improvement: 0.0561

--- Generation 3 (converge threshold: 0.01) ---
  [Eval 23] GPU 6 | dim=2048, expansion=1, depth=15, spectral_radius=0.9939, mamba2_init=0, lr=9.012e-05 | dim=2048 | 189.3M params
  [Eval 23] Loss: 1.4343
  [Eval 18] GPU 1 | dim=2432, expansion=1, depth=12, spectral_radius=0.9994, mamba2_init=0, lr=0.0001349 | dim=2432 | 213.6M params
  [Eval 18] Loss: 1.4230
  [Eval 17] GPU 0 | dim=2688, expansion=1, depth=14, spectral_radius=0.9997, mamba2_init=0, lr=5.467e-05 | dim=2688 | 304.2M params
  [Eval 17] Loss: 1.5113
  [Eval 22] GPU 5 | dim=2816, expansion=1, depth=15, spectral_radius=0.9989, mamba2_init=0, lr=5.668e-05 | dim=2816 | 357.7M params
  [Eval 22] Loss: 1.4855
  [Eval 21] GPU 4 | dim=2304, expansion=1, depth=21, spectral_radius=0.9995, mamba2_init=0, lr=0.0001439 | dim=2304 | 335.1M params
  [Eval 21] Loss: 1.5206
  [Eval 24] GPU 7 | dim=2816, expansion=1, depth=22, spectral_radius=0.9872, mamba2_init=0, lr=0.0006034 | dim=2816 | 524.2M params
  [Eval 24] Loss: 1.7090
  [Eval 19] GPU 2 | dim=2816, expansion=2, depth=13, spectral_radius=0.9983, mamba2_init=0, lr=5.11e-05 | dim=2816 | 825.5M params
  [Eval 19] Loss: 1.6425
  [Eval 20] GPU 3 | dim=2176, expansion=1, depth=13, spectral_radius=0.9948, mamba2_init=0, lr=0.000149 | dim=2176 | 185.3M params
  [Eval 20] Loss: 1.3973
  *** NEW BEST: 1.4230 | {'dim': 2432, 'expansion': 1, 'depth': 12, 'spectral_radius': 0.9993990297587135, 'mamba2_init': 0, 'lr': 0.00013494201480698722} | dim=2432 ***
  *** NEW BEST: 1.3973 | {'dim': 2176, 'expansion': 1, 'depth': 13, 'spectral_radius': 0.9948038090766461, 'mamba2_init': 0, 'lr': 0.00014899027573940683} | dim=2176 ***
    3     24 1.397274000000000e+00 1.6e+00 1.70e-01  1e-01  2e-01 91:03.7
  Generation best: 1.3973 | Overall best: 1.3973 | Improvement: 0.0424

--- Generation 4 (converge threshold: 0.01) ---
  [Eval 28] GPU 3 | dim=1792, expansion=1, depth=18, spectral_radius=0.9894, mamba2_init=0, lr=0.0002266 | dim=1792 | 173.9M params
  [Eval 28] Loss: 1.3897
  [Eval 29] GPU 4 | dim=1792, expansion=1, depth=18, spectral_radius=0.9906, mamba2_init=0, lr=7.377e-05 | dim=1792 | 173.9M params
  [Eval 29] Loss: 1.3766
  [Eval 32] GPU 7 | dim=2560, expansion=1, depth=20, spectral_radius=0.9969, mamba2_init=0, lr=0.0001841 | dim=2560 | 394.0M params
  [Eval 32] Loss: 1.5324
  [Eval 26] GPU 1 | dim=1920, expansion=1, depth=21, spectral_radius=0.997, mamba2_init=0, lr=6.225e-05 | dim=1920 | 232.8M params
  [Eval 26] Loss: 1.4250
  [Eval 30] GPU 5 | dim=2176, expansion=1, depth=22, spectral_radius=0.9999, mamba2_init=0, lr=0.0001119 | dim=2176 | 313.2M params
  [Eval 30] Loss: 1.5250
  [Eval 27] GPU 2 | dim=1792, expansion=1, depth=16, spectral_radius=0.9943, mamba2_init=0, lr=0.0001103 | dim=1792 | 154.7M params
  [Eval 27] NaN/diverged (loss=inf)
  [Eval 31] GPU 6 | dim=1664, expansion=1, depth=12, spectral_radius=0.9952, mamba2_init=0, lr=0.0001038 | dim=1664 | 100.1M params
  [Eval 31] Loss: 1.2279
  [Eval 25] GPU 0 | dim=2048, expansion=1, depth=12, spectral_radius=0.9999, mamba2_init=0, lr=0.0001923 | dim=2048 | 151.6M params
  [Eval 25] Loss: 1.3738
  *** NEW BEST: 1.3738 | {'dim': 2048, 'expansion': 1, 'depth': 12, 'spectral_radius': 0.9998996885416451, 'mamba2_init': 0, 'lr': 0.00019227808503650078} | dim=2048 ***
  *** NEW BEST: 1.2279 | {'dim': 1664, 'expansion': 1, 'depth': 12, 'spectral_radius': 0.9951902830536646, 'mamba2_init': 0, 'lr': 0.00010380378863187945} | dim=1664 ***
    4     32 1.227869000000000e+00 1.7e+00 1.87e-01  2e-01  2e-01 121:18.6
  Generation best: 1.2279 | Overall best: 1.2279 | Improvement: 0.1694

--- Generation 5 (converge threshold: 0.01) ---
  [Eval 33] GPU 0 | dim=1408, expansion=1, depth=21, spectral_radius=0.9894, mamba2_init=0, lr=0.0001186 | dim=1408 | 125.3M params
  [Eval 33] Loss: 1.3597
  [Eval 40] GPU 7 | dim=1408, expansion=1, depth=17, spectral_radius=0.9999, mamba2_init=0, lr=0.0002124 | dim=1408 | 101.5M params
  [Eval 40] Loss: 1.2848
  [Eval 37] GPU 4 | dim=1280, expansion=1, depth=12, spectral_radius=0.993, mamba2_init=0, lr=4.636e-05 | dim=1280 | 59.3M params
  [Eval 37] Loss: 1.4516
  [Eval 36] GPU 3 | dim=1280, expansion=1, depth=16, spectral_radius=0.9972, mamba2_init=0, lr=0.0002015 | dim=1280 | 79.0M params
  [Eval 36] Loss: 1.1913
  [Eval 35] GPU 2 | dim=1408, expansion=1, depth=21, spectral_radius=0.9916, mamba2_init=0, lr=0.0002772 | dim=1408 | 125.3M params
  [Eval 35] Loss: 1.4106
  [Eval 34] GPU 1 | dim=1664, expansion=1, depth=15, spectral_radius=0.9943, mamba2_init=0, lr=1.914e-05 | dim=1664 | 125.1M params
  [Eval 34] Loss: 1.5672
  [Eval 38] GPU 5 | dim=1920, expansion=1, depth=13, spectral_radius=0.9855, mamba2_init=0, lr=4.939e-05 | dim=1920 | 144.3M params
  [Eval 38] Loss: 1.3709
  [Eval 39] GPU 6 | dim=2816, expansion=1, depth=23, spectral_radius=0.9898, mamba2_init=0, lr=0.0003777 | dim=2816 | 548.0M params
  [Eval 39] Loss: 1.6301
  *** NEW BEST: 1.1913 | {'dim': 1280, 'expansion': 1, 'depth': 16, 'spectral_radius': 0.9972498962469003, 'mamba2_init': 0, 'lr': 0.00020154051750796476} | dim=1280 ***
    5     40 1.191347000000000e+00 1.8e+00 2.04e-01  2e-01  3e-01 151:36.2
  Generation best: 1.1913 | Overall best: 1.1913 | Improvement: 0.0365

--- Generation 6 (converge threshold: 0.01) ---
  [Eval 41] GPU 0 | dim=1280, expansion=1, depth=17, spectral_radius=0.999, mamba2_init=0, lr=0.0001725 | dim=1280 | 83.9M params
  [Eval 41] NaN/diverged (loss=inf)
  [Eval 46] GPU 5 | dim=1280, expansion=1, depth=12, spectral_radius=0.9878, mamba2_init=0, lr=0.0005484 | dim=1280 | 59.3M params
  [Eval 46] Loss: 1.4180
  [Eval 48] GPU 7 | dim=1024, expansion=1, depth=20, spectral_radius=0.996, mamba2_init=0, lr=0.0002967 | dim=1024 | 63.2M params
  [Eval 48] Loss: 1.3764
  [Eval 42] GPU 1 | dim=1792, expansion=1, depth=12, spectral_radius=0.9847, mamba2_init=0, lr=0.0003139 | dim=1792 | 116.1M params
  [Eval 42] Loss: 1.2332
  [Eval 45] GPU 4 | dim=1408, expansion=1, depth=12, spectral_radius=0.9935, mamba2_init=0, lr=0.0009782 | dim=1408 | 71.8M params
  [Eval 45] Loss: 1.4672
  [Eval 47] GPU 6 | dim=1408, expansion=2, depth=18, spectral_radius=0.9993, mamba2_init=0, lr=0.0002527 | dim=1408 | 285.9M params
  [Eval 47] Loss: 1.5221
  [Eval 43] GPU 2 | dim=1280, expansion=1, depth=39, spectral_radius=0.9959, mamba2_init=0, lr=0.0001207 | dim=1280 | 192.1M params
  [Eval 43] Loss: 1.4409
  [Eval 44] GPU 3 | dim=1024, expansion=1, depth=22, spectral_radius=0.9866, mamba2_init=0, lr=7.459e-05 | dim=1024 | 69.5M params
  [Eval 44] Loss: 1.3938
    6     48 1.233168000000000e+00 1.8e+00 2.02e-01  2e-01  3e-01 181:49.9
  Generation best: 1.2332 | Overall best: 1.1913 | Improvement: 0.0000
  Improvement 0.0000 < threshold 0.01 (1 consecutive)

--- Generation 7 (converge threshold: 0.01) ---
  [Eval 55] GPU 6 | dim=1152, expansion=1, depth=12, spectral_radius=0.9873, mamba2_init=0, lr=0.0001701 | dim=1152 | 48.1M params
  [Eval 55] Loss: 1.3494
  [Eval 51] GPU 2 | dim=1280, expansion=1, depth=16, spectral_radius=0.9962, mamba2_init=0, lr=0.0004556 | dim=1280 | 79.0M params
  [Eval 51] Loss: 1.3441
  [Eval 56] GPU 7 | dim=1024, expansion=1, depth=12, spectral_radius=0.9883, mamba2_init=0, lr=8.761e-05 | dim=1024 | 38.0M params
  [Eval 56] Loss: 1.4345
  [Eval 49] GPU 0 | dim=2048, expansion=1, depth=15, spectral_radius=0.9934, mamba2_init=0, lr=0.0003745 | dim=2048 | 189.3M params
  [Eval 49] Loss: 1.4857
  [Eval 53] GPU 4 | dim=1152, expansion=1, depth=24, spectral_radius=0.9926, mamba2_init=0, lr=8.896e-05 | dim=1152 | 95.9M params
  [Eval 53] Loss: 1.4203
  [Eval 52] GPU 3 | dim=1280, expansion=1, depth=15, spectral_radius=0.9958, mamba2_init=0, lr=0.0001329 | dim=1280 | 74.1M params
  [Eval 52] Loss: 1.2345
  [Eval 54] GPU 5 | dim=2048, expansion=1, depth=12, spectral_radius=0.9988, mamba2_init=0, lr=0.0002241 | dim=2048 | 151.6M params
  [Eval 54] Loss: 1.3497
  [Eval 50] GPU 1 | dim=1664, expansion=1, depth=26, spectral_radius=0.9919, mamba2_init=0, lr=0.0002254 | dim=1664 | 216.5M params
  [Eval 50] Loss: 1.4612
    7     56 1.234542000000000e+00 2.0e+00 1.91e-01  2e-01  3e-01 212:02.7
  Generation best: 1.2345 | Overall best: 1.1913 | Improvement: 0.0000
  Improvement 0.0000 < threshold 0.01 (2 consecutive)

*** CONVERGED: improvement 0.0000 < 0.01 ***

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.1913
Best params: {'dim': 1280, 'expansion': 1, 'depth': 16, 'spectral_radius': 0.9972498962469003, 'mamba2_init': 0, 'lr': 0.00020154051750796476}
Total evaluations: 56

Cleaning up 304 checkpoint files...
Cleanup complete.

To train with best config:
python train.py --level 42 --dim 1280 --depth 16 --expansion 1 --lr 0.00020154051750796476 --train_minutes 30

======================================================================
Finished: 2026-02-02T22:29:29.590567
Duration: 3.55 hours
Return code: 0
