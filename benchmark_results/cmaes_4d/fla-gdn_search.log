CMA-ES 4D Search for fla-gdn
Started: 2026-02-03T06:10:47.378717
Command: python cmaes_search.py --model fla-gdn --train_minutes 30 --converge 0.01 --gpus 0,1,2,3,4,5,6,7 --params 480M --output benchmark_results/cmaes_4d --start_from_best
======================================================================

/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'dim': 1920, 'expansion': 2, 'depth': 17, 'n_heads': 24, 'use_conv': 1, 'lr': 0.0003}
Encoded x0: ['0.438', '0.500', '0.179', '0.667', '0.750', '0.739']
======================================================================
CMA-ES Search for FLA-GDN
======================================================================
Search space (6 dimensions):
  dim: [1024, 3072] (int_mult128) - Model dimension
  expansion: [1, 3] (int) - Value expansion factor
  depth: [12, 40] (int) - Number of layers
  n_heads: [8, 32] (int) - Number of heads
  use_conv: [0, 1] (binary) - Use short convolution (0=no, 1=yes)
  lr: [1e-05, 0.001] (log) - Learning rate (log scale)
Target params: 480M Â± 50M
Training time per config: 30.0 min
Convergence mode: stop when improvement < 0.01
Max generations: 1000
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 6 (seed=211128, Tue Feb  3 06:10:47 2026)

--- Generation 1 (converge threshold: 0.01) ---
  [Eval 3] GPU 2 | dim=1536, expansion=2, depth=17, n_heads=24, use_conv=1, lr=0.0005338 | dim=1536 | 321.4M params
  [Eval 3] Loss: 1.2738
  [Eval 4] GPU 3 | dim=1920, expansion=2, depth=13, n_heads=26, use_conv=1, lr=0.0003896 | dim=1920 | 384.0M params
  [Eval 4] Loss: 1.2212
  [Eval 1] GPU 0 | dim=1792, expansion=2, depth=18, n_heads=24, use_conv=1, lr=0.0004915 | dim=1792 | 463.0M params
  [Eval 1] Loss: 1.1751
  [Eval 7] GPU 6 | dim=1536, expansion=2, depth=23, n_heads=24, use_conv=1, lr=0.0001273 | dim=1536 | 434.6M params
  [Eval 7] Loss: 1.4145
  [Eval 8] GPU 7 | dim=1280, expansion=2, depth=18, n_heads=22, use_conv=1, lr=0.0003779 | dim=1280 | 236.3M params
  [Eval 8] Loss: 1.2587
  [Eval 5] GPU 4 | dim=2304, expansion=2, depth=17, n_heads=21, use_conv=1, lr=0.0003424 | dim=2304 | 722.7M params
  [Eval 5] Loss: 1.1817
  [Eval 6] GPU 5 | dim=1792, expansion=2, depth=21, n_heads=21, use_conv=1, lr=0.0002061 | dim=1792 | 540.1M params
  [Eval 6] Loss: 1.2070
  [Eval 2] GPU 1 | dim=1664, expansion=2, depth=21, n_heads=27, use_conv=1, lr=7.795e-05 | dim=1664 | 465.7M params
  [Eval 2] Loss: 1.6330
  *** NEW BEST: 1.1751 | {'dim': 1792, 'expansion': 2, 'depth': 18, 'n_heads': 24, 'use_conv': 1, 'lr': 0.0004914572091063998} | dim=1792 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.175104000000000e+00 1.0e+00 1.31e-01  1e-01  1e-01 30:21.0
  Generation best: 1.1751 | Overall best: 1.1751 | Improvement: inf

--- Generation 2 (converge threshold: 0.01) ---
  [Eval 9] GPU 0 | dim=1920, expansion=1, depth=12, n_heads=21, use_conv=1, lr=0.0003164 | dim=1920 | 177.5M params
  [Eval 9] Loss: 1.2942
  [Eval 14] GPU 5 | dim=1664, expansion=2, depth=18, n_heads=20, use_conv=1, lr=0.0003693 | dim=1664 | 399.3M params
  [Eval 14] Loss: 1.2397
  [Eval 10] GPU 1 | dim=1920, expansion=2, depth=17, n_heads=30, use_conv=1, lr=0.0008864 | dim=1920 | 502.0M params
  [Eval 10] Loss: 1.1417
  [Eval 12] GPU 3 | dim=2176, expansion=2, depth=15, n_heads=19, use_conv=1, lr=0.00046 | dim=2176 | 568.9M params
  [Eval 12] Loss: 1.1147
  [Eval 15] GPU 6 | dim=2304, expansion=2, depth=17, n_heads=22, use_conv=1, lr=0.0003107 | dim=2304 | 722.7M params
  [Eval 15] Loss: 1.1891
  [Eval 11] GPU 2 | dim=1792, expansion=2, depth=21, n_heads=21, use_conv=1, lr=0.000384 | dim=1792 | 540.1M params
  [Eval 11] Loss: 1.1871
  [Eval 13] GPU 4 | dim=2048, expansion=2, depth=17, n_heads=29, use_conv=1, lr=0.0003886 | dim=2048 | 571.1M params
  [Eval 13] Loss: 1.1962
  [Eval 16] GPU 7 | dim=2176, expansion=2, depth=19, n_heads=21, use_conv=1, lr=0.0007776 | dim=2176 | 720.4M params
  [Eval 16] Loss: 1.1769
  *** NEW BEST: 1.1417 | {'dim': 1920, 'expansion': 2, 'depth': 17, 'n_heads': 30, 'use_conv': 1, 'lr': 0.0008864408659309419} | dim=1920 ***
  *** NEW BEST: 1.1147 | {'dim': 2176, 'expansion': 2, 'depth': 15, 'n_heads': 19, 'use_conv': 1, 'lr': 0.00046003089327710165} | dim=2176 ***
    2     16 1.114716000000000e+00 1.2e+00 1.23e-01  1e-01  1e-01 60:39.2
  Generation best: 1.1147 | Overall best: 1.1147 | Improvement: 0.0604

--- Generation 3 (converge threshold: 0.01) ---
  [Eval 17] GPU 0 | dim=2176, expansion=2, depth=12, n_heads=20, use_conv=1, lr=0.0009076 | dim=2176 | 455.2M params
  [Eval 17] Loss: 1.2096
  [Eval 18] GPU 1 | dim=2048, expansion=2, depth=16, n_heads=27, use_conv=1, lr=0.0003206 | dim=2048 | 537.5M params
  [Eval 18] Loss: 1.1324
  [Eval 23] GPU 6 | dim=2048, expansion=2, depth=15, n_heads=18, use_conv=1, lr=0.000828 | dim=2048 | 504.0M params
  [Eval 23] Loss: 1.1201
  [Eval 22] GPU 5 | dim=2176, expansion=2, depth=15, n_heads=21, use_conv=1, lr=0.0006648 | dim=2176 | 568.9M params
  [Eval 22] Loss: 1.1349
  [Eval 20] GPU 3 | dim=1920, expansion=2, depth=19, n_heads=27, use_conv=1, lr=0.000574 | dim=1920 | 561.0M params
  [Eval 20] Loss: 1.1092
  [Eval 21] GPU 4 | dim=2432, expansion=2, depth=15, n_heads=25, use_conv=1, lr=0.0007449 | dim=2432 | 710.5M params
  [Eval 21] Loss: 1.1922
  [Eval 19] GPU 2 | dim=2304, expansion=2, depth=20, n_heads=19, use_conv=1, lr=0.0004052 | dim=2304 | 850.1M params
  [Eval 19] Loss: 1.2168
  [Eval 24] GPU 7 | dim=2304, expansion=2, depth=19, n_heads=25, use_conv=1, lr=0.0008049 | dim=2304 | 807.6M params
  [Eval 24] Loss: 1.1732
  *** NEW BEST: 1.1092 | {'dim': 1920, 'expansion': 2, 'depth': 19, 'n_heads': 27, 'use_conv': 1, 'lr': 0.0005739844144352731} | dim=1920 ***
    3     24 1.109216000000000e+00 1.3e+00 1.09e-01  1e-01  1e-01 91:00.2
  Generation best: 1.1092 | Overall best: 1.1092 | Improvement: 0.0055
  Improvement 0.0055 < threshold 0.01 (1 consecutive)

--- Generation 4 (converge threshold: 0.01) ---
  [Eval 29] GPU 4 | dim=2048, expansion=2, depth=15, n_heads=32, use_conv=1, lr=0.0004352 | dim=2048 | 504.0M params
  [Eval 29] Loss: 1.1154
  [Eval 32] GPU 7 | dim=1792, expansion=2, depth=17, n_heads=22, use_conv=1, lr=0.000671 | dim=1792 | 437.3M params
  [Eval 32] Loss: 1.1844
  [Eval 26] GPU 1 | dim=1920, expansion=2, depth=15, n_heads=24, use_conv=1, lr=0.0004166 | dim=1920 | 443.0M params
  [Eval 26] Loss: 1.2182
  [Eval 30] GPU 5 | dim=1920, expansion=2, depth=16, n_heads=26, use_conv=1, lr=0.0006374 | dim=1920 | 472.5M params
  [Eval 30] Loss: 1.1842
  [Eval 31] GPU 6 | dim=2048, expansion=2, depth=16, n_heads=28, use_conv=1, lr=0.0009025 | dim=2048 | 537.5M params
  [Eval 31] Loss: 1.1436
  [Eval 28] GPU 3 | dim=2048, expansion=2, depth=16, n_heads=23, use_conv=1, lr=0.0009751 | dim=2048 | 537.5M params
  [Eval 28] Loss: 1.1266
  [Eval 25] GPU 0 | dim=2048, expansion=2, depth=18, n_heads=24, use_conv=1, lr=0.00045 | dim=2048 | 604.7M params
  [Eval 25] Loss: 1.1836
  [Eval 27] GPU 2 | dim=2176, expansion=2, depth=18, n_heads=25, use_conv=1, lr=0.0005475 | dim=2176 | 682.6M params
  [Eval 27] Loss: 1.1741
    4     32 1.115424000000000e+00 1.4e+00 1.17e-01  1e-01  1e-01 121:19.5
  Generation best: 1.1154 | Overall best: 1.1092 | Improvement: 0.0000
  Improvement 0.0000 < threshold 0.01 (2 consecutive)

*** CONVERGED: improvement 0.0000 < 0.01 ***

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.1092
Best params: {'dim': 1920, 'expansion': 2, 'depth': 19, 'n_heads': 27, 'use_conv': 1, 'lr': 0.0005739844144352731}
Total evaluations: 32

Cleaning up 191 checkpoint files...
Cleanup complete.

To train with best config:
python train.py --level fla-gdn --dim 1920 --depth 19 --expansion 2 --n_heads 27 --lr 0.0005739844144352731 --train_minutes 30

======================================================================
Finished: 2026-02-03T08:13:43.235806
Duration: 2.05 hours
Return code: 0
