Using device: cuda
Output directory: benchmark_results/cmaes_4d/e1_480M_converge0.01_20260202_122123/eval_1/level1_100m_20260202_122129
Auto r_h_mode: spectral_norm (level 1 has full W_h)
Model: Level 1, 1,338,437,376 parameters
Using schedule-free AdamW (lr=0.0003001360925394885)

Starting training from step 0...
Batch size: 8, Chunk size: 512
Gradient accumulation: 1, Effective batch: 8

Time-based training: 30.0 minutes
step     10 | loss 6.6670 | lr 3.00e-04 | grad 9.69 | tok/s 3549
step     20 | loss 3.0670 | lr 3.00e-04 | grad 4.00 | tok/s 5369
step     30 | loss 2.7765 | lr 3.00e-04 | grad 5.34 | tok/s 5409
step     40 | loss 2.6242 | lr 3.00e-04 | grad 2.95 | tok/s 5149
step     50 | loss 3.5164 | lr 3.00e-04 | grad 26.88 | tok/s 5196
step     60 | loss 2.4382 | lr 3.00e-04 | grad 3.45 | tok/s 5341
step     70 | loss 2.3677 | lr 3.00e-04 | grad 4.22 | tok/s 5384
step     80 | loss 5.4503 | lr 3.00e-04 | grad 17.62 | tok/s 5399
step     90 | loss 4.5728 | lr 3.00e-04 | grad 3.78 | tok/s 5470
step    100 | loss 3.7296 | lr 3.00e-04 | grad 4.47 | tok/s 5461
step    110 | loss 3.4496 | lr 3.00e-04 | grad 12.88 | tok/s 5452
step    120 | loss 3.1698 | lr 3.00e-04 | grad 14.00 | tok/s 5438
step    130 | loss 3.0395 | lr 3.00e-04 | grad 7.91 | tok/s 5428
step    140 | loss 2.6821 | lr 3.00e-04 | grad 3.33 | tok/s 5424
step    150 | loss 2.8060 | lr 3.00e-04 | grad 8.00 | tok/s 5416
step    160 | loss 2.4489 | lr 3.00e-04 | grad 6.06 | tok/s 5411
step    170 | loss 2.5685 | lr 3.00e-04 | grad 7.59 | tok/s 5407
step    180 | loss 2.3727 | lr 3.00e-04 | grad 9.75 | tok/s 5409
step    190 | loss 2.5218 | lr 3.00e-04 | grad 8.38 | tok/s 5404
step    200 | loss 2.3158 | lr 3.00e-04 | grad 4.12 | tok/s 5399
step    210 | loss 2.3604 | lr 3.00e-04 | grad 7.19 | tok/s 5397
step    220 | loss 2.6147 | lr 3.00e-04 | grad 3.42 | tok/s 5335
step    230 | loss 2.9430 | lr 3.00e-04 | grad 3.44 | tok/s 5266
step    240 | loss 2.5088 | lr 3.00e-04 | grad 3.64 | tok/s 5004
step    250 | loss 2.3436 | lr 3.00e-04 | grad 3.27 | tok/s 5144
step    260 | loss 2.0714 | lr 3.00e-04 | grad 3.64 | tok/s 5299
step    270 | loss 2.3604 | lr 3.00e-04 | grad 3.06 | tok/s 5237
step    280 | loss 2.5191 | lr 3.00e-04 | grad 2.70 | tok/s 5142
step    290 | loss 2.0438 | lr 3.00e-04 | grad 2.94 | tok/s 5409
step    300 | loss 1.0414 | lr 3.00e-04 | grad 2.28 | tok/s 5410
step    310 | loss 2.7500 | lr 3.00e-04 | grad 3.52 | tok/s 5320
step    320 | loss 2.3990 | lr 3.00e-04 | grad 4.31 | tok/s 5210
step    330 | loss 2.1929 | lr 3.00e-04 | grad 2.17 | tok/s 5033
step    340 | loss 2.4573 | lr 3.00e-04 | grad 2.44 | tok/s 5114
step    350 | loss 2.1931 | lr 3.00e-04 | grad 3.09 | tok/s 5244
step    360 | loss 1.9100 | lr 3.00e-04 | grad 3.84 | tok/s 5360
step    370 | loss 2.1219 | lr 3.00e-04 | grad 3.08 | tok/s 4860
step    380 | loss 2.0297 | lr 3.00e-04 | grad 2.06 | tok/s 5173
step    390 | loss 1.8278 | lr 3.00e-04 | grad 1.58 | tok/s 5406
step    400 | loss 1.8322 | lr 3.00e-04 | grad 3.03 | tok/s 5359
step    410 | loss 1.7098 | lr 3.00e-04 | grad 2.22 | tok/s 5234
step    420 | loss 2.0502 | lr 3.00e-04 | grad 3.52 | tok/s 5003
step    430 | loss 2.3059 | lr 3.00e-04 | grad 2.86 | tok/s 5323
step    440 | loss 2.3433 | lr 3.00e-04 | grad 2.52 | tok/s 5032
step    450 | loss 2.3687 | lr 3.00e-04 | grad 1.84 | tok/s 5206
step    460 | loss 1.9594 | lr 3.00e-04 | grad 3.75 | tok/s 5096
step    470 | loss 2.0584 | lr 3.00e-04 | grad 2.97 | tok/s 5254
step    480 | loss 2.4050 | lr 3.00e-04 | grad 3.42 | tok/s 5254
step    490 | loss 2.0155 | lr 3.00e-04 | grad 2.19 | tok/s 4968
step    500 | loss 1.9416 | lr 3.00e-04 | grad 2.45 | tok/s 5305
step    510 | loss 1.9233 | lr 3.00e-04 | grad 1.70 | tok/s 5377
step    520 | loss 1.9233 | lr 3.00e-04 | grad 1.73 | tok/s 5366
step    530 | loss 2.0809 | lr 3.00e-04 | grad 1.66 | tok/s 5159
step    540 | loss 1.9247 | lr 3.00e-04 | grad 2.20 | tok/s 5157
step    550 | loss 1.7546 | lr 3.00e-04 | grad 2.14 | tok/s 5056
step    560 | loss 1.9184 | lr 3.00e-04 | grad 1.85 | tok/s 4923
step    570 | loss 1.8709 | lr 3.00e-04 | grad 1.96 | tok/s 5057
step    580 | loss 1.7610 | lr 3.00e-04 | grad 1.94 | tok/s 5036
step    590 | loss 2.0444 | lr 3.00e-04 | grad 2.23 | tok/s 5170
step    600 | loss 1.9853 | lr 3.00e-04 | grad 1.41 | tok/s 4994
step    610 | loss 1.8106 | lr 3.00e-04 | grad 1.84 | tok/s 5250
step    620 | loss 1.7027 | lr 3.00e-04 | grad 1.38 | tok/s 4975
step    630 | loss 1.8176 | lr 3.00e-04 | grad 2.47 | tok/s 5011
step    640 | loss 2.0003 | lr 3.00e-04 | grad 1.27 | tok/s 5147
step    650 | loss 1.8483 | lr 3.00e-04 | grad 2.34 | tok/s 5168
step    660 | loss 1.8662 | lr 3.00e-04 | grad 1.40 | tok/s 5196
step    670 | loss 2.0743 | lr 3.00e-04 | grad 1.83 | tok/s 5232
step    680 | loss 1.8545 | lr 3.00e-04 | grad 1.62 | tok/s 5127
step    690 | loss 1.9978 | lr 3.00e-04 | grad 2.12 | tok/s 5310
step    700 | loss 1.6273 | lr 3.00e-04 | grad 1.86 | tok/s 5403
step    710 | loss 1.7368 | lr 3.00e-04 | grad 2.06 | tok/s 5049
step    720 | loss 1.5977 | lr 3.00e-04 | grad 2.11 | tok/s 4976
step    730 | loss 1.5000 | lr 3.00e-04 | grad 2.31 | tok/s 5399
step    740 | loss 1.6656 | lr 3.00e-04 | grad 1.62 | tok/s 5332
step    750 | loss 1.4115 | lr 3.00e-04 | grad 1.29 | tok/s 5410
step    760 | loss 1.3044 | lr 3.00e-04 | grad 1.72 | tok/s 5409
step    770 | loss 1.2551 | lr 3.00e-04 | grad 1.89 | tok/s 5410
step    780 | loss 1.2178 | lr 3.00e-04 | grad 1.30 | tok/s 5409
step    790 | loss 1.3020 | lr 3.00e-04 | grad 2.06 | tok/s 5241
step    800 | loss 1.9944 | lr 3.00e-04 | grad 2.77 | tok/s 5228
step    810 | loss 1.7847 | lr 3.00e-04 | grad 1.38 | tok/s 5202
step    820 | loss 1.8242 | lr 3.00e-04 | grad 2.50 | tok/s 4992
step    830 | loss 1.7194 | lr 3.00e-04 | grad 1.68 | tok/s 5357
step    840 | loss 1.5728 | lr 3.00e-04 | grad 1.21 | tok/s 5418
step    850 | loss 1.6864 | lr 3.00e-04 | grad 2.12 | tok/s 5387
step    860 | loss 1.6143 | lr 3.00e-04 | grad 2.73 | tok/s 5327
step    870 | loss 1.6344 | lr 3.00e-04 | grad 1.87 | tok/s 5133
step    880 | loss 1.8026 | lr 3.00e-04 | grad 1.55 | tok/s 5154
step    890 | loss 1.7852 | lr 3.00e-04 | grad 2.03 | tok/s 5232
step    900 | loss 1.6608 | lr 3.00e-04 | grad 1.31 | tok/s 5243
step    910 | loss 1.5239 | lr 3.00e-04 | grad 1.99 | tok/s 5129
step    920 | loss 1.6587 | lr 3.00e-04 | grad 2.41 | tok/s 5331
step    930 | loss 1.7200 | lr 3.00e-04 | grad 2.08 | tok/s 5086
step    940 | loss 1.5380 | lr 3.00e-04 | grad 1.37 | tok/s 5365
step    950 | loss 1.5971 | lr 3.00e-04 | grad 1.36 | tok/s 5387
step    960 | loss 1.4593 | lr 3.00e-04 | grad 2.11 | tok/s 5394
step    970 | loss 1.8221 | lr 3.00e-04 | grad 1.87 | tok/s 5076
step    980 | loss 1.7162 | lr 3.00e-04 | grad 1.27 | tok/s 5209
step    990 | loss 1.5830 | lr 3.00e-04 | grad 1.26 | tok/s 5300
step   1000 | loss 1.9561 | lr 3.00e-04 | grad 5.72 | tok/s 5082
  >>> saved checkpoint: checkpoint_step_001000_loss_1.9561.pt
step   1010 | loss 1.7713 | lr 3.00e-04 | grad 1.38 | tok/s 1910
step   1020 | loss 1.5774 | lr 3.00e-04 | grad 1.76 | tok/s 5226
step   1030 | loss 1.5776 | lr 3.00e-04 | grad 1.86 | tok/s 5387
step   1040 | loss 1.6927 | lr 3.00e-04 | grad 2.30 | tok/s 4967
step   1050 | loss 1.8283 | lr 3.00e-04 | grad 2.52 | tok/s 5371
step   1060 | loss 1.7817 | lr 3.00e-04 | grad 1.62 | tok/s 5335
step   1070 | loss 1.4989 | lr 3.00e-04 | grad 1.20 | tok/s 4832
step   1080 | loss 1.2044 | lr 3.00e-04 | grad 0.53 | tok/s 5334
step   1090 | loss 1.5182 | lr 3.00e-04 | grad 2.75 | tok/s 5168
step   1100 | loss 1.5348 | lr 3.00e-04 | grad 1.54 | tok/s 5426
step   1110 | loss 1.4238 | lr 3.00e-04 | grad 2.16 | tok/s 5423
step   1120 | loss 1.3731 | lr 3.00e-04 | grad 1.15 | tok/s 5416
step   1130 | loss 1.3629 | lr 3.00e-04 | grad 1.59 | tok/s 5423
step   1140 | loss 1.3754 | lr 3.00e-04 | grad 1.30 | tok/s 5414
step   1150 | loss 1.2892 | lr 3.00e-04 | grad 1.81 | tok/s 5409
step   1160 | loss 1.3208 | lr 3.00e-04 | grad 1.83 | tok/s 5408
step   1170 | loss 1.4237 | lr 3.00e-04 | grad 1.16 | tok/s 5402
step   1180 | loss 1.3090 | lr 3.00e-04 | grad 1.65 | tok/s 5404
step   1190 | loss 1.2944 | lr 3.00e-04 | grad 1.73 | tok/s 5402
step   1200 | loss 1.3500 | lr 3.00e-04 | grad 1.69 | tok/s 5401
step   1210 | loss 1.3607 | lr 3.00e-04 | grad 1.95 | tok/s 5399
step   1220 | loss 1.3346 | lr 3.00e-04 | grad 1.56 | tok/s 5402
step   1230 | loss 1.2951 | lr 3.00e-04 | grad 1.48 | tok/s 5408
step   1240 | loss 2.0168 | lr 3.00e-04 | grad 1.97 | tok/s 5119
step   1250 | loss 1.4797 | lr 3.00e-04 | grad 2.62 | tok/s 5074
step   1260 | loss 1.7379 | lr 3.00e-04 | grad 3.45 | tok/s 5052
step   1270 | loss 1.6765 | lr 3.00e-04 | grad 1.52 | tok/s 5202
step   1280 | loss 1.5339 | lr 3.00e-04 | grad 1.48 | tok/s 5174
step   1290 | loss 1.5905 | lr 3.00e-04 | grad 1.47 | tok/s 5207
step   1300 | loss 1.5409 | lr 3.00e-04 | grad 1.61 | tok/s 5301
step   1310 | loss 1.6403 | lr 3.00e-04 | grad 1.30 | tok/s 5320
step   1320 | loss 1.6891 | lr 3.00e-04 | grad 1.43 | tok/s 5318
step   1330 | loss 1.5572 | lr 3.00e-04 | grad 6.16 | tok/s 5075
step   1340 | loss 1.7774 | lr 3.00e-04 | grad 1.66 | tok/s 4903
step   1350 | loss 1.6098 | lr 3.00e-04 | grad 1.78 | tok/s 5213
step   1360 | loss 1.4469 | lr 3.00e-04 | grad 0.85 | tok/s 5144
step   1370 | loss 1.7986 | lr 3.00e-04 | grad 1.19 | tok/s 4943
step   1380 | loss 1.5911 | lr 3.00e-04 | grad 1.33 | tok/s 5248
step   1390 | loss 1.4722 | lr 3.00e-04 | grad 1.17 | tok/s 5067
step   1400 | loss 1.5075 | lr 3.00e-04 | grad 1.93 | tok/s 5082
step   1410 | loss 1.7726 | lr 3.00e-04 | grad 2.98 | tok/s 5090
step   1420 | loss 1.4500 | lr 3.00e-04 | grad 1.16 | tok/s 5175
step   1430 | loss 1.2094 | lr 3.00e-04 | grad 1.46 | tok/s 5348
step   1440 | loss 1.2233 | lr 3.00e-04 | grad 3.00 | tok/s 5379
step   1450 | loss 1.7558 | lr 3.00e-04 | grad 1.43 | tok/s 5082
step   1460 | loss 1.5912 | lr 3.00e-04 | grad 1.16 | tok/s 5269
step   1470 | loss 1.9173 | lr 3.00e-04 | grad 2.73 | tok/s 5302
step   1480 | loss 1.6632 | lr 3.00e-04 | grad 1.23 | tok/s 5379
step   1490 | loss 1.4351 | lr 3.00e-04 | grad 1.23 | tok/s 5399
step   1500 | loss 1.6115 | lr 3.00e-04 | grad 1.47 | tok/s 5325
step   1510 | loss 1.4760 | lr 3.00e-04 | grad 2.52 | tok/s 5218
step   1520 | loss 1.4636 | lr 3.00e-04 | grad 1.35 | tok/s 5345
step   1530 | loss 1.6732 | lr 3.00e-04 | grad 1.51 | tok/s 5028
step   1540 | loss 1.3863 | lr 3.00e-04 | grad 1.45 | tok/s 5363
step   1550 | loss 1.6290 | lr 3.00e-04 | grad 2.19 | tok/s 5079
step   1560 | loss 1.3816 | lr 3.00e-04 | grad 1.49 | tok/s 5403
step   1570 | loss 1.7847 | lr 3.00e-04 | grad 3.05 | tok/s 5278
step   1580 | loss 1.6858 | lr 3.00e-04 | grad 1.30 | tok/s 5074
step   1590 | loss 1.0826 | lr 3.00e-04 | grad 0.91 | tok/s 5412
step   1600 | loss 1.0754 | lr 3.00e-04 | grad 1.48 | tok/s 5244
step   1610 | loss 1.4920 | lr 3.00e-04 | grad 1.84 | tok/s 4911
step   1620 | loss 1.5116 | lr 3.00e-04 | grad 1.76 | tok/s 5252
step   1630 | loss 1.4017 | lr 3.00e-04 | grad 1.58 | tok/s 5134
step   1640 | loss 1.5691 | lr 3.00e-04 | grad 1.40 | tok/s 4923
step   1650 | loss 1.4709 | lr 3.00e-04 | grad 0.97 | tok/s 5251
step   1660 | loss 1.4803 | lr 3.00e-04 | grad 4.41 | tok/s 5238
step   1670 | loss 1.7864 | lr 3.00e-04 | grad 1.43 | tok/s 5026
step   1680 | loss 1.5498 | lr 3.00e-04 | grad 2.95 | tok/s 5127
step   1690 | loss 1.5219 | lr 3.00e-04 | grad 1.32 | tok/s 5236
step   1700 | loss 1.5243 | lr 3.00e-04 | grad 1.09 | tok/s 5136
step   1710 | loss 1.5906 | lr 3.00e-04 | grad 1.77 | tok/s 5360
step   1720 | loss 1.3333 | lr 3.00e-04 | grad 1.77 | tok/s 5411
step   1730 | loss 1.4304 | lr 3.00e-04 | grad 1.24 | tok/s 5274
step   1740 | loss 1.6350 | lr 3.00e-04 | grad 1.91 | tok/s 5185
step   1750 | loss 1.5709 | lr 3.00e-04 | grad 1.21 | tok/s 5203
step   1760 | loss 1.4697 | lr 3.00e-04 | grad 1.66 | tok/s 5111
step   1770 | loss 1.5502 | lr 3.00e-04 | grad 1.41 | tok/s 5315
step   1780 | loss 1.4470 | lr 3.00e-04 | grad 1.12 | tok/s 5180
step   1790 | loss 1.6569 | lr 3.00e-04 | grad 1.25 | tok/s 5223
step   1800 | loss 1.4789 | lr 3.00e-04 | grad 1.42 | tok/s 5032
step   1810 | loss 1.5614 | lr 3.00e-04 | grad 3.22 | tok/s 5102
step   1820 | loss 1.4972 | lr 3.00e-04 | grad 1.46 | tok/s 5314
step   1830 | loss 1.6005 | lr 3.00e-04 | grad 1.78 | tok/s 5087
step   1840 | loss 1.3695 | lr 3.00e-04 | grad 1.40 | tok/s 5328
step   1850 | loss 1.3773 | lr 3.00e-04 | grad 1.90 | tok/s 5154
step   1860 | loss 1.4789 | lr 3.00e-04 | grad 2.33 | tok/s 5179
step   1870 | loss 1.3160 | lr 3.00e-04 | grad 1.27 | tok/s 5063
step   1880 | loss 1.5320 | lr 3.00e-04 | grad 1.20 | tok/s 4818
step   1890 | loss 1.4235 | lr 3.00e-04 | grad 1.59 | tok/s 5208
step   1900 | loss 1.4888 | lr 3.00e-04 | grad 1.64 | tok/s 4930
step   1910 | loss 1.4357 | lr 3.00e-04 | grad 1.52 | tok/s 5413
step   1920 | loss 1.4820 | lr 3.00e-04 | grad 1.62 | tok/s 5076
step   1930 | loss 1.4735 | lr 3.00e-04 | grad 1.47 | tok/s 5275
step   1940 | loss 1.9182 | lr 3.00e-04 | grad 2.78 | tok/s 5361
step   1950 | loss 1.5884 | lr 3.00e-04 | grad 2.67 | tok/s 5411
step   1960 | loss 1.6064 | lr 3.00e-04 | grad 1.46 | tok/s 5281
step   1970 | loss 1.5914 | lr 3.00e-04 | grad 1.04 | tok/s 5048
step   1980 | loss 1.6619 | lr 3.00e-04 | grad 7.59 | tok/s 5150
step   1990 | loss 1.5174 | lr 3.00e-04 | grad 1.26 | tok/s 5213
step   2000 | loss 1.1901 | lr 3.00e-04 | grad 0.81 | tok/s 5397
  >>> saved checkpoint: checkpoint_step_002000_loss_1.1901.pt
step   2010 | loss 1.0936 | lr 3.00e-04 | grad 0.43 | tok/s 2073
step   2020 | loss 1.3052 | lr 3.00e-04 | grad 1.25 | tok/s 5500
step   2030 | loss 1.2699 | lr 3.00e-04 | grad 1.34 | tok/s 5357
step   2040 | loss 1.6021 | lr 3.00e-04 | grad 1.35 | tok/s 5057
step   2050 | loss 1.6885 | lr 3.00e-04 | grad 1.86 | tok/s 5237
step   2060 | loss 2.2506 | lr 3.00e-04 | grad 3.55 | tok/s 5400
step   2070 | loss 1.7790 | lr 3.00e-04 | grad 2.14 | tok/s 5409
step   2080 | loss 1.4545 | lr 3.00e-04 | grad 1.55 | tok/s 5273
step   2090 | loss 1.6132 | lr 3.00e-04 | grad 4.75 | tok/s 5164
step   2100 | loss 0.9585 | lr 3.00e-04 | grad 1.96 | tok/s 5349
step   2110 | loss 1.1203 | lr 3.00e-04 | grad 2.70 | tok/s 5339
step   2120 | loss 1.5940 | lr 3.00e-04 | grad 1.13 | tok/s 5164
step   2130 | loss 1.3301 | lr 3.00e-04 | grad 1.64 | tok/s 5420
step   2140 | loss 1.2313 | lr 3.00e-04 | grad 1.38 | tok/s 5413
step   2150 | loss 1.2769 | lr 3.00e-04 | grad 1.17 | tok/s 5419
step   2160 | loss 1.2354 | lr 3.00e-04 | grad 1.53 | tok/s 5414
step   2170 | loss 1.2474 | lr 3.00e-04 | grad 1.13 | tok/s 5418
step   2180 | loss 1.2342 | lr 3.00e-04 | grad 1.21 | tok/s 5417
step   2190 | loss 1.1869 | lr 3.00e-04 | grad 1.15 | tok/s 5411
step   2200 | loss 1.1842 | lr 3.00e-04 | grad 1.22 | tok/s 5413
step   2210 | loss 1.3920 | lr 3.00e-04 | grad 1.10 | tok/s 5324
step   2220 | loss 1.3505 | lr 3.00e-04 | grad 1.41 | tok/s 5401
step   2230 | loss 1.5815 | lr 3.00e-04 | grad 2.03 | tok/s 5216
step   2240 | loss 1.6102 | lr 3.00e-04 | grad 1.44 | tok/s 5274
step   2250 | loss 1.9666 | lr 3.00e-04 | grad 2.31 | tok/s 5362
step   2260 | loss 1.5340 | lr 3.00e-04 | grad 1.38 | tok/s 5340
step   2270 | loss 1.3631 | lr 3.00e-04 | grad 1.54 | tok/s 5213
step   2280 | loss 1.8427 | lr 3.00e-04 | grad 2.20 | tok/s 5330
step   2290 | loss 1.4995 | lr 3.00e-04 | grad 1.05 | tok/s 5065
step   2300 | loss 1.6787 | lr 3.00e-04 | grad 3.81 | tok/s 5077
step   2310 | loss 1.8513 | lr 3.00e-04 | grad 1.65 | tok/s 5169

Training complete! Final step: 2314
