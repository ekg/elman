CMA-ES 4D Search for e88
Started: 2026-02-03T08:13:43.237116
Command: python cmaes_search.py --model e88 --train_minutes 30 --converge 0.01 --gpus 0,1,2,3,4,5,6,7 --params 480M --output benchmark_results/cmaes_4d --start_from_best
======================================================================

/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'dim': 2176, 'n_heads': 98, 'n_state': 32, 'depth': 14, 'use_gate': 1, 'lr': 0.0003}
Encoded x0: ['0.562', '0.516', '0.333', '0.071', '0.750', '0.739']
======================================================================
CMA-ES Search for E88
======================================================================
Search space (6 dimensions):
  dim: [1024, 3072] (int_mult128) - Model dimension
  n_heads: [32, 160] (int) - Number of attention heads
  n_state: [16, 64] (e88_n_state) - State dimension (only 16,32,48,64 supported)
  depth: [12, 40] (int) - Number of layers
  use_gate: [0, 1] (binary) - Use output gating (0=no, 1=yes)
  lr: [1e-05, 0.001] (log) - Learning rate (log scale)
Target params: 480M Â± 50M
Training time per config: 30.0 min
Convergence mode: stop when improvement < 0.01
Max generations: 1000
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 6 (seed=204371, Tue Feb  3 08:13:43 2026)

--- Generation 1 (converge threshold: 0.01) ---
  [Eval 1] GPU 0 | dim=1792, n_heads=100, n_state=32, depth=20, use_gate=0, lr=0.000854 | dim=1792 | 577.5M params
  [Eval 1] Loss: 1.2291
  [Eval 8] GPU 7 | dim=2560, n_heads=65, n_state=32, depth=18, use_gate=0, lr=0.0004786 | dim=2560 | 482.9M params
  [Eval 8] Loss: 1.2052
  [Eval 7] GPU 6 | dim=2048, n_heads=123, n_state=32, depth=12, use_gate=1, lr=0.000374 | dim=2048 | 487.2M params
  [Eval 7] Loss: 1.2466
  [Eval 3] GPU 2 | dim=1920, n_heads=106, n_state=32, depth=18, use_gate=0, lr=0.0002954 | dim=1920 | 590.3M params
  [Eval 3] Loss: 1.2885
  [Eval 4] GPU 3 | dim=2304, n_heads=96, n_state=32, depth=15, use_gate=1, lr=0.000311 | dim=2304 | 534.8M params
  [Eval 4] Loss: 1.2708
  [Eval 2] GPU 1 | dim=2432, n_heads=82, n_state=32, depth=17, use_gate=1, lr=0.0005118 | dim=2432 | 546.5M params
  [Eval 2] Loss: 1.2359
  [Eval 5] GPU 4 | dim=1792, n_heads=116, n_state=32, depth=20, use_gate=1, lr=0.0004091 | dim=1792 | 669.8M params
  [Eval 5] Loss: 1.2645
  [Eval 6] GPU 5 | dim=2048, n_heads=134, n_state=32, depth=13, use_gate=1, lr=0.0007555 | dim=2048 | 574.9M params
  [Eval 6] Loss: 1.2486
  *** NEW BEST: 1.2291 | {'dim': 1792, 'n_heads': 100, 'n_state': 32, 'depth': 20, 'use_gate': 0, 'lr': 0.0008539682943028366} | dim=1792 ***
  *** NEW BEST: 1.2052 | {'dim': 2560, 'n_heads': 65, 'n_state': 32, 'depth': 18, 'use_gate': 0, 'lr': 0.0004786203805637956} | dim=2560 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.205224000000000e+00 1.0e+00 1.63e-01  2e-01  2e-01 30:22.1
  Generation best: 1.2052 | Overall best: 1.2052 | Improvement: inf

--- Generation 2 (converge threshold: 0.01) ---
  [Eval 14] GPU 5 | dim=2304, n_heads=52, n_state=32, depth=16, use_gate=1, lr=0.0008149 | dim=2304 | 309.3M params
  [Eval 14] Loss: 1.3002
  [Eval 9] GPU 0 | dim=2048, n_heads=61, n_state=32, depth=15, use_gate=1, lr=0.0003592 | dim=2048 | 302.3M params
  [Eval 9] Loss: 1.3750
  [Eval 11] GPU 2 | dim=2432, n_heads=43, n_state=32, depth=19, use_gate=1, lr=0.0007442 | dim=2432 | 320.6M params
  [Eval 11] Loss: 1.3147
  [Eval 15] GPU 6 | dim=1408, n_heads=70, n_state=48, depth=12, use_gate=1, lr=0.0009484 | dim=1408 | 285.4M params
  [Eval 15] Loss: 1.4220
  [Eval 16] GPU 7 | dim=2688, n_heads=105, n_state=32, depth=14, use_gate=1, lr=0.0007464 | dim=2688 | 636.9M params
  [Eval 16] Loss: 1.2747
  [Eval 10] GPU 1 | dim=2816, n_heads=91, n_state=32, depth=16, use_gate=0, lr=0.0001723 | dim=2816 | 660.9M params
  [Eval 10] Loss: 1.3695
  [Eval 12] GPU 3 | dim=2176, n_heads=82, n_state=32, depth=16, use_gate=0, lr=0.0009613 | dim=2176 | 460.2M params
  [Eval 12] Loss: 1.2777
  [Eval 13] GPU 4 | dim=1920, n_heads=62, n_state=32, depth=15, use_gate=1, lr=0.0008995 | dim=1920 | 288.0M params
  [Eval 13] Loss: 1.2984
    2     16 1.274713000000000e+00 1.4e+00 1.55e-01  1e-01  2e-01 60:44.3
  Generation best: 1.2747 | Overall best: 1.2052 | Improvement: 0.0000
  Improvement 0.0000 < threshold 0.01 (1 consecutive)

--- Generation 3 (converge threshold: 0.01) ---
  [Eval 19] GPU 2 | dim=2304, n_heads=87, n_state=16, depth=13, use_gate=1, lr=0.0009961 | dim=2304 | 211.7M params
  [Eval 19] Loss: 1.3222
  [Eval 22] GPU 5 | dim=2176, n_heads=64, n_state=32, depth=12, use_gate=0, lr=0.0003857 | dim=2176 | 269.6M params
  [Eval 22] Loss: 1.3903
  [Eval 23] GPU 6 | dim=2432, n_heads=69, n_state=48, depth=13, use_gate=1, lr=0.0009705 | dim=2432 | 526.4M params
  [Eval 23] Loss: 1.3099
  [Eval 21] GPU 4 | dim=2688, n_heads=97, n_state=32, depth=17, use_gate=1, lr=0.0007613 | dim=2688 | 714.4M params
  [Eval 21] Loss: 1.3168
  [Eval 20] GPU 3 | dim=2560, n_heads=66, n_state=32, depth=14, use_gate=1, lr=0.0007499 | dim=2560 | 381.5M params
  [Eval 20] Loss: 1.2404
  [Eval 18] GPU 1 | dim=2176, n_heads=103, n_state=32, depth=13, use_gate=1, lr=0.0003167 | dim=2176 | 469.7M params
  [Eval 18] Loss: 1.3375
  [Eval 17] GPU 0 | dim=2432, n_heads=83, n_state=48, depth=12, use_gate=1, lr=0.0009524 | dim=2432 | 584.4M params
  [Eval 17] Loss: 1.3245
  [Eval 24] GPU 7 | dim=2432, n_heads=99, n_state=48, depth=13, use_gate=0, lr=0.0009997 | dim=2432 | 755.0M params
  [Eval 24] Loss: 1.4588
    3     24 1.240400000000000e+00 1.5e+00 1.58e-01  1e-01  2e-01 91:07.4
  Generation best: 1.2404 | Overall best: 1.2052 | Improvement: 0.0000
  Improvement 0.0000 < threshold 0.01 (2 consecutive)

*** CONVERGED: improvement 0.0000 < 0.01 ***

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.2052
Best params: {'dim': 2560, 'n_heads': 65, 'n_state': 32, 'depth': 18, 'use_gate': 0, 'lr': 0.0004786203805637956}
Total evaluations: 24

Cleaning up 129 checkpoint files...
Cleanup complete.

To train with best config:
python train.py --level E88 --dim 2560 --n_heads 65 --n_state 32 --depth 18 --lr 0.0004786203805637956 --expansion 1.0 --use_gate 1 --gate_activation silu --train_minutes 30

======================================================================
Finished: 2026-02-03T09:45:46.882770
Duration: 1.53 hours
Return code: 0
