Using device: cuda
Output directory: benchmark_results/cmaes_4d/e42_480M_converge0.01_20260202_002322/eval_8/level42_100m_20260202_002329
Auto r_h_mode: spectral_norm (level 42 has full W_h)
Model: Level 42, 499,363,200 parameters
Using schedule-free AdamW (lr=0.0003)

Starting training from step 0...
Batch size: 8, Chunk size: 512
Gradient accumulation: 1, Effective batch: 8

Time-based training: 30.0 minutes
step     10 | loss 6.2913 | lr 3.00e-04 | grad 19.75 | tok/s 4315
step     20 | loss 3.1887 | lr 3.00e-04 | grad 7.78 | tok/s 7491
step     30 | loss 2.8675 | lr 3.00e-04 | grad 5.75 | tok/s 6109
step     40 | loss 2.8496 | lr 3.00e-04 | grad 19.88 | tok/s 3508
step     50 | loss 2.9539 | lr 3.00e-04 | grad 5.78 | tok/s 3563
step     60 | loss 4.8062 | lr 3.00e-04 | grad 21.88 | tok/s 3599
step     70 | loss 4.1448 | lr 3.00e-04 | grad 24.75 | tok/s 3638
step     80 | loss 4.0811 | lr 3.00e-04 | grad 6.66 | tok/s 3629
step     90 | loss 3.7531 | lr 3.00e-04 | grad 11.94 | tok/s 3630
step    100 | loss 3.4615 | lr 3.00e-04 | grad 10.19 | tok/s 3617
step    110 | loss 3.3749 | lr 3.00e-04 | grad 12.38 | tok/s 3607
step    120 | loss 3.1829 | lr 3.00e-04 | grad 9.81 | tok/s 3605
step    130 | loss 3.2758 | lr 3.00e-04 | grad 13.81 | tok/s 3567
step    140 | loss 2.9741 | lr 3.00e-04 | grad 4.09 | tok/s 3474
step    150 | loss 2.5076 | lr 3.00e-04 | grad 7.94 | tok/s 3546
step    160 | loss 2.9554 | lr 3.00e-04 | grad 4.41 | tok/s 3520
step    170 | loss 2.4623 | lr 3.00e-04 | grad 4.03 | tok/s 3549
step    180 | loss 2.6329 | lr 3.00e-04 | grad 3.17 | tok/s 3435
step    190 | loss 2.6063 | lr 3.00e-04 | grad 2.88 | tok/s 3466
step    200 | loss 2.9387 | lr 3.00e-04 | grad 3.19 | tok/s 3400
step    210 | loss 2.2861 | lr 3.00e-04 | grad 2.23 | tok/s 3422
step    220 | loss 2.2614 | lr 3.00e-04 | grad 3.53 | tok/s 3584
step    230 | loss 2.5649 | lr 3.00e-04 | grad 5.16 | tok/s 3457
step    240 | loss 3.2050 | lr 3.00e-04 | grad 9.38 | tok/s 3418
step    250 | loss 2.5500 | lr 3.00e-04 | grad 5.12 | tok/s 3477
step    260 | loss 2.7635 | lr 3.00e-04 | grad 2.28 | tok/s 3483
step    270 | loss 2.3356 | lr 3.00e-04 | grad 1.85 | tok/s 3474
step    280 | loss 2.4092 | lr 3.00e-04 | grad 4.28 | tok/s 3509
step    290 | loss 2.2083 | lr 3.00e-04 | grad 3.88 | tok/s 3425
step    300 | loss 2.1108 | lr 3.00e-04 | grad 3.22 | tok/s 3184
step    310 | loss 2.2838 | lr 3.00e-04 | grad 6.88 | tok/s 3348
step    320 | loss 2.3375 | lr 3.00e-04 | grad 2.28 | tok/s 3408
step    330 | loss 2.1267 | lr 3.00e-04 | grad 5.38 | tok/s 3281
step    340 | loss 2.2803 | lr 3.00e-04 | grad 3.44 | tok/s 3387
step    350 | loss 2.3512 | lr 3.00e-04 | grad 8.44 | tok/s 3419
step    360 | loss 2.4034 | lr 3.00e-04 | grad 2.14 | tok/s 3436
step    370 | loss 2.3021 | lr 3.00e-04 | grad 2.36 | tok/s 3404
step    380 | loss 2.0611 | lr 3.00e-04 | grad 2.69 | tok/s 3366
step    390 | loss 2.1215 | lr 3.00e-04 | grad 2.30 | tok/s 3589
step    400 | loss 1.9027 | lr 3.00e-04 | grad 1.91 | tok/s 3590
step    410 | loss 1.8676 | lr 3.00e-04 | grad 2.30 | tok/s 3586
step    420 | loss 2.3531 | lr 3.00e-04 | grad 2.97 | tok/s 3439
step    430 | loss 2.1227 | lr 3.00e-04 | grad 2.98 | tok/s 3366
step    440 | loss 2.3096 | lr 3.00e-04 | grad 19.75 | tok/s 3587
step    450 | loss 2.0629 | lr 3.00e-04 | grad 2.05 | tok/s 3435
step    460 | loss 2.2383 | lr 3.00e-04 | grad 1.91 | tok/s 3482
step    470 | loss 1.9502 | lr 3.00e-04 | grad 2.20 | tok/s 3357
step    480 | loss 2.2567 | lr 3.00e-04 | grad 3.53 | tok/s 3453
step    490 | loss 2.1395 | lr 3.00e-04 | grad 2.11 | tok/s 3534
step    500 | loss 2.0799 | lr 3.00e-04 | grad 1.95 | tok/s 3469
step    510 | loss 2.1230 | lr 3.00e-04 | grad 1.73 | tok/s 3490
step    520 | loss 2.3703 | lr 3.00e-04 | grad 8.75 | tok/s 3444
step    530 | loss 2.0408 | lr 3.00e-04 | grad 2.11 | tok/s 3219
step    540 | loss 1.9514 | lr 3.00e-04 | grad 1.54 | tok/s 3438
step    550 | loss 2.2216 | lr 3.00e-04 | grad 3.30 | tok/s 3482
step    560 | loss 2.0374 | lr 3.00e-04 | grad 2.30 | tok/s 3284
step    570 | loss 1.7968 | lr 3.00e-04 | grad 3.52 | tok/s 3490
step    580 | loss 1.9188 | lr 3.00e-04 | grad 1.88 | tok/s 3588
step    590 | loss 1.8139 | lr 3.00e-04 | grad 2.06 | tok/s 3590
step    600 | loss 1.7368 | lr 3.00e-04 | grad 2.30 | tok/s 3586
step    610 | loss 1.8131 | lr 3.00e-04 | grad 2.03 | tok/s 3588
step    620 | loss 1.7662 | lr 3.00e-04 | grad 2.27 | tok/s 3585
step    630 | loss 1.7419 | lr 3.00e-04 | grad 2.33 | tok/s 3588
step    640 | loss 2.1054 | lr 3.00e-04 | grad 5.09 | tok/s 3507
step    650 | loss 1.9501 | lr 3.00e-04 | grad 2.28 | tok/s 3374
step    660 | loss 2.0852 | lr 3.00e-04 | grad 2.45 | tok/s 3425
step    670 | loss 1.9595 | lr 3.00e-04 | grad 2.52 | tok/s 3462
step    680 | loss 2.0803 | lr 3.00e-04 | grad 3.56 | tok/s 3575
step    690 | loss 2.0351 | lr 3.00e-04 | grad 4.00 | tok/s 3317
step    700 | loss 2.0190 | lr 3.00e-04 | grad 2.41 | tok/s 3432
step    710 | loss 2.0908 | lr 3.00e-04 | grad 1.50 | tok/s 3367
step    720 | loss 1.9522 | lr 3.00e-04 | grad 2.47 | tok/s 3400
step    730 | loss 2.0983 | lr 3.00e-04 | grad 2.53 | tok/s 3468
step    740 | loss 1.7513 | lr 3.00e-04 | grad 1.96 | tok/s 3524
step    750 | loss 2.1304 | lr 3.00e-04 | grad 2.58 | tok/s 3489
step    760 | loss 2.5812 | lr 3.00e-04 | grad 4.12 | tok/s 3566
step    770 | loss 1.9576 | lr 3.00e-04 | grad 1.94 | tok/s 3538
step    780 | loss 2.0335 | lr 3.00e-04 | grad 1.95 | tok/s 3549
step    790 | loss 1.9536 | lr 3.00e-04 | grad 1.75 | tok/s 3350
step    800 | loss 1.8240 | lr 3.00e-04 | grad 1.81 | tok/s 3469
step    810 | loss 2.4429 | lr 3.00e-04 | grad 3.11 | tok/s 3587
step    820 | loss 1.5780 | lr 3.00e-04 | grad 1.82 | tok/s 3488
step    830 | loss 1.9662 | lr 3.00e-04 | grad 4.28 | tok/s 3332
step    840 | loss 1.7769 | lr 3.00e-04 | grad 2.23 | tok/s 3411
step    850 | loss 1.9452 | lr 3.00e-04 | grad 2.28 | tok/s 3455
step    860 | loss 2.1939 | lr 3.00e-04 | grad 2.20 | tok/s 3373
step    870 | loss 2.0142 | lr 3.00e-04 | grad 2.33 | tok/s 3410
step    880 | loss 2.1458 | lr 3.00e-04 | grad 1.94 | tok/s 3533
step    890 | loss 2.0434 | lr 3.00e-04 | grad 2.55 | tok/s 3483
step    900 | loss 1.9825 | lr 3.00e-04 | grad 2.12 | tok/s 3441
step    910 | loss 1.8169 | lr 3.00e-04 | grad 2.95 | tok/s 3502
step    920 | loss 1.9334 | lr 3.00e-04 | grad 2.89 | tok/s 3404
step    930 | loss 1.9768 | lr 3.00e-04 | grad 2.66 | tok/s 3470
step    940 | loss 1.8364 | lr 3.00e-04 | grad 2.36 | tok/s 3418
step    950 | loss 1.7849 | lr 3.00e-04 | grad 1.91 | tok/s 3458
step    960 | loss 1.8513 | lr 3.00e-04 | grad 3.41 | tok/s 3327
step    970 | loss 1.7649 | lr 3.00e-04 | grad 1.98 | tok/s 3403
step    980 | loss 1.8076 | lr 3.00e-04 | grad 2.05 | tok/s 3434
step    990 | loss 2.0039 | lr 3.00e-04 | grad 5.16 | tok/s 3430
step   1000 | loss 2.4556 | lr 3.00e-04 | grad 3.36 | tok/s 3540
  >>> saved checkpoint: checkpoint_step_001000_loss_2.4556.pt
step   1010 | loss 1.9958 | lr 3.00e-04 | grad 6.19 | tok/s 2532
step   1020 | loss 1.9920 | lr 3.00e-04 | grad 3.59 | tok/s 3484
step   1030 | loss 1.7083 | lr 3.00e-04 | grad 2.52 | tok/s 3533
step   1040 | loss 1.6886 | lr 3.00e-04 | grad 2.19 | tok/s 3586
step   1050 | loss 2.1056 | lr 3.00e-04 | grad 2.09 | tok/s 4251
step   1060 | loss 2.2733 | lr 3.00e-04 | grad 3.20 | tok/s 3974
step   1070 | loss 2.1054 | lr 3.00e-04 | grad 2.22 | tok/s 3532
step   1080 | loss 1.8148 | lr 3.00e-04 | grad 2.02 | tok/s 3468
step   1090 | loss 1.5949 | lr 3.00e-04 | grad 2.53 | tok/s 3496
step   1100 | loss 1.6241 | lr 3.00e-04 | grad 2.22 | tok/s 3596
step   1110 | loss 1.5634 | lr 3.00e-04 | grad 1.84 | tok/s 3585
step   1120 | loss 1.5564 | lr 3.00e-04 | grad 2.22 | tok/s 3579
step   1130 | loss 1.4899 | lr 3.00e-04 | grad 1.75 | tok/s 3590
step   1140 | loss 1.7624 | lr 3.00e-04 | grad 2.69 | tok/s 3568
step   1150 | loss 2.2010 | lr 3.00e-04 | grad 2.89 | tok/s 3422
step   1160 | loss 2.1184 | lr 3.00e-04 | grad 2.66 | tok/s 3527
step   1170 | loss 2.2744 | lr 3.00e-04 | grad 6.28 | tok/s 3531
step   1180 | loss 2.1923 | lr 3.00e-04 | grad 4.06 | tok/s 3392
step   1190 | loss 2.0475 | lr 3.00e-04 | grad 1.68 | tok/s 3324
step   1200 | loss 1.8525 | lr 3.00e-04 | grad 2.08 | tok/s 3557
step   1210 | loss 2.0689 | lr 3.00e-04 | grad 3.02 | tok/s 3555
step   1220 | loss 1.6727 | lr 3.00e-04 | grad 1.93 | tok/s 3580
step   1230 | loss 1.6504 | lr 3.00e-04 | grad 3.88 | tok/s 3439
step   1240 | loss 1.7455 | lr 3.00e-04 | grad 2.28 | tok/s 3387
step   1250 | loss 1.8265 | lr 3.00e-04 | grad 3.45 | tok/s 3451
step   1260 | loss 1.6463 | lr 3.00e-04 | grad 2.84 | tok/s 3583
step   1270 | loss 1.8279 | lr 3.00e-04 | grad 3.55 | tok/s 3492
step   1280 | loss 2.0249 | lr 3.00e-04 | grad 2.97 | tok/s 3592
step   1290 | loss 1.7586 | lr 3.00e-04 | grad 2.42 | tok/s 3417
step   1300 | loss 1.6730 | lr 3.00e-04 | grad 3.48 | tok/s 3464
step   1310 | loss 1.8833 | lr 3.00e-04 | grad 2.12 | tok/s 3407
step   1320 | loss 1.7695 | lr 3.00e-04 | grad 2.77 | tok/s 3344
step   1330 | loss 2.1492 | lr 3.00e-04 | grad 2.55 | tok/s 3557
step   1340 | loss 1.9063 | lr 3.00e-04 | grad 1.98 | tok/s 3537
step   1350 | loss 1.9080 | lr 3.00e-04 | grad 2.41 | tok/s 3496
step   1360 | loss 1.8169 | lr 3.00e-04 | grad 6.72 | tok/s 3345
step   1370 | loss 1.9347 | lr 3.00e-04 | grad 2.80 | tok/s 3531
step   1380 | loss 1.9183 | lr 3.00e-04 | grad 3.03 | tok/s 3304
step   1390 | loss 1.8768 | lr 3.00e-04 | grad 4.25 | tok/s 3517
step   1400 | loss 1.9594 | lr 3.00e-04 | grad 2.09 | tok/s 3467
step   1410 | loss 1.6811 | lr 3.00e-04 | grad 2.11 | tok/s 3431
step   1420 | loss 2.0230 | lr 3.00e-04 | grad 1.66 | tok/s 3354
step   1430 | loss 1.6058 | lr 3.00e-04 | grad 1.84 | tok/s 3331
step   1440 | loss 1.6850 | lr 3.00e-04 | grad 2.33 | tok/s 3549
step   1450 | loss 2.1581 | lr 3.00e-04 | grad 2.48 | tok/s 3454
step   1460 | loss 1.7403 | lr 3.00e-04 | grad 2.47 | tok/s 3463
step   1470 | loss 1.8804 | lr 3.00e-04 | grad 2.17 | tok/s 3549
step   1480 | loss 1.7874 | lr 3.00e-04 | grad 1.65 | tok/s 3418
step   1490 | loss 1.9183 | lr 3.00e-04 | grad 2.47 | tok/s 3493
step   1500 | loss 1.7515 | lr 3.00e-04 | grad 2.03 | tok/s 3493
step   1510 | loss 1.8418 | lr 3.00e-04 | grad 2.05 | tok/s 3462
step   1520 | loss 2.1992 | lr 3.00e-04 | grad 1.69 | tok/s 3567
step   1530 | loss 1.6863 | lr 3.00e-04 | grad 1.77 | tok/s 3377
step   1540 | loss 1.8265 | lr 3.00e-04 | grad 2.30 | tok/s 3472
step   1550 | loss 1.7332 | lr 3.00e-04 | grad 2.39 | tok/s 3499
step   1560 | loss 1.7591 | lr 3.00e-04 | grad 1.47 | tok/s 3582
step   1570 | loss 1.7515 | lr 3.00e-04 | grad 2.25 | tok/s 3484

Training complete! Final step: 1578
