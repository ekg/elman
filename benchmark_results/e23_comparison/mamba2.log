Loading data from data/pile.txt...

Creating mamba2 model with ~50m parameters...
Created Mamba2 model: dim=672, depth=18, expand=2, params=50,928,750

============================================================
Training: mamba2 (timeout=600.0s)
Parameters: 50.93M
Vocab size: 256
============================================================
[mamba2] step    1 | loss 5.7500 | ppl 314.2 | grad 5.12 | 152 tok/s | 13.5s | 13507ms/step
[mamba2] step   50 | loss 2.4219 | ppl 11.3 | grad 2.22 | 5528 tok/s | 18.5s | 101ms/step
[mamba2] step  100 | loss 3.9375 | ppl 51.3 | grad 9.19 | 8682 tok/s | 23.6s | 100ms/step
[mamba2] step  150 | loss 1.8828 | ppl 6.6 | grad 4.97 | 10722 tok/s | 28.7s | 100ms/step
[mamba2] step  200 | loss 3.7344 | ppl 41.9 | grad 3.38 | 12141 tok/s | 33.7s | 102ms/step
[mamba2] step  250 | loss 3.1562 | ppl 23.5 | grad 2.70 | 13202 tok/s | 38.8s | 92ms/step
[mamba2] step  300 | loss 1.8516 | ppl 6.4 | grad 2.67 | 14109 tok/s | 43.5s | 95ms/step
[mamba2] step  350 | loss 1.6953 | ppl 5.4 | grad 2.67 | 14778 tok/s | 48.5s | 98ms/step
[mamba2] step  400 | loss 1.6016 | ppl 5.0 | grad 1.48 | 15305 tok/s | 53.5s | 101ms/step
[mamba2] step  450 | loss 1.9062 | ppl 6.7 | grad 2.50 | 15736 tok/s | 58.6s | 102ms/step
[mamba2] step  500 | loss 2.1250 | ppl 8.4 | grad 2.50 | 16093 tok/s | 63.6s | 105ms/step
[mamba2] step  550 | loss 1.8125 | ppl 6.1 | grad 2.23 | 16395 tok/s | 68.7s | 103ms/step
[mamba2] step  600 | loss 0.9688 | ppl 2.6 | grad 2.17 | 16653 tok/s | 73.8s | 100ms/step
[mamba2] step  650 | loss 2.1250 | ppl 8.4 | grad 3.52 | 16891 tok/s | 78.8s | 100ms/step
[mamba2] step  700 | loss 2.0312 | ppl 7.6 | grad 2.39 | 17094 tok/s | 83.9s | 100ms/step
[mamba2] step  750 | loss 1.9062 | ppl 6.7 | grad 2.67 | 17271 tok/s | 88.9s | 104ms/step
[mamba2] step  800 | loss 1.8828 | ppl 6.6 | grad 2.62 | 17429 tok/s | 94.0s | 100ms/step
[mamba2] step  850 | loss 1.8672 | ppl 6.5 | grad 2.41 | 17567 tok/s | 99.1s | 102ms/step
[mamba2] step  900 | loss 1.9375 | ppl 6.9 | grad 2.39 | 17694 tok/s | 104.2s | 102ms/step
[mamba2] step  950 | loss 1.7031 | ppl 5.5 | grad 2.88 | 17840 tok/s | 109.1s | 94ms/step
[mamba2] step 1000 | loss 1.7734 | ppl 5.9 | grad 2.34 | 17980 tok/s | 113.9s | 105ms/step
[mamba2] step 1050 | loss 2.0156 | ppl 7.5 | grad 2.19 | 18063 tok/s | 119.0s | 103ms/step
[mamba2] step 1100 | loss 1.7969 | ppl 6.0 | grad 2.09 | 18147 tok/s | 124.1s | 100ms/step
[mamba2] step 1150 | loss 1.5391 | ppl 4.7 | grad 4.94 | 18229 tok/s | 129.2s | 101ms/step
[mamba2] step 1200 | loss 1.8672 | ppl 6.5 | grad 2.17 | 18311 tok/s | 134.2s | 100ms/step
[mamba2] step 1250 | loss 1.7891 | ppl 6.0 | grad 2.02 | 18390 tok/s | 139.2s | 97ms/step
[mamba2] step 1300 | loss 1.7188 | ppl 5.6 | grad 2.36 | 18494 tok/s | 144.0s | 93ms/step
[mamba2] step 1350 | loss 2.0000 | ppl 7.4 | grad 2.81 | 18568 tok/s | 148.9s | 97ms/step
[mamba2] step 1400 | loss 2.4844 | ppl 12.0 | grad 3.55 | 18647 tok/s | 153.8s | 97ms/step
[mamba2] step 1450 | loss 2.0625 | ppl 7.9 | grad 2.52 | 18714 tok/s | 158.7s | 99ms/step
[mamba2] step 1500 | loss 1.7031 | ppl 5.5 | grad 2.08 | 18761 tok/s | 163.7s | 101ms/step
[mamba2] step 1550 | loss 1.5859 | ppl 4.9 | grad 1.95 | 18810 tok/s | 168.8s | 100ms/step
[mamba2] step 1600 | loss 1.4922 | ppl 4.4 | grad 2.95 | 18854 tok/s | 173.8s | 99ms/step
[mamba2] step 1650 | loss 1.8750 | ppl 6.5 | grad 2.62 | 18893 tok/s | 178.9s | 101ms/step
[mamba2] step 1700 | loss 2.1250 | ppl 8.4 | grad 2.73 | 18900 tok/s | 184.2s | 110ms/step
[mamba2] step 1750 | loss 1.7188 | ppl 5.6 | grad 2.45 | 18893 tok/s | 189.7s | 96ms/step
[mamba2] step 1800 | loss 1.9141 | ppl 6.8 | grad 3.02 | 18943 tok/s | 194.6s | 96ms/step
[mamba2] step 1850 | loss 2.3906 | ppl 10.9 | grad 3.20 | 18997 tok/s | 199.4s | 95ms/step
[mamba2] step 1900 | loss 1.4922 | ppl 4.4 | grad 2.89 | 19047 tok/s | 204.3s | 96ms/step
[mamba2] step 1950 | loss 1.8438 | ppl 6.3 | grad 3.48 | 19093 tok/s | 209.2s | 98ms/step
[mamba2] step 2000 | loss 1.4219 | ppl 4.1 | grad 2.06 | 19138 tok/s | 214.0s | 96ms/step
[mamba2] step 2050 | loss 1.6016 | ppl 5.0 | grad 3.19 | 19185 tok/s | 218.8s | 96ms/step
[mamba2] step 2100 | loss 1.7578 | ppl 5.8 | grad 2.89 | 19224 tok/s | 223.7s | 99ms/step
[mamba2] step 2150 | loss 1.8125 | ppl 6.1 | grad 4.19 | 19258 tok/s | 228.6s | 104ms/step
[mamba2] step 2200 | loss 1.4141 | ppl 4.1 | grad 2.64 | 19304 tok/s | 233.4s | 117ms/step
[mamba2] step 2250 | loss 1.6016 | ppl 5.0 | grad 2.16 | 19332 tok/s | 238.4s | 97ms/step
[mamba2] step 2300 | loss 1.3984 | ppl 4.0 | grad 2.23 | 19362 tok/s | 243.3s | 97ms/step
[mamba2] step 2350 | loss 1.3359 | ppl 3.8 | grad 2.17 | 19388 tok/s | 248.2s | 98ms/step
[mamba2] step 2400 | loss 1.5859 | ppl 4.9 | grad 2.77 | 19418 tok/s | 253.1s | 96ms/step
[mamba2] step 2450 | loss 1.3750 | ppl 4.0 | grad 2.22 | 19446 tok/s | 258.0s | 99ms/step
[mamba2] step 2500 | loss 1.3359 | ppl 3.8 | grad 2.06 | 19477 tok/s | 262.9s | 95ms/step
[mamba2] step 2550 | loss 0.9453 | ppl 2.6 | grad 3.58 | 19490 tok/s | 268.0s | 102ms/step
[mamba2] step 2600 | loss 2.1875 | ppl 8.9 | grad 4.72 | 19491 tok/s | 273.2s | 109ms/step
[mamba2] step 2650 | loss 1.6562 | ppl 5.2 | grad 3.42 | 19474 tok/s | 278.7s | 112ms/step
[mamba2] step 2700 | loss 1.2266 | ppl 3.4 | grad 4.38 | 19449 tok/s | 284.3s | 112ms/step
[mamba2] step 2750 | loss 1.7812 | ppl 5.9 | grad 3.06 | 19426 tok/s | 289.9s | 112ms/step
[mamba2] step 2800 | loss 1.8281 | ppl 6.2 | grad 3.27 | 19459 tok/s | 294.7s | 95ms/step
[mamba2] step 2850 | loss 1.5781 | ppl 4.8 | grad 2.80 | 19493 tok/s | 299.4s | 95ms/step
[mamba2] step 2900 | loss 1.3984 | ppl 4.0 | grad 3.38 | 19496 tok/s | 304.6s | 113ms/step
[mamba2] step 2950 | loss 1.9688 | ppl 7.2 | grad 3.64 | 19474 tok/s | 310.2s | 113ms/step
[mamba2] step 3000 | loss 3.1250 | ppl 22.8 | grad 6.34 | 19502 tok/s | 315.0s | 95ms/step
[mamba2] step 3050 | loss 2.7812 | ppl 16.1 | grad 6.78 | 19529 tok/s | 319.9s | 95ms/step
[mamba2] step 3100 | loss 1.4766 | ppl 4.4 | grad 2.61 | 19559 tok/s | 324.6s | 95ms/step
[mamba2] step 3150 | loss 2.1094 | ppl 8.2 | grad 4.62 | 19587 tok/s | 329.4s | 96ms/step
[mamba2] step 3200 | loss 3.0781 | ppl 21.7 | grad 5.84 | 19602 tok/s | 334.3s | 105ms/step
[mamba2] step 3250 | loss 1.2109 | ppl 3.4 | grad 3.39 | 19588 tok/s | 339.8s | 112ms/step
[mamba2] step 3300 | loss 1.5859 | ppl 4.9 | grad 2.58 | 19594 tok/s | 344.9s | 95ms/step
[mamba2] step 3350 | loss 1.5703 | ppl 4.8 | grad 2.72 | 19621 tok/s | 349.7s | 95ms/step
[mamba2] step 3400 | loss 1.4766 | ppl 4.4 | grad 2.64 | 19647 tok/s | 354.4s | 95ms/step
[mamba2] step 3450 | loss 1.7734 | ppl 5.9 | grad 3.53 | 19672 tok/s | 359.2s | 95ms/step
[mamba2] step 3500 | loss 1.9219 | ppl 6.8 | grad 3.52 | 19693 tok/s | 364.0s | 104ms/step
[mamba2] step 3550 | loss 1.7891 | ppl 6.0 | grad 3.17 | 19684 tok/s | 369.4s | 112ms/step
[mamba2] step 3600 | loss 1.5625 | ppl 4.8 | grad 2.53 | 19662 tok/s | 375.0s | 113ms/step
[mamba2] step 3650 | loss 2.0000 | ppl 7.4 | grad 2.92 | 19684 tok/s | 379.8s | 97ms/step
[mamba2] step 3700 | loss 1.4688 | ppl 4.3 | grad 2.52 | 19706 tok/s | 384.5s | 96ms/step
[mamba2] step 3750 | loss 1.7500 | ppl 5.8 | grad 3.20 | 19727 tok/s | 389.3s | 97ms/step
[mamba2] step 3800 | loss 2.1250 | ppl 8.4 | grad 4.28 | 19745 tok/s | 394.2s | 96ms/step
[mamba2] step 3850 | loss 1.6875 | ppl 5.4 | grad 2.73 | 19741 tok/s | 399.4s | 107ms/step
[mamba2] step 3900 | loss 1.5781 | ppl 4.8 | grad 2.56 | 19723 tok/s | 405.0s | 113ms/step
[mamba2] step 3950 | loss 2.2188 | ppl 9.2 | grad 3.86 | 19702 tok/s | 410.6s | 112ms/step
[mamba2] step 4000 | loss 1.6094 | ppl 5.0 | grad 3.06 | 19682 tok/s | 416.2s | 113ms/step
[mamba2] step 4050 | loss 1.7031 | ppl 5.5 | grad 2.89 | 19684 tok/s | 421.4s | 95ms/step
[mamba2] step 4100 | loss 1.5391 | ppl 4.7 | grad 2.66 | 19704 tok/s | 426.2s | 95ms/step
[mamba2] step 4150 | loss 1.8984 | ppl 6.7 | grad 2.89 | 19707 tok/s | 431.3s | 104ms/step
[mamba2] step 4200 | loss 2.7500 | ppl 15.6 | grad 6.44 | 19697 tok/s | 436.7s | 111ms/step
[mamba2] step 4250 | loss 1.6875 | ppl 5.4 | grad 3.70 | 19680 tok/s | 442.3s | 113ms/step
[mamba2] step 4300 | loss 0.9336 | ppl 2.5 | grad 2.12 | 19660 tok/s | 447.9s | 113ms/step
[mamba2] step 4350 | loss 1.5234 | ppl 4.6 | grad 2.52 | 19672 tok/s | 452.9s | 95ms/step
[mamba2] step 4400 | loss 1.4688 | ppl 4.3 | grad 2.55 | 19691 tok/s | 457.6s | 95ms/step
[mamba2] step 4450 | loss 1.4297 | ppl 4.2 | grad 2.55 | 19706 tok/s | 462.5s | 103ms/step
[mamba2] step 4500 | loss 1.4375 | ppl 4.2 | grad 2.48 | 19704 tok/s | 467.7s | 112ms/step
[mamba2] step 4550 | loss 2.9219 | ppl 18.6 | grad 8.62 | 19686 tok/s | 473.3s | 113ms/step
[mamba2] step 4600 | loss 2.4375 | ppl 11.4 | grad 4.88 | 19691 tok/s | 478.4s | 96ms/step
[mamba2] step 4650 | loss 3.4375 | ppl 31.1 | grad 6.22 | 19709 tok/s | 483.2s | 95ms/step
[mamba2] step 4700 | loss 2.8438 | ppl 17.2 | grad 5.69 | 19727 tok/s | 487.9s | 95ms/step
[mamba2] step 4750 | loss 1.5000 | ppl 4.5 | grad 3.58 | 19744 tok/s | 492.7s | 96ms/step
[mamba2] step 4800 | loss 2.2344 | ppl 9.3 | grad 4.72 | 19761 tok/s | 497.5s | 95ms/step
[mamba2] step 4850 | loss 1.2578 | ppl 3.5 | grad 2.42 | 19762 tok/s | 502.6s | 103ms/step
[mamba2] step 4900 | loss 1.5078 | ppl 4.5 | grad 3.28 | 19748 tok/s | 508.2s | 113ms/step
[mamba2] step 4950 | loss 1.5781 | ppl 4.8 | grad 3.00 | 19731 tok/s | 513.8s | 115ms/step
[mamba2] step 5000 | loss 1.7344 | ppl 5.7 | grad 3.12 | 19727 tok/s | 519.1s | 96ms/step
[mamba2] step 5050 | loss 1.6562 | ppl 5.2 | grad 2.84 | 19742 tok/s | 523.9s | 95ms/step
[mamba2] step 5100 | loss 1.7656 | ppl 5.8 | grad 4.47 | 19756 tok/s | 528.7s | 96ms/step
[mamba2] step 5150 | loss 1.4219 | ppl 4.1 | grad 2.64 | 19765 tok/s | 533.6s | 105ms/step
[mamba2] step 5200 | loss 1.3438 | ppl 3.8 | grad 2.64 | 19760 tok/s | 539.0s | 113ms/step
[mamba2] step 5250 | loss 1.6172 | ppl 5.0 | grad 3.69 | 19743 tok/s | 544.6s | 113ms/step
[mamba2] step 5300 | loss 1.7344 | ppl 5.7 | grad 3.02 | 19754 tok/s | 549.5s | 95ms/step
[mamba2] step 5350 | loss 1.7500 | ppl 5.8 | grad 3.72 | 19768 tok/s | 554.3s | 95ms/step
[mamba2] step 5400 | loss 2.3438 | ppl 10.4 | grad 5.38 | 19782 tok/s | 559.1s | 96ms/step
[mamba2] step 5450 | loss 1.7422 | ppl 5.7 | grad 3.16 | 19796 tok/s | 563.8s | 96ms/step
[mamba2] step 5500 | loss 1.7734 | ppl 5.9 | grad 8.06 | 19803 tok/s | 568.8s | 105ms/step
[mamba2] step 5550 | loss 2.2969 | ppl 9.9 | grad 3.97 | 19797 tok/s | 574.1s | 113ms/step
[mamba2] step 5600 | loss 1.8672 | ppl 6.5 | grad 3.89 | 19781 tok/s | 579.8s | 113ms/step
[mamba2] step 5650 | loss 2.3438 | ppl 10.4 | grad 4.34 | 19771 tok/s | 585.3s | 97ms/step
[mamba2] step 5700 | loss 1.6328 | ppl 5.1 | grad 2.97 | 19784 tok/s | 590.1s | 95ms/step
[mamba2] step 5750 | loss 1.5078 | ppl 4.5 | grad 3.33 | 19796 tok/s | 594.9s | 96ms/step
[mamba2] step 5800 | loss 1.5625 | ppl 4.8 | grad 3.34 | 19797 tok/s | 600.0s | 108ms/step
[mamba2] Timeout reached at 600.0s

mamba2 Final: loss=1.7999, grad=3.36, steps=5801, tokens=11,878,400, time=600.0s

==========================================================================================
BENCHMARK SUMMARY
==========================================================================================
Model           Params       Loss       Steps    Tokens       tok/s      Time    
------------------------------------------------------------------------------------------
mamba2          50.93M       1.7999     5801     11,878,400   19797      600.0   s

Results saved to: benchmark_results/e23_comparison
