/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'expansion': 2, 'depth': 24, 'n_heads': 16}
Encoded x0: ['0.500', '0.333', '0.333']
======================================================================
CMA-ES Search for FLA-GDN
======================================================================
Search space (3 dimensions):
  expansion: [1, 3] (int) - FFN expansion factor (must be int for FLA)
  depth: [16, 40] (int) - Number of layers
  n_heads: [8, 32] (int) - Number of heads
Target params: 480M Â± 30M
Training time per config: 10.0 min
Generations: 15
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~120
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 3 (seed=588500, Tue Jan 27 06:02:47 2026)

--- Generation 1/15 ---
  [Eval 7] Skip - params 510.1M vs target 480M
  [Eval 8] Skip - params 510.1M vs target 480M
  [Eval 5] GPU 4 | expansion=2, depth=19, n_heads=19 | dim=1792 | 488.7M params
  [Eval 5] Loss: 1.3093
  [Eval 1] GPU 0 | expansion=2, depth=25, n_heads=12 | dim=1536 | 472.4M params
  [Eval 1] Loss: 1.4131
  [Eval 6] GPU 5 | expansion=2, depth=18, n_heads=16 | dim=1792 | 463.0M params
  [Eval 6] Loss: 1.3971
  [Eval 3] GPU 2 | expansion=2, depth=26, n_heads=18 | dim=1536 | 491.3M params
  [Eval 3] Loss: 1.3351
  [Eval 4] GPU 3 | expansion=2, depth=31, n_heads=15 | dim=1408 | 492.2M params
  [Eval 4] Loss: 1.3311
  [Eval 2] GPU 1 | expansion=1, depth=24, n_heads=20 | dim=2176 | 455.2M params
  [Eval 2] Loss: 1.4349
  *** NEW BEST: 1.4131 | {'expansion': 2, 'depth': 25, 'n_heads': 12} | dim=1536 ***
  *** NEW BEST: 1.3351 | {'expansion': 2, 'depth': 26, 'n_heads': 18} | dim=1536 ***
  *** NEW BEST: 1.3311 | {'expansion': 2, 'depth': 31, 'n_heads': 15} | dim=1408 ***
  *** NEW BEST: 1.3093 | {'expansion': 2, 'depth': 19, 'n_heads': 19} | dim=1792 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.309262000000000e+00 1.0e+00 1.27e-01  1e-01  1e-01 10:16.0

--- Generation 2/15 ---
  [Eval 9] Skip - params 510.1M vs target 480M
  [Eval 10] Skip - params 514.4M vs target 480M
  [Eval 14] Skip - params 510.2M vs target 480M
  [Eval 12] Skip - params 510.2M vs target 480M
  [Eval 16] Skip - params 514.4M vs target 480M
  [Eval 15] GPU 6 | expansion=2, depth=25, n_heads=17 | dim=1536 | 472.4M params
  [Eval 15] Loss: 1.4086
  [Eval 13] GPU 4 | expansion=2, depth=25, n_heads=14 | dim=1536 | 472.4M params
  [Eval 13] Loss: 1.4095
  [Eval 11] GPU 2 | expansion=2, depth=22, n_heads=19 | dim=1664 | 487.9M params
  [Eval 11] Loss: 1.3150
    2     16 1.314999000000000e+00 1.4e+00 1.14e-01  1e-01  1e-01 20:30.8

--- Generation 3/15 ---
  [Eval 20] Skip - params 510.1M vs target 480M
  [Eval 23] GPU 6 | expansion=2, depth=21, n_heads=16 | dim=1664 | 465.7M params
  [Eval 23] Loss: 1.4086
  [Eval 22] Skip - params 510.2M vs target 480M
  [Eval 21] GPU 4 | expansion=2, depth=21, n_heads=21 | dim=1664 | 465.7M params
  [Eval 21] Loss: 1.4123
  [Eval 17] Skip - params 444.6M vs target 480M
  [Eval 24] GPU 7 | expansion=2, depth=22, n_heads=23 | dim=1664 | 487.9M params
  [Eval 24] Loss: 1.2966
  [Eval 18] GPU 1 | expansion=2, depth=24, n_heads=17 | dim=1536 | 453.5M params
  [Eval 18] Loss: 1.4006
  [Eval 19] GPU 2 | expansion=2, depth=22, n_heads=20 | dim=1664 | 487.9M params
  [Eval 19] Loss: 1.2930
  *** NEW BEST: 1.2930 | {'expansion': 2, 'depth': 22, 'n_heads': 20} | dim=1664 ***
    3     24 1.292993000000000e+00 1.2e+00 1.27e-01  1e-01  1e-01 30:46.0

--- Generation 4/15 ---
  [Eval 27] Skip - params 514.4M vs target 480M
  [Eval 29] Skip - params 510.2M vs target 480M
  [Eval 31] Skip - params 444.6M vs target 480M
  [Eval 32] GPU 7 | expansion=2, depth=16, n_heads=27 | dim=1920 | 472.5M params
  [Eval 32] Loss: 1.4021
  [Eval 25] GPU 0 | expansion=2, depth=17, n_heads=21 | dim=1920 | 502.0M params
  [Eval 25] Loss: 1.3067
  [Eval 28] GPU 3 | expansion=2, depth=24, n_heads=21 | dim=1536 | 453.5M params
  [Eval 28] Loss: 1.4085
  [Eval 30] GPU 5 | expansion=2, depth=17, n_heads=20 | dim=1920 | 502.0M params
  [Eval 30] Loss: 1.3008
  [Eval 26] GPU 1 | expansion=2, depth=26, n_heads=15 | dim=1536 | 491.3M params
  [Eval 26] Loss: 1.3051
    4     32 1.300819000000000e+00 1.4e+00 1.37e-01  1e-01  1e-01 41:01.6

--- Generation 5/15 ---
  [Eval 33] Skip - params 514.4M vs target 480M
  [Eval 37] GPU 4 | expansion=2, depth=22, n_heads=22 | dim=1664 | 487.9M params
  [Eval 37] Loss: 1.2941
  [Eval 39] Skip - params 514.4M vs target 480M
  [Eval 40] GPU 7 | expansion=2, depth=17, n_heads=20 | dim=1920 | 502.0M params
  [Eval 40] Loss: 1.2879
  [Eval 38] GPU 5 | expansion=2, depth=22, n_heads=18 | dim=1664 | 487.9M params
  [Eval 38] Loss: 1.3002
  [Eval 34] GPU 1 | expansion=2, depth=16, n_heads=21 | dim=1920 | 472.5M params
  [Eval 34] Loss: 1.3783
  [Eval 35] GPU 2 | expansion=2, depth=21, n_heads=17 | dim=1664 | 465.7M params
  [Eval 35] Loss: 1.4116
  [Eval 36] GPU 3 | expansion=2, depth=22, n_heads=11 | dim=1664 | 487.9M params
  [Eval 36] Loss: 1.2855
  *** NEW BEST: 1.2855 | {'expansion': 2, 'depth': 22, 'n_heads': 11} | dim=1664 ***
    5     40 1.285468000000000e+00 1.8e+00 1.44e-01  1e-01  2e-01 51:17.7

--- Generation 6/15 ---
  [Eval 42] Skip - params 514.4M vs target 480M
  [Eval 46] GPU 5 | expansion=2, depth=18, n_heads=18 | dim=1792 | 463.0M params
  [Eval 46] Loss: 1.3991
  [Eval 48] GPU 7 | expansion=2, depth=29, n_heads=9 | dim=1408 | 460.5M params
  [Eval 48] Loss: 1.4254
  [Eval 43] GPU 2 | expansion=2, depth=19, n_heads=19 | dim=1792 | 488.7M params
  [Eval 43] Loss: 1.2945
  [Eval 47] GPU 6 | expansion=2, depth=26, n_heads=11 | dim=1536 | 491.3M params
  [Eval 47] Loss: 1.3189
  [Eval 44] GPU 3 | expansion=2, depth=19, n_heads=19 | dim=1792 | 488.7M params
  [Eval 44] Loss: 1.2887
  [Eval 45] GPU 4 | expansion=2, depth=18, n_heads=17 | dim=1792 | 463.0M params
  [Eval 45] Loss: 1.4046
  [Eval 41] GPU 0 | expansion=2, depth=19, n_heads=23 | dim=1792 | 488.7M params
  [Eval 41] Loss: 1.2942
    6     48 1.288697000000000e+00 1.8e+00 1.37e-01  1e-01  1e-01 61:33.3

--- Generation 7/15 ---
  [Eval 54] Skip - params 514.4M vs target 480M
  [Eval 49] GPU 0 | expansion=2, depth=18, n_heads=23 | dim=1792 | 463.0M params
  [Eval 49] Loss: 1.4077
  [Eval 51] GPU 2 | expansion=2, depth=16, n_heads=24 | dim=1920 | 472.5M params
  [Eval 51] Loss: 1.3893
  [Eval 52] GPU 3 | expansion=2, depth=16, n_heads=25 | dim=1920 | 472.5M params
  [Eval 52] Loss: 1.3804
  [Eval 56] GPU 7 | expansion=2, depth=18, n_heads=19 | dim=1792 | 463.0M params
  [Eval 56] Loss: 1.3998
  [Eval 55] GPU 6 | expansion=2, depth=16, n_heads=22 | dim=1920 | 472.5M params
  [Eval 55] Loss: 1.3943
  [Eval 50] GPU 1 | expansion=1, depth=18, n_heads=19 | dim=2560 | 472.6M params
  [Eval 50] Loss: 1.4131
  [Eval 53] GPU 4 | expansion=2, depth=17, n_heads=18 | dim=1920 | 502.0M params
  [Eval 53] Loss: 1.2776
  *** NEW BEST: 1.2776 | {'expansion': 2, 'depth': 17, 'n_heads': 18} | dim=1920 ***
    7     56 1.277616000000000e+00 1.8e+00 1.45e-01  1e-01  2e-01 71:53.3

--- Generation 8/15 ---
  [Eval 62] GPU 5 | expansion=2, depth=21, n_heads=11 | dim=1664 | 465.7M params
  [Eval 62] Loss: 1.4056
  [Eval 57] Skip - params 514.4M vs target 480M
  [Eval 61] GPU 4 | expansion=2, depth=19, n_heads=20 | dim=1792 | 488.7M params
  [Eval 61] Loss: 1.2923
  [Eval 59] GPU 2 | expansion=2, depth=17, n_heads=24 | dim=1920 | 502.0M params
  [Eval 59] Loss: 1.2774
  [Eval 64] GPU 7 | expansion=2, depth=21, n_heads=16 | dim=1664 | 465.7M params
  [Eval 64] Loss: 1.4082
  [Eval 58] GPU 1 | expansion=2, depth=17, n_heads=27 | dim=1920 | 502.0M params
  [Eval 58] Loss: 1.2755
  [Eval 63] GPU 6 | expansion=1, depth=16, n_heads=22 | dim=2688 | 463.2M params
  [Eval 63] Loss: 1.4654
  [Eval 60] GPU 3 | expansion=2, depth=16, n_heads=21 | dim=1920 | 472.5M params
  [Eval 60] Loss: 1.3787
  *** NEW BEST: 1.2755 | {'expansion': 2, 'depth': 17, 'n_heads': 27} | dim=1920 ***
    8     64 1.275464000000000e+00 2.0e+00 1.65e-01  1e-01  2e-01 82:09.0

--- Generation 9/15 ---
  [Eval 67] GPU 2 | expansion=2, depth=16, n_heads=23 | dim=1920 | 472.5M params
  [Eval 67] Loss: 1.3880
  [Eval 68] GPU 3 | expansion=2, depth=16, n_heads=26 | dim=1920 | 472.5M params
  [Eval 68] Loss: 1.3764
  [Eval 72] GPU 7 | expansion=2, depth=17, n_heads=17 | dim=1920 | 502.0M params
  [Eval 72] Loss: 1.2871
  [Eval 69] GPU 4 | expansion=2, depth=21, n_heads=26 | dim=1664 | 465.7M params
  [Eval 69] Loss: 1.4139
  [Eval 66] GPU 1 | expansion=2, depth=16, n_heads=23 | dim=1920 | 472.5M params
  [Eval 66] Loss: 1.3717
  [Eval 70] GPU 5 | expansion=2, depth=19, n_heads=28 | dim=1792 | 488.7M params
  [Eval 70] Loss: 1.2863
  [Eval 65] GPU 0 | expansion=2, depth=19, n_heads=27 | dim=1792 | 488.7M params
  [Eval 65] Loss: 1.2954
  [Eval 71] GPU 6 | expansion=1, depth=20, n_heads=29 | dim=2432 | 473.9M params
  [Eval 71] Loss: 1.4511
    9     72 1.286328000000000e+00 2.4e+00 1.62e-01  1e-01  2e-01 92:26.1

--- Generation 10/15 ---
  [Eval 77] Skip - params 510.2M vs target 480M
  [Eval 78] GPU 5 | expansion=2, depth=17, n_heads=26 | dim=1920 | 502.0M params
  [Eval 78] Loss: 1.2854
  [Eval 76] GPU 3 | expansion=2, depth=18, n_heads=19 | dim=1792 | 463.0M params
  [Eval 76] Loss: 1.3929
  [Eval 79] GPU 6 | expansion=2, depth=18, n_heads=27 | dim=1792 | 463.0M params
  [Eval 79] Loss: 1.4076
  [Eval 75] GPU 2 | expansion=2, depth=26, n_heads=32 | dim=1536 | 491.3M params
  [Eval 75] Loss: 1.3207
  [Eval 73] Skip - params 510.1M vs target 480M
  [Eval 80] GPU 7 | expansion=2, depth=18, n_heads=25 | dim=1792 | 463.0M params
  [Eval 80] Loss: 1.3962
  [Eval 74] GPU 1 | expansion=2, depth=21, n_heads=29 | dim=1664 | 465.7M params
  [Eval 74] Loss: 1.3933
   10     80 1.285365000000000e+00 2.6e+00 1.68e-01  1e-01  2e-01 102:41.3

--- Generation 11/15 ---
  [Eval 85] Skip - params 444.6M vs target 480M
  [Eval 86] GPU 5 | expansion=2, depth=16, n_heads=28 | dim=1920 | 472.5M params
  [Eval 86] Loss: 1.3783
  [Eval 87] Skip - params 444.6M vs target 480M
  [Eval 83] GPU 2 | expansion=2, depth=16, n_heads=29 | dim=1920 | 472.5M params
  [Eval 83] Loss: 1.3896
  [Eval 82] GPU 1 | expansion=2, depth=24, n_heads=31 | dim=1536 | 453.5M params
  [Eval 82] Loss: 1.4055
  [Eval 84] GPU 3 | expansion=2, depth=17, n_heads=25 | dim=1920 | 502.0M params
  [Eval 84] Loss: 1.2772
  [Eval 81] GPU 0 | expansion=2, depth=26, n_heads=31 | dim=1536 | 491.3M params
  [Eval 81] Loss: 1.3207
  [Eval 88] GPU 7 | expansion=2, depth=19, n_heads=28 | dim=1792 | 488.7M params
  [Eval 88] Loss: 1.2871
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     88 1.277166000000000e+00 2.6e+00 1.40e-01  9e-02  1e-01 112:57.4

--- Generation 12/15 ---
  [Eval 90] Skip - params 510.1M vs target 480M
  [Eval 94] Skip - params 514.4M vs target 480M
  [Eval 93] GPU 4 | expansion=2, depth=16, n_heads=28 | dim=1920 | 472.5M params
  [Eval 93] Loss: 1.3842
  [Eval 96] GPU 7 | expansion=2, depth=19, n_heads=25 | dim=1792 | 488.7M params
  [Eval 96] Loss: 1.2859
  [Eval 91] GPU 2 | expansion=2, depth=24, n_heads=28 | dim=1536 | 453.5M params
  [Eval 91] Loss: 1.4065
  [Eval 89] GPU 0 | expansion=2, depth=19, n_heads=21 | dim=1792 | 488.7M params
  [Eval 89] Loss: 1.2954
  [Eval 95] GPU 6 | expansion=2, depth=18, n_heads=30 | dim=1792 | 463.0M params
  [Eval 95] Loss: 1.4053
  [Eval 92] GPU 3 | expansion=2, depth=18, n_heads=28 | dim=1792 | 463.0M params
  [Eval 92] Loss: 1.3953
   12     96 1.285906000000000e+00 2.2e+00 1.38e-01  9e-02  1e-01 123:13.0

--- Generation 13/15 ---
  [Eval 101] GPU 4 | expansion=2, depth=17, n_heads=28 | dim=1920 | 502.0M params
  [Eval 101] Loss: 1.2846
  [Eval 100] GPU 3 | expansion=2, depth=16, n_heads=24 | dim=1920 | 472.5M params
  [Eval 100] Loss: 1.3822
  [Eval 102] GPU 5 | expansion=2, depth=18, n_heads=30 | dim=1792 | 463.0M params
  [Eval 102] Loss: 1.3962
  [Eval 103] GPU 6 | expansion=2, depth=19, n_heads=28 | dim=1792 | 488.7M params
  [Eval 103] Loss: 1.2952
  [Eval 99] GPU 2 | expansion=2, depth=19, n_heads=28 | dim=1792 | 488.7M params
  [Eval 99] Loss: 1.2947
  [Eval 98] GPU 1 | expansion=1, depth=16, n_heads=22 | dim=2688 | 463.2M params
  [Eval 98] Loss: 1.3914
  [Eval 104] GPU 7 | expansion=1, depth=16, n_heads=25 | dim=2688 | 463.2M params
  [Eval 104] Loss: 1.4037
  [Eval 97] GPU 0 | expansion=1, depth=17, n_heads=28 | dim=2688 | 492.1M params
  [Eval 97] Loss: 1.3346
   13    104 1.284639000000000e+00 2.3e+00 1.33e-01  7e-02  1e-01 133:30.3

--- Generation 14/15 ---
  [Eval 106] Skip - params 514.4M vs target 480M
  [Eval 105] GPU 0 | expansion=2, depth=22, n_heads=19 | dim=1664 | 487.9M params
  [Eval 105] Loss: 1.2888
  [Eval 109] GPU 4 | expansion=2, depth=17, n_heads=21 | dim=1920 | 502.0M params
  [Eval 109] Loss: 1.2777
  [Eval 107] Skip - params 510.1M vs target 480M
  [Eval 112] GPU 7 | expansion=2, depth=18, n_heads=25 | dim=1792 | 463.0M params
  [Eval 112] Loss: 1.4009
  [Eval 111] GPU 6 | expansion=2, depth=16, n_heads=26 | dim=1920 | 472.5M params
  [Eval 111] Loss: 1.3923
  [Eval 108] GPU 3 | expansion=2, depth=26, n_heads=31 | dim=1536 | 491.3M params
  [Eval 108] Loss: 1.3111
  [Eval 110] GPU 5 | expansion=1, depth=21, n_heads=32 | dim=2432 | 497.6M params
  [Eval 110] Loss: 1.3370
   14    112 1.277695000000000e+00 2.5e+00 1.50e-01  7e-02  2e-01 143:47.7

--- Generation 15/15 ---
  [Eval 117] GPU 4 | expansion=2, depth=16, n_heads=22 | dim=1920 | 472.5M params
  [Eval 117] Loss: 1.3864
  [Eval 115] GPU 2 | expansion=2, depth=16, n_heads=23 | dim=1920 | 472.5M params
  [Eval 115] Loss: 1.3872
  [Eval 114] GPU 1 | expansion=2, depth=17, n_heads=19 | dim=1920 | 502.0M params
  [Eval 114] Loss: 1.2754
  [Eval 120] GPU 7 | expansion=2, depth=19, n_heads=21 | dim=1792 | 488.7M params
  [Eval 120] Loss: 1.2870
  [Eval 118] GPU 5 | expansion=2, depth=19, n_heads=15 | dim=1792 | 488.7M params
  [Eval 118] Loss: 1.2878
  [Eval 113] GPU 0 | expansion=2, depth=16, n_heads=23 | dim=1920 | 472.5M params
  [Eval 113] Loss: 1.3879
  [Eval 119] GPU 6 | expansion=2, depth=17, n_heads=29 | dim=1920 | 502.0M params
  [Eval 119] Loss: 1.2871
  [Eval 116] GPU 3 | expansion=2, depth=17, n_heads=24 | dim=1920 | 502.0M params
  [Eval 116] Loss: 1.2727
  *** NEW BEST: 1.2754 | {'expansion': 2, 'depth': 17, 'n_heads': 19} | dim=1920 ***
  *** NEW BEST: 1.2727 | {'expansion': 2, 'depth': 17, 'n_heads': 24} | dim=1920 ***
   15    120 1.272655000000000e+00 3.5e+00 1.39e-01  6e-02  2e-01 154:04.5

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.2727
Best params: {'expansion': 2, 'depth': 17, 'n_heads': 24}
Total evaluations: 120

To train with best config:
python train.py --level fla-gdn --dim 1920 --depth 17 --expansion 2 --n_heads 24 --lr 3e-4 --train_minutes 30
