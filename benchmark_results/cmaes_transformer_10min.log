/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'n_heads': 16, 'expansion': 4, 'depth': 24}
Encoded x0: ['0.333', '0.500', '0.500']
======================================================================
CMA-ES Search for TRANSFORMER
======================================================================
Search space (3 dimensions):
  n_heads: [8, 32] (int) - Number of attention heads
  expansion: [2, 6] (int) - FFN expansion factor
  depth: [12, 36] (int) - Number of layers
Target params: 480M Â± 30M
Training time per config: 10.0 min
Generations: 15
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~120
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 3 (seed=471916, Mon Jan 26 17:13:17 2026)

--- Generation 1/15 ---
  [Eval 2] Skip - params 438.6M vs target 480M
  [Eval 3] Skip - params 431.7M vs target 480M
  [Eval 5] Skip - params 515.9M vs target 480M
  [Eval 4] GPU 3 | n_heads=11, expansion=4, depth=27 | dim=1024 | 453.3M params
  [Eval 4] Loss: 1.8000
  [Eval 8] Skip - params 436.5M vs target 480M
  [Eval 1] GPU 0 | n_heads=12, expansion=5, depth=24 | dim=1024 | 478.5M params
  [Eval 1] Loss: 1.7909
  [Eval 6] GPU 5 | n_heads=21, expansion=3, depth=22 | dim=1280 | 469.0M params
  [Eval 6] Loss: 1.9288
  [Eval 7] GPU 6 | n_heads=15, expansion=4, depth=24 | dim=1152 | 510.0M params
  [Eval 7] Loss: 1.6358
  *** NEW BEST: 1.7909 | {'n_heads': 12, 'expansion': 5, 'depth': 24} | dim=1024 ***
  *** NEW BEST: 1.6358 | {'n_heads': 15, 'expansion': 4, 'depth': 24} | dim=1152 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 1.635768000000000e+00 1.0e+00 1.50e-01  1e-01  2e-01 10:17.4

--- Generation 2/15 ---
  [Eval 9] Skip - params 518.9M vs target 480M
  [Eval 14] Skip - params 518.3M vs target 480M
  [Eval 11] Skip - params 436.5M vs target 480M
  [Eval 12] Skip - params 515.9M vs target 480M
  [Eval 16] Skip - params 538.2M vs target 480M
  [Eval 15] GPU 6 | n_heads=16, expansion=4, depth=28 | dim=1024 | 470.1M params
  [Eval 15] Loss: 1.8861
  [Eval 13] GPU 4 | n_heads=19, expansion=5, depth=25 | dim=1024 | 498.4M params
  [Eval 13] Loss: 1.6839
  [Eval 10] GPU 1 | n_heads=13, expansion=4, depth=22 | dim=1152 | 467.5M params
  [Eval 10] Loss: 1.7737
    2     16 1.683876000000000e+00 1.3e+00 1.55e-01  1e-01  2e-01 20:32.2

--- Generation 3/15 ---
  [Eval 20] Skip - params 438.6M vs target 480M
  [Eval 24] GPU 7 | n_heads=16, expansion=5, depth=23 | dim=1024 | 458.5M params
  [Eval 24] Loss: 1.8330
  [Eval 23] Skip - params 436.5M vs target 480M
  [Eval 19] GPU 2 | n_heads=17, expansion=5, depth=20 | dim=1152 | 504.6M params
  [Eval 19] Loss: 1.6206
  [Eval 17] GPU 0 | n_heads=18, expansion=5, depth=23 | dim=1024 | 458.5M params
  [Eval 17] Loss: 1.8403
  [Eval 22] GPU 5 | n_heads=13, expansion=5, depth=31 | dim=896 | 473.1M params
  [Eval 22] Loss: 1.8946
  [Eval 18] GPU 1 | n_heads=20, expansion=5, depth=24 | dim=1024 | 478.5M params
  [Eval 18] Loss: 1.8843
  [Eval 21] GPU 4 | n_heads=17, expansion=5, depth=24 | dim=1024 | 478.5M params
  [Eval 21] Loss: 1.8536
  *** NEW BEST: 1.6206 | {'n_heads': 17, 'expansion': 5, 'depth': 20} | dim=1152 ***
    3     24 1.620583000000000e+00 1.2e+00 1.57e-01  1e-01  2e-01 30:48.0

--- Generation 4/15 ---
  [Eval 26] Skip - params 530.9M vs target 480M
  [Eval 32] Skip - params 438.6M vs target 480M
  [Eval 27] GPU 2 | n_heads=15, expansion=6, depth=22 | dim=1024 | 507.8M params
  [Eval 27] Loss: 1.6387
  [Eval 29] GPU 4 | n_heads=14, expansion=5, depth=18 | dim=1152 | 454.2M params
  [Eval 29] Loss: 1.7177
  [Eval 31] GPU 6 | n_heads=17, expansion=5, depth=23 | dim=1024 | 458.5M params
  [Eval 31] Loss: 1.8272
  [Eval 25] GPU 0 | n_heads=22, expansion=5, depth=23 | dim=1024 | 458.5M params
  [Eval 25] Loss: 1.9177
  [Eval 28] GPU 3 | n_heads=15, expansion=4, depth=24 | dim=1152 | 510.0M params
  [Eval 28] Loss: 1.6247
  [Eval 30] GPU 5 | n_heads=19, expansion=5, depth=20 | dim=1152 | 504.6M params
  [Eval 30] Loss: 1.6263
    4     32 1.624731000000000e+00 1.2e+00 1.24e-01  1e-01  1e-01 41:03.4

--- Generation 5/15 ---
  [Eval 33] Skip - params 529.9M vs target 480M
  [Eval 38] Skip - params 529.9M vs target 480M
  [Eval 36] Skip - params 531.2M vs target 480M
  [Eval 40] GPU 7 | n_heads=18, expansion=6, depth=26 | dim=896 | 459.5M params
  [Eval 40] Loss: 1.9096
  [Eval 35] GPU 2 | n_heads=14, expansion=5, depth=15 | dim=1280 | 467.3M params
  [Eval 35] Loss: 1.6915
  [Eval 39] GPU 6 | n_heads=15, expansion=5, depth=23 | dim=1024 | 458.5M params
  [Eval 39] Loss: 1.8310
  [Eval 34] GPU 1 | n_heads=16, expansion=5, depth=24 | dim=1024 | 478.5M params
  [Eval 34] Loss: 1.8369
  [Eval 37] GPU 4 | n_heads=15, expansion=5, depth=19 | dim=1152 | 479.4M params
  [Eval 37] Loss: 1.7565
    5     40 1.691520000000000e+00 1.3e+00 1.57e-01  1e-01  2e-01 51:17.9

--- Generation 6/15 ---
  [Eval 42] Skip - params 438.3M vs target 480M
  [Eval 48] Skip - params 446.3M vs target 480M
  [Eval 43] Skip - params 529.6M vs target 480M
  [Eval 41] GPU 0 | n_heads=10, expansion=5, depth=12 | dim=1408 | 452.4M params
  [Eval 41] Loss: 1.5881
  [Eval 47] GPU 6 | n_heads=15, expansion=5, depth=18 | dim=1152 | 454.2M params
  [Eval 47] Loss: 1.7309
  [Eval 46] GPU 5 | n_heads=17, expansion=4, depth=13 | dim=1536 | 491.2M params
  [Eval 46] Loss: 1.5385
  [Eval 44] GPU 3 | n_heads=13, expansion=4, depth=15 | dim=1408 | 476.2M params
  [Eval 44] Loss: 1.6742
  [Eval 45] GPU 4 | n_heads=14, expansion=5, depth=24 | dim=1024 | 478.5M params
  [Eval 45] Loss: 1.8416
  *** NEW BEST: 1.5881 | {'n_heads': 10, 'expansion': 5, 'depth': 12} | dim=1408 ***
  *** NEW BEST: 1.5385 | {'n_heads': 17, 'expansion': 4, 'depth': 13} | dim=1536 ***
    6     48 1.538502000000000e+00 1.6e+00 2.32e-01  2e-01  3e-01 61:33.0

--- Generation 7/15 ---
  [Eval 50] Skip - params 529.9M vs target 480M
  [Eval 55] GPU 6 | n_heads=8, expansion=4, depth=13 | dim=1536 | 491.2M params
  [Eval 55] Loss: 1.5054
  [Eval 54] GPU 5 | n_heads=8, expansion=5, depth=12 | dim=1408 | 452.4M params
  [Eval 54] Loss: 1.5726
  [Eval 51] GPU 2 | n_heads=13, expansion=5, depth=19 | dim=1152 | 479.4M params
  [Eval 51] Loss: 1.7277
  [Eval 56] GPU 7 | n_heads=9, expansion=4, depth=12 | dim=1536 | 453.4M params
  [Eval 56] Loss: 1.6006
  [Eval 53] GPU 4 | n_heads=10, expansion=4, depth=19 | dim=1280 | 498.4M params
  [Eval 53] Loss: 1.5544
  [Eval 52] GPU 3 | n_heads=18, expansion=4, depth=12 | dim=1536 | 453.4M params
  [Eval 52] Loss: 1.6498
  [Eval 49] GPU 0 | n_heads=8, expansion=4, depth=24 | dim=1152 | 510.0M params
  [Eval 49] Loss: 1.6088
  *** NEW BEST: 1.5054 | {'n_heads': 8, 'expansion': 4, 'depth': 13} | dim=1536 ***
    7     56 1.505436000000000e+00 1.8e+00 3.50e-01  3e-01  3e-01 71:48.6

--- Generation 8/15 ---
  [Eval 58] Skip - params 447.7M vs target 480M
  [Eval 60] Skip - params 436.5M vs target 480M
  [Eval 59] Skip - params 431.7M vs target 480M
  [Eval 63] Skip - params 427.4M vs target 480M
  [Eval 57] GPU 0 | n_heads=11, expansion=3, depth=18 | dim=1408 | 464.3M params
  [Eval 57] Loss: 1.7251
  [Eval 64] GPU 7 | n_heads=12, expansion=5, depth=12 | dim=1408 | 452.4M params
  [Eval 64] Loss: 1.5929
  [Eval 62] GPU 5 | n_heads=16, expansion=3, depth=19 | dim=1408 | 490.1M params
  [Eval 62] Loss: 1.5778
  [Eval 61] GPU 4 | n_heads=13, expansion=3, depth=27 | dim=1152 | 466.2M params
  [Eval 61] Loss: 1.8492
    8     64 1.577782000000000e+00 1.7e+00 4.13e-01  3e-01  3e-01 82:04.7

--- Generation 9/15 ---
  [Eval 65] Skip - params 519.5M vs target 480M
  [Eval 67] GPU 2 | n_heads=10, expansion=6, depth=20 | dim=1024 | 461.7M params
  [Eval 67] Loss: 1.7099
  [Eval 66] GPU 1 | n_heads=13, expansion=4, depth=12 | dim=1536 | 453.4M params
  [Eval 66] Loss: 1.6177
  [Eval 72] GPU 7 | n_heads=9, expansion=4, depth=23 | dim=1152 | 488.7M params
  [Eval 72] Loss: 1.5925
  [Eval 71] GPU 6 | n_heads=16, expansion=3, depth=13 | dim=1664 | 468.4M params
  [Eval 71] Loss: 1.7102
  [Eval 69] GPU 4 | n_heads=24, expansion=5, depth=15 | dim=1280 | 467.3M params
  [Eval 69] Loss: 1.7804
  [Eval 70] GPU 5 | n_heads=16, expansion=3, depth=12 | dim=1792 | 501.5M params
  [Eval 70] Loss: 1.5400
  [Eval 68] GPU 3 | n_heads=24, expansion=3, depth=16 | dim=1536 | 491.2M params
  [Eval 68] Loss: 1.5741
    9     72 1.539953000000000e+00 1.8e+00 5.21e-01  3e-01  3e-01 92:22.1

--- Generation 10/15 ---
  [Eval 73] GPU 0 | n_heads=17, expansion=5, depth=18 | dim=1152 | 454.2M params
  [Eval 73] Loss: 1.7623
  [Eval 77] GPU 4 | n_heads=22, expansion=6, depth=17 | dim=1152 | 496.7M params
  [Eval 77] Loss: 1.6200
  [Eval 80] GPU 7 | n_heads=22, expansion=4, depth=12 | dim=1536 | 453.4M params
  [Eval 80] Loss: 1.6890
  [Eval 74] GPU 1 | n_heads=18, expansion=4, depth=23 | dim=1152 | 488.7M params
  [Eval 74] Loss: 1.6411
  [Eval 79] GPU 6 | n_heads=28, expansion=4, depth=13 | dim=1536 | 491.2M params
  [Eval 79] Loss: 1.5724
  [Eval 78] GPU 5 | n_heads=12, expansion=3, depth=19 | dim=1408 | 490.1M params
  [Eval 78] Loss: 1.5738
  [Eval 75] GPU 2 | n_heads=16, expansion=2, depth=17 | dim=1664 | 471.2M params
  [Eval 75] Loss: 1.8144
  [Eval 76] GPU 3 | n_heads=22, expansion=2, depth=14 | dim=1792 | 450.1M params
  [Eval 76] Loss: 1.7984
   10     80 1.572402000000000e+00 2.0e+00 6.03e-01  3e-01  3e-01 102:41.0

--- Generation 11/15 ---
  [Eval 82] Skip - params 514.3M vs target 480M
  [Eval 83] Skip - params 446.0M vs target 480M
  [Eval 85] GPU 4 | n_heads=8, expansion=3, depth=18 | dim=1408 | 464.3M params
  [Eval 85] Loss: 1.6758
  [Eval 86] GPU 5 | n_heads=20, expansion=4, depth=12 | dim=1536 | 453.4M params
  [Eval 86] Loss: 1.6702
  [Eval 88] GPU 7 | n_heads=13, expansion=3, depth=19 | dim=1408 | 490.1M params
  [Eval 88] Loss: 1.5873
  [Eval 87] GPU 6 | n_heads=31, expansion=3, depth=12 | dim=1792 | 501.5M params
  [Eval 87] Loss: 1.5892
  [Eval 84] GPU 3 | n_heads=23, expansion=3, depth=12 | dim=1792 | 501.5M params
  [Eval 84] Loss: 1.5356
  [Eval 81] GPU 0 | n_heads=16, expansion=2, depth=14 | dim=1792 | 450.1M params
  [Eval 81] Loss: 1.7569
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     88 1.535624000000000e+00 2.2e+00 5.91e-01  3e-01  3e-01 112:59.7

--- Generation 12/15 ---
  [Eval 92] Skip - params 436.5M vs target 480M
  [Eval 91] Skip - params 448.9M vs target 480M
  [Eval 94] Skip - params 514.3M vs target 480M
  [Eval 93] GPU 4 | n_heads=26, expansion=5, depth=20 | dim=1152 | 504.6M params
  [Eval 93] Loss: 1.6731
  [Eval 89] GPU 0 | n_heads=26, expansion=3, depth=16 | dim=1536 | 491.2M params
  [Eval 89] Loss: 1.6267
  [Eval 90] GPU 1 | n_heads=28, expansion=2, depth=12 | dim=2048 | 503.9M params
  [Eval 90] Loss: 1.5684
  [Eval 96] GPU 7 | n_heads=21, expansion=2, depth=18 | dim=1664 | 498.9M params
  [Eval 96] Loss: 1.6148
  [Eval 95] GPU 6 | n_heads=24, expansion=2, depth=13 | dim=1920 | 479.8M params
  [Eval 95] Loss: 1.8639
   12     96 1.568394000000000e+00 2.2e+00 5.65e-01  2e-01  3e-01 123:19.4

--- Generation 13/15 ---
  [Eval 102] Skip - params 519.5M vs target 480M
  [Eval 98] GPU 1 | n_heads=12, expansion=5, depth=20 | dim=1152 | 504.6M params
  [Eval 98] Loss: 1.5760
  [Eval 100] GPU 3 | n_heads=32, expansion=3, depth=15 | dim=1536 | 460.5M params
  [Eval 100] Loss: 1.9345
  [Eval 97] GPU 0 | n_heads=26, expansion=3, depth=16 | dim=1536 | 491.2M params
  [Eval 97] Loss: 1.6267
  [Eval 99] GPU 2 | n_heads=27, expansion=2, depth=13 | dim=1920 | 479.8M params
  [Eval 99] Loss: 1.9299
  [Eval 101] GPU 4 | n_heads=18, expansion=2, depth=14 | dim=1792 | 450.1M params
  [Eval 101] Loss: 1.7698
  [Eval 103] GPU 6 | n_heads=32, expansion=2, depth=18 | dim=1664 | 498.9M params
  [Eval 103] Loss: 1.6813
  [Eval 104] GPU 7 | n_heads=31, expansion=2, depth=13 | dim=1920 | 479.8M params
  [Eval 104] Loss: 1.9779
   13    104 1.575969000000000e+00 2.1e+00 6.05e-01  2e-01  3e-01 133:40.8

--- Generation 14/15 ---
  [Eval 106] GPU 1 | n_heads=24, expansion=4, depth=15 | dim=1408 | 476.2M params
  [Eval 106] Loss: 1.7442
  [Eval 108] GPU 3 | n_heads=21, expansion=4, depth=18 | dim=1280 | 472.2M params
  [Eval 108] Loss: 1.7972
  [Eval 109] GPU 4 | n_heads=9, expansion=4, depth=22 | dim=1152 | 467.5M params
  [Eval 109] Loss: 1.7174
  [Eval 111] GPU 6 | n_heads=10, expansion=4, depth=19 | dim=1280 | 498.4M params
  [Eval 111] Loss: 1.5562
  [Eval 107] GPU 2 | n_heads=28, expansion=2, depth=17 | dim=1664 | 471.2M params
  [Eval 107] Loss: 2.1519
  [Eval 110] GPU 5 | n_heads=29, expansion=3, depth=19 | dim=1408 | 490.1M params
  [Eval 110] Loss: 1.6515
  [Eval 105] Skip - params 511.6M vs target 480M
  [Eval 112] GPU 7 | n_heads=25, expansion=3, depth=13 | dim=1664 | 468.4M params
  [Eval 112] Loss: 1.7578
   14    112 1.556170000000000e+00 2.2e+00 6.04e-01  2e-01  3e-01 144:00.0

--- Generation 15/15 ---
  [Eval 116] Skip - params 444.5M vs target 480M
  [Eval 114] Skip - params 511.6M vs target 480M
  [Eval 115] Skip - params 427.4M vs target 480M
  [Eval 119] Skip - params 515.9M vs target 480M
  [Eval 117] Skip - params 530.9M vs target 480M
  [Eval 120] GPU 7 | n_heads=29, expansion=3, depth=18 | dim=1408 | 464.3M params
  [Eval 120] Loss: 1.9894
  [Eval 113] GPU 0 | n_heads=23, expansion=3, depth=16 | dim=1536 | 491.2M params
  [Eval 113] Loss: 1.5705
  [Eval 118] GPU 5 | n_heads=16, expansion=4, depth=12 | dim=1536 | 453.4M params
  [Eval 118] Loss: 1.6637
   15    120 1.570469000000000e+00 2.6e+00 4.99e-01  2e-01  3e-01 154:19.0

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.5054
Best params: {'n_heads': 8, 'expansion': 4, 'depth': 13}
Total evaluations: 120

To train with best config:
python train.py --level llama --dim 1536 --depth 13 --n_heads 8 --expansion 4 --lr 3e-4 --train_minutes 30
