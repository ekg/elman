Loading data from data/fineweb_100mb.txt...

Creating mamba2 model with ~50m parameters...
Created Mamba2 model: dim=672, depth=18, expand=2, params=50,928,750

============================================================
Training: mamba2 (timeout=120.0s)
Parameters: 50.93M
============================================================
[mamba2] step    1 | loss 5.7500 | ppl 314.2 | grad 3.94 | 10732 tok/s | 16.7s | 16695ms/step
[mamba2] step   10 | loss 5.5000 | ppl 244.7 | grad 3.84 | 58906 tok/s | 30.4s | 1534ms/step
[mamba2] step   20 | loss 3.5469 | ppl 34.7 | grad 3.55 | 78028 tok/s | 45.9s | 1559ms/step
[mamba2] step   30 | loss 2.7344 | ppl 15.4 | grad 1.33 | 87227 tok/s | 61.6s | 1574ms/step
[mamba2] step   40 | loss 2.3125 | ppl 10.1 | grad 1.05 | 92439 tok/s | 77.5s | 1593ms/step
[mamba2] step   50 | loss 2.0156 | ppl 7.5 | grad 0.91 | 95707 tok/s | 93.6s | 1611ms/step
[mamba2] step   60 | loss 1.8828 | ppl 6.6 | grad 1.58 | 97916 tok/s | 109.8s | 1621ms/step
[mamba2] Timeout reached at 120.3s

mamba2 Final: loss=3.3917, grad=2.31, steps=68, tokens=12,006,400, time=120.3s

==========================================================================================
BENCHMARK SUMMARY
==========================================================================================
Model           Params       Loss       Steps    Tokens       tok/s      Time    
------------------------------------------------------------------------------------------
mamba2          50.93M       3.3917     68       12,006,400   99806      120.3   s

Results saved to: benchmark_results
