Using device: cuda
Output directory: benchmark_results/cmaes_transformer_10min/transformer_480M_15gen_20260126_171317/eval_118/levelllama_100m_20260126_193724
Auto r_h_mode: none (level 0 has bounded/no W_h)
Model: Level llama, 302,439,936 parameters
Using schedule-free AdamW (lr=0.0003)

Starting training from step 0...
Batch size: 16, Chunk size: 512
Gradient accumulation: 1, Effective batch: 16

Time-based training: 10.0 minutes
step     10 | loss 6.3555 | lr 3.00e-04 | grad 5.12 | tok/s 11364
step     20 | loss 2.8750 | lr 3.00e-04 | grad 2.42 | tok/s 28220
step     30 | loss 3.2796 | lr 3.00e-04 | grad 2.52 | tok/s 29899
step     40 | loss 5.4427 | lr 3.00e-04 | grad 7.44 | tok/s 30499
step     50 | loss 4.3834 | lr 3.00e-04 | grad 4.97 | tok/s 30861
step     60 | loss 3.6576 | lr 3.00e-04 | grad 3.02 | tok/s 30864
step     70 | loss 3.1576 | lr 3.00e-04 | grad 3.72 | tok/s 30678
step     80 | loss 2.8495 | lr 3.00e-04 | grad 2.30 | tok/s 30601
step     90 | loss 2.6364 | lr 3.00e-04 | grad 2.12 | tok/s 30455
step    100 | loss 2.4688 | lr 3.00e-04 | grad 3.59 | tok/s 30364
step    110 | loss 2.6033 | lr 3.00e-04 | grad 2.45 | tok/s 30094
step    120 | loss 3.4131 | lr 3.00e-04 | grad 2.23 | tok/s 28682
step    130 | loss 2.6438 | lr 3.00e-04 | grad 2.59 | tok/s 29282
step    140 | loss 2.9442 | lr 3.00e-04 | grad 5.38 | tok/s 29314
step    150 | loss 2.6996 | lr 3.00e-04 | grad 4.47 | tok/s 30060
step    160 | loss 2.7694 | lr 3.00e-04 | grad 1.52 | tok/s 28996
step    170 | loss 2.7091 | lr 3.00e-04 | grad 1.55 | tok/s 28427
step    180 | loss 2.8432 | lr 3.00e-04 | grad 1.82 | tok/s 29155
step    190 | loss 2.4587 | lr 3.00e-04 | grad 2.28 | tok/s 28535
step    200 | loss 2.3966 | lr 3.00e-04 | grad 1.63 | tok/s 29812
step    210 | loss 2.4113 | lr 3.00e-04 | grad 3.41 | tok/s 28325
step    220 | loss 2.6764 | lr 3.00e-04 | grad 4.31 | tok/s 28547
step    230 | loss 2.5495 | lr 3.00e-04 | grad 2.14 | tok/s 28490
step    240 | loss 2.7668 | lr 3.00e-04 | grad 2.45 | tok/s 28843
step    250 | loss 2.3194 | lr 3.00e-04 | grad 2.48 | tok/s 28698
step    260 | loss 2.4556 | lr 3.00e-04 | grad 1.83 | tok/s 29542
step    270 | loss 2.3110 | lr 3.00e-04 | grad 2.09 | tok/s 28820
step    280 | loss 2.2507 | lr 3.00e-04 | grad 0.89 | tok/s 27041
step    290 | loss 2.1868 | lr 3.00e-04 | grad 2.11 | tok/s 27984
step    300 | loss 2.4419 | lr 3.00e-04 | grad 1.80 | tok/s 28209
step    310 | loss 2.1376 | lr 3.00e-04 | grad 1.73 | tok/s 28026
step    320 | loss 2.3852 | lr 3.00e-04 | grad 2.97 | tok/s 28341
step    330 | loss 2.1948 | lr 3.00e-04 | grad 1.94 | tok/s 28718
step    340 | loss 2.4776 | lr 3.00e-04 | grad 1.60 | tok/s 28569
step    350 | loss 2.4256 | lr 3.00e-04 | grad 1.49 | tok/s 29329
step    360 | loss 2.0936 | lr 3.00e-04 | grad 1.55 | tok/s 28128
step    370 | loss 2.1443 | lr 3.00e-04 | grad 1.49 | tok/s 29652
step    380 | loss 1.9471 | lr 3.00e-04 | grad 1.91 | tok/s 29891
step    390 | loss 1.8663 | lr 3.00e-04 | grad 1.32 | tok/s 29862
step    400 | loss 2.2447 | lr 3.00e-04 | grad 1.15 | tok/s 28281
step    410 | loss 2.1525 | lr 3.00e-04 | grad 1.23 | tok/s 28636
step    420 | loss 2.2839 | lr 3.00e-04 | grad 2.06 | tok/s 29884
step    430 | loss 2.1162 | lr 3.00e-04 | grad 2.06 | tok/s 29359
step    440 | loss 2.1402 | lr 3.00e-04 | grad 1.73 | tok/s 28461
step    450 | loss 2.0371 | lr 3.00e-04 | grad 1.57 | tok/s 28825
step    460 | loss 2.0979 | lr 3.00e-04 | grad 1.20 | tok/s 29258
step    470 | loss 2.0927 | lr 3.00e-04 | grad 2.02 | tok/s 29029
step    480 | loss 2.1039 | lr 3.00e-04 | grad 2.03 | tok/s 29703
step    490 | loss 2.0736 | lr 3.00e-04 | grad 1.98 | tok/s 28509
step    500 | loss 2.2170 | lr 3.00e-04 | grad 1.31 | tok/s 28940
step    510 | loss 2.0655 | lr 3.00e-04 | grad 1.20 | tok/s 27581
step    520 | loss 1.9266 | lr 3.00e-04 | grad 1.12 | tok/s 28983
step    530 | loss 2.0733 | lr 3.00e-04 | grad 1.21 | tok/s 28514
step    540 | loss 2.0286 | lr 3.00e-04 | grad 0.89 | tok/s 27957
step    550 | loss 1.7187 | lr 3.00e-04 | grad 2.27 | tok/s 29245
step    560 | loss 1.8911 | lr 3.00e-04 | grad 1.72 | tok/s 30132
step    570 | loss 1.7697 | lr 3.00e-04 | grad 1.46 | tok/s 30131
step    580 | loss 1.7069 | lr 3.00e-04 | grad 1.37 | tok/s 30101
step    590 | loss 1.7571 | lr 3.00e-04 | grad 1.39 | tok/s 30121
step    600 | loss 1.7049 | lr 3.00e-04 | grad 1.55 | tok/s 30059
step    610 | loss 1.6807 | lr 3.00e-04 | grad 1.28 | tok/s 30127
step    620 | loss 1.6561 | lr 3.00e-04 | grad 1.38 | tok/s 30033
step    630 | loss 1.9526 | lr 3.00e-04 | grad 3.55 | tok/s 28391
step    640 | loss 2.0578 | lr 3.00e-04 | grad 1.38 | tok/s 28729
step    650 | loss 1.8779 | lr 3.00e-04 | grad 1.24 | tok/s 28770
step    660 | loss 1.9380 | lr 3.00e-04 | grad 1.34 | tok/s 29868
step    670 | loss 1.9654 | lr 3.00e-04 | grad 2.84 | tok/s 28886
step    680 | loss 1.9578 | lr 3.00e-04 | grad 1.73 | tok/s 28426
step    690 | loss 1.9006 | lr 3.00e-04 | grad 1.25 | tok/s 28185
step    700 | loss 1.8163 | lr 3.00e-04 | grad 1.14 | tok/s 28817
step    710 | loss 1.9574 | lr 3.00e-04 | grad 2.23 | tok/s 28331
step    720 | loss 1.7031 | lr 3.00e-04 | grad 1.54 | tok/s 29486
step    730 | loss 1.7901 | lr 3.00e-04 | grad 1.02 | tok/s 28999
step    740 | loss 2.2141 | lr 3.00e-04 | grad 2.33 | tok/s 29823
step    750 | loss 2.0014 | lr 3.00e-04 | grad 1.70 | tok/s 30165
step    760 | loss 1.8419 | lr 3.00e-04 | grad 2.30 | tok/s 29561
step    770 | loss 1.8507 | lr 3.00e-04 | grad 1.34 | tok/s 29010
step    780 | loss 1.7889 | lr 3.00e-04 | grad 1.48 | tok/s 29237
step    790 | loss 2.0911 | lr 3.00e-04 | grad 3.06 | tok/s 29899
step    800 | loss 1.6652 | lr 3.00e-04 | grad 1.20 | tok/s 29412
step    810 | loss 1.6192 | lr 3.00e-04 | grad 1.97 | tok/s 28458
step    820 | loss 1.7577 | lr 3.00e-04 | grad 1.21 | tok/s 28981
step    830 | loss 1.8047 | lr 3.00e-04 | grad 1.27 | tok/s 28593
step    840 | loss 1.9250 | lr 3.00e-04 | grad 1.25 | tok/s 28431
step    850 | loss 1.8694 | lr 3.00e-04 | grad 1.20 | tok/s 29044
step    860 | loss 1.9267 | lr 3.00e-04 | grad 1.48 | tok/s 29516
step    870 | loss 1.9259 | lr 3.00e-04 | grad 1.46 | tok/s 29786
step    880 | loss 1.8398 | lr 3.00e-04 | grad 1.12 | tok/s 29172
step    890 | loss 1.7278 | lr 3.00e-04 | grad 1.34 | tok/s 29071
step    900 | loss 1.7873 | lr 3.00e-04 | grad 1.03 | tok/s 28919
step    910 | loss 1.8214 | lr 3.00e-04 | grad 3.53 | tok/s 28619
step    920 | loss 1.7329 | lr 3.00e-04 | grad 1.35 | tok/s 28932
step    930 | loss 1.6903 | lr 3.00e-04 | grad 1.40 | tok/s 29251
step    940 | loss 1.6498 | lr 3.00e-04 | grad 1.16 | tok/s 28621
step    950 | loss 1.7471 | lr 3.00e-04 | grad 1.78 | tok/s 28123
step    960 | loss 1.6918 | lr 3.00e-04 | grad 1.26 | tok/s 28924
step    970 | loss 1.6918 | lr 3.00e-04 | grad 1.31 | tok/s 28930
step    980 | loss 2.3751 | lr 3.00e-04 | grad 2.12 | tok/s 30114
step    990 | loss 1.8825 | lr 3.00e-04 | grad 1.34 | tok/s 28855
step   1000 | loss 1.7957 | lr 3.00e-04 | grad 1.52 | tok/s 28903
  >>> saved checkpoint: checkpoint_step_001000_loss_1.7957.pt
step   1010 | loss 1.5368 | lr 3.00e-04 | grad 1.41 | tok/s 16378
step   1020 | loss 1.6085 | lr 3.00e-04 | grad 1.26 | tok/s 30423
step   1030 | loss 1.7755 | lr 3.00e-04 | grad 1.33 | tok/s 28829
step   1040 | loss 2.2758 | lr 3.00e-04 | grad 4.00 | tok/s 29575
step   1050 | loss 1.8593 | lr 3.00e-04 | grad 1.09 | tok/s 29722
step   1060 | loss 1.5108 | lr 3.00e-04 | grad 0.82 | tok/s 29399
step   1070 | loss 1.6145 | lr 3.00e-04 | grad 1.47 | tok/s 29333
step   1080 | loss 1.5048 | lr 3.00e-04 | grad 1.75 | tok/s 30288
step   1090 | loss 1.4768 | lr 3.00e-04 | grad 1.48 | tok/s 30268
step   1100 | loss 1.4553 | lr 3.00e-04 | grad 1.36 | tok/s 30285
step   1110 | loss 1.3913 | lr 3.00e-04 | grad 1.27 | tok/s 30291
step   1120 | loss 1.6207 | lr 3.00e-04 | grad 1.23 | tok/s 29430
step   1130 | loss 2.0226 | lr 3.00e-04 | grad 1.40 | tok/s 29731
step   1140 | loss 2.0219 | lr 3.00e-04 | grad 1.38 | tok/s 30136
step   1150 | loss 2.1463 | lr 3.00e-04 | grad 1.86 | tok/s 29439
step   1160 | loss 1.8945 | lr 3.00e-04 | grad 2.98 | tok/s 28492
step   1170 | loss 1.7490 | lr 3.00e-04 | grad 1.42 | tok/s 28485
step   1180 | loss 1.6408 | lr 3.00e-04 | grad 1.27 | tok/s 29942
step   1190 | loss 1.9277 | lr 3.00e-04 | grad 1.70 | tok/s 30001
step   1200 | loss 1.4570 | lr 3.00e-04 | grad 1.23 | tok/s 30237
step   1210 | loss 1.5488 | lr 3.00e-04 | grad 1.16 | tok/s 28525
step   1220 | loss 1.6203 | lr 3.00e-04 | grad 1.43 | tok/s 29390
step   1230 | loss 1.6617 | lr 3.00e-04 | grad 1.05 | tok/s 29600
step   1240 | loss 1.5200 | lr 3.00e-04 | grad 1.77 | tok/s 29953
step   1250 | loss 1.7623 | lr 3.00e-04 | grad 1.73 | tok/s 29251
step   1260 | loss 1.7935 | lr 3.00e-04 | grad 1.12 | tok/s 30033
step   1270 | loss 1.6154 | lr 3.00e-04 | grad 1.64 | tok/s 29130
step   1280 | loss 1.6212 | lr 3.00e-04 | grad 1.43 | tok/s 29235
step   1290 | loss 1.6151 | lr 3.00e-04 | grad 1.42 | tok/s 28575
step   1300 | loss 1.8402 | lr 3.00e-04 | grad 3.42 | tok/s 28434
step   1310 | loss 1.8315 | lr 3.00e-04 | grad 1.13 | tok/s 29655
step   1320 | loss 1.7104 | lr 3.00e-04 | grad 2.44 | tok/s 29495
step   1330 | loss 1.7363 | lr 3.00e-04 | grad 1.33 | tok/s 29445
step   1340 | loss 1.7996 | lr 3.00e-04 | grad 1.20 | tok/s 28546
step   1350 | loss 1.6860 | lr 3.00e-04 | grad 1.22 | tok/s 29692
step   1360 | loss 1.7256 | lr 3.00e-04 | grad 1.36 | tok/s 27909
step   1370 | loss 1.8252 | lr 3.00e-04 | grad 2.45 | tok/s 29729
step   1380 | loss 1.7077 | lr 3.00e-04 | grad 1.56 | tok/s 28864
step   1390 | loss 1.6549 | lr 3.00e-04 | grad 1.48 | tok/s 29407
step   1400 | loss 1.7531 | lr 3.00e-04 | grad 1.22 | tok/s 28785
step   1410 | loss 1.5637 | lr 3.00e-04 | grad 1.54 | tok/s 28280
step   1420 | loss 1.5293 | lr 3.00e-04 | grad 1.53 | tok/s 30020
step   1430 | loss 1.9801 | lr 3.00e-04 | grad 1.12 | tok/s 28999
step   1440 | loss 1.6866 | lr 3.00e-04 | grad 1.59 | tok/s 29288
step   1450 | loss 1.6694 | lr 3.00e-04 | grad 1.30 | tok/s 29584
step   1460 | loss 1.7620 | lr 3.00e-04 | grad 1.45 | tok/s 28698
step   1470 | loss 1.6026 | lr 3.00e-04 | grad 1.44 | tok/s 28349
step   1480 | loss 1.6050 | lr 3.00e-04 | grad 1.91 | tok/s 29377
step   1490 | loss 1.8247 | lr 3.00e-04 | grad 3.50 | tok/s 29185
step   1500 | loss 1.8373 | lr 3.00e-04 | grad 1.31 | tok/s 29608
step   1510 | loss 1.5223 | lr 3.00e-04 | grad 1.13 | tok/s 29016
step   1520 | loss 1.6648 | lr 3.00e-04 | grad 1.56 | tok/s 28867
step   1530 | loss 1.6010 | lr 3.00e-04 | grad 1.52 | tok/s 29663
step   1540 | loss 1.6906 | lr 3.00e-04 | grad 1.03 | tok/s 29664
step   1550 | loss 1.6790 | lr 3.00e-04 | grad 2.48 | tok/s 29133
step   1560 | loss 1.4239 | lr 3.00e-04 | grad 1.30 | tok/s 30096
step   1570 | loss 1.5457 | lr 3.00e-04 | grad 1.05 | tok/s 29434
step   1580 | loss 1.4620 | lr 3.00e-04 | grad 1.44 | tok/s 29569
step   1590 | loss 1.6529 | lr 3.00e-04 | grad 2.20 | tok/s 28441
step   1600 | loss 1.4365 | lr 3.00e-04 | grad 4.84 | tok/s 30075
step   1610 | loss 2.0856 | lr 3.00e-04 | grad 2.42 | tok/s 29338
step   1620 | loss 2.2553 | lr 3.00e-04 | grad 1.87 | tok/s 30230
step   1630 | loss 2.0126 | lr 3.00e-04 | grad 1.46 | tok/s 30238
step   1640 | loss 1.8446 | lr 3.00e-04 | grad 1.53 | tok/s 30275
step   1650 | loss 1.7564 | lr 3.00e-04 | grad 2.03 | tok/s 30228
step   1660 | loss 1.7035 | lr 3.00e-04 | grad 1.48 | tok/s 30258
step   1670 | loss 1.8056 | lr 3.00e-04 | grad 1.59 | tok/s 29330
step   1680 | loss 1.6117 | lr 3.00e-04 | grad 1.32 | tok/s 29012
step   1690 | loss 1.6393 | lr 3.00e-04 | grad 1.62 | tok/s 28423
step   1700 | loss 1.5102 | lr 3.00e-04 | grad 1.54 | tok/s 29462
step   1710 | loss 1.4685 | lr 3.00e-04 | grad 1.69 | tok/s 29599
step   1720 | loss 1.6269 | lr 3.00e-04 | grad 1.09 | tok/s 28674
step   1730 | loss 1.6756 | lr 3.00e-04 | grad 2.62 | tok/s 29571
step   1740 | loss 1.6060 | lr 3.00e-04 | grad 1.45 | tok/s 29690
step   1750 | loss 1.4738 | lr 3.00e-04 | grad 1.24 | tok/s 29086
step   1760 | loss 1.5833 | lr 3.00e-04 | grad 1.29 | tok/s 28801
step   1770 | loss 1.8621 | lr 3.00e-04 | grad 1.26 | tok/s 29496
step   1780 | loss 1.8973 | lr 3.00e-04 | grad 1.26 | tok/s 27908
step   1790 | loss 1.4895 | lr 3.00e-04 | grad 1.25 | tok/s 28296
step   1800 | loss 1.5090 | lr 3.00e-04 | grad 1.15 | tok/s 29003
step   1810 | loss 1.5925 | lr 3.00e-04 | grad 1.33 | tok/s 29200
step   1820 | loss 1.7023 | lr 3.00e-04 | grad 1.93 | tok/s 28827
step   1830 | loss 1.5485 | lr 3.00e-04 | grad 1.10 | tok/s 28007
step   1840 | loss 1.5918 | lr 3.00e-04 | grad 1.23 | tok/s 28982
step   1850 | loss 1.6277 | lr 3.00e-04 | grad 1.40 | tok/s 28794
step   1860 | loss 1.6000 | lr 3.00e-04 | grad 1.43 | tok/s 28690
step   1870 | loss 1.6014 | lr 3.00e-04 | grad 3.28 | tok/s 29201
step   1880 | loss 1.6554 | lr 3.00e-04 | grad 1.33 | tok/s 29408
step   1890 | loss 1.4506 | lr 3.00e-04 | grad 1.39 | tok/s 30224
step   1900 | loss 1.3883 | lr 3.00e-04 | grad 1.07 | tok/s 30257
step   1910 | loss 1.3636 | lr 3.00e-04 | grad 1.38 | tok/s 30160
step   1920 | loss 1.3437 | lr 3.00e-04 | grad 1.33 | tok/s 30184
step   1930 | loss 1.3769 | lr 3.00e-04 | grad 2.17 | tok/s 30100
step   1940 | loss 1.7168 | lr 3.00e-04 | grad 1.41 | tok/s 28619
step   1950 | loss 1.5879 | lr 3.00e-04 | grad 0.96 | tok/s 28384
step   1960 | loss 1.6983 | lr 3.00e-04 | grad 1.59 | tok/s 28708
step   1970 | loss 1.7315 | lr 3.00e-04 | grad 1.38 | tok/s 29300
step   1980 | loss 1.6104 | lr 3.00e-04 | grad 1.76 | tok/s 28437
step   1990 | loss 1.8053 | lr 3.00e-04 | grad 2.41 | tok/s 29277
step   2000 | loss 1.3511 | lr 3.00e-04 | grad 1.04 | tok/s 30278
  >>> saved checkpoint: checkpoint_step_002000_loss_1.3511.pt
step   2010 | loss 1.5418 | lr 3.00e-04 | grad 1.73 | tok/s 16081
step   2020 | loss 1.5461 | lr 3.00e-04 | grad 1.39 | tok/s 28776
step   2030 | loss 1.8659 | lr 3.00e-04 | grad 7.56 | tok/s 28446
step   2040 | loss 1.6329 | lr 3.00e-04 | grad 1.52 | tok/s 28931
step   2050 | loss 1.5013 | lr 3.00e-04 | grad 1.12 | tok/s 29347
step   2060 | loss 1.7341 | lr 3.00e-04 | grad 2.08 | tok/s 29341
step   2070 | loss 1.4453 | lr 3.00e-04 | grad 1.54 | tok/s 29358
step   2080 | loss 1.4833 | lr 3.00e-04 | grad 1.20 | tok/s 27945
step   2090 | loss 1.5400 | lr 3.00e-04 | grad 2.47 | tok/s 29888
step   2100 | loss 1.9737 | lr 3.00e-04 | grad 1.86 | tok/s 30177
step   2110 | loss 1.6038 | lr 3.00e-04 | grad 1.57 | tok/s 28868
step   2120 | loss 2.3419 | lr 3.00e-04 | grad 2.06 | tok/s 29598
step   2130 | loss 1.5899 | lr 3.00e-04 | grad 1.51 | tok/s 28134
step   2140 | loss 1.7808 | lr 3.00e-04 | grad 1.20 | tok/s 29675
step   2150 | loss 1.8479 | lr 3.00e-04 | grad 1.48 | tok/s 29063
step   2160 | loss 1.6425 | lr 3.00e-04 | grad 1.28 | tok/s 29177

Training complete! Final step: 2164
