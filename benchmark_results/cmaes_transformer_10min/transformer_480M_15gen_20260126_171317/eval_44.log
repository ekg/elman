Using device: cuda
Output directory: benchmark_results/cmaes_transformer_10min/transformer_480M_15gen_20260126_171317/eval_44/levelllama_100m_20260126_180441
Auto r_h_mode: none (level 0 has bounded/no W_h)
Model: Level llama, 314,014,976 parameters
Using schedule-free AdamW (lr=0.0003)

Starting training from step 0...
Batch size: 16, Chunk size: 512
Gradient accumulation: 1, Effective batch: 16

Time-based training: 10.0 minutes
step     10 | loss 6.0231 | lr 3.00e-04 | grad 3.27 | tok/s 11764
step     20 | loss 2.9450 | lr 3.00e-04 | grad 2.23 | tok/s 28961
step     30 | loss 3.2412 | lr 3.00e-04 | grad 2.22 | tok/s 30637
step     40 | loss 5.4774 | lr 3.00e-04 | grad 7.25 | tok/s 31259
step     50 | loss 4.5494 | lr 3.00e-04 | grad 3.72 | tok/s 31628
step     60 | loss 3.7593 | lr 3.00e-04 | grad 3.42 | tok/s 31574
step     70 | loss 3.2500 | lr 3.00e-04 | grad 3.83 | tok/s 31477
step     80 | loss 2.9615 | lr 3.00e-04 | grad 1.84 | tok/s 31381
step     90 | loss 2.7095 | lr 3.00e-04 | grad 1.80 | tok/s 31320
step    100 | loss 2.5143 | lr 3.00e-04 | grad 1.61 | tok/s 31225
step    110 | loss 2.6216 | lr 3.00e-04 | grad 2.72 | tok/s 30958
step    120 | loss 3.4176 | lr 3.00e-04 | grad 1.49 | tok/s 29438
step    130 | loss 2.6249 | lr 3.00e-04 | grad 2.41 | tok/s 30082
step    140 | loss 2.9099 | lr 3.00e-04 | grad 5.97 | tok/s 30116
step    150 | loss 2.7418 | lr 3.00e-04 | grad 5.47 | tok/s 30805
step    160 | loss 2.8271 | lr 3.00e-04 | grad 1.70 | tok/s 29754
step    170 | loss 2.7062 | lr 3.00e-04 | grad 1.12 | tok/s 29220
step    180 | loss 2.8309 | lr 3.00e-04 | grad 1.68 | tok/s 29874
step    190 | loss 2.4607 | lr 3.00e-04 | grad 1.73 | tok/s 29259
step    200 | loss 2.3975 | lr 3.00e-04 | grad 1.18 | tok/s 30543
step    210 | loss 2.4070 | lr 3.00e-04 | grad 3.58 | tok/s 28935
step    220 | loss 2.6799 | lr 3.00e-04 | grad 3.98 | tok/s 29193
step    230 | loss 2.4322 | lr 3.00e-04 | grad 2.83 | tok/s 29096
step    240 | loss 2.7673 | lr 3.00e-04 | grad 2.12 | tok/s 29436
step    250 | loss 2.3147 | lr 3.00e-04 | grad 1.93 | tok/s 29176
step    260 | loss 2.4474 | lr 3.00e-04 | grad 1.96 | tok/s 29936
step    270 | loss 2.3001 | lr 3.00e-04 | grad 1.47 | tok/s 29215
step    280 | loss 2.2327 | lr 3.00e-04 | grad 0.83 | tok/s 27401
step    290 | loss 2.1702 | lr 3.00e-04 | grad 1.78 | tok/s 28363
step    300 | loss 2.4232 | lr 3.00e-04 | grad 1.59 | tok/s 28577
step    310 | loss 2.1160 | lr 3.00e-04 | grad 1.61 | tok/s 28435
step    320 | loss 2.3709 | lr 3.00e-04 | grad 2.73 | tok/s 28724
step    330 | loss 2.1720 | lr 3.00e-04 | grad 1.59 | tok/s 29037
step    340 | loss 2.4713 | lr 3.00e-04 | grad 1.64 | tok/s 28887
step    350 | loss 2.4119 | lr 3.00e-04 | grad 1.26 | tok/s 29697
step    360 | loss 2.0678 | lr 3.00e-04 | grad 1.34 | tok/s 28382
step    370 | loss 2.1210 | lr 3.00e-04 | grad 1.28 | tok/s 29919
step    380 | loss 1.9340 | lr 3.00e-04 | grad 1.85 | tok/s 30163
step    390 | loss 1.8467 | lr 3.00e-04 | grad 1.55 | tok/s 30147
step    400 | loss 2.2310 | lr 3.00e-04 | grad 1.16 | tok/s 28550
step    410 | loss 2.1498 | lr 3.00e-04 | grad 1.27 | tok/s 28814
step    420 | loss 2.2684 | lr 3.00e-04 | grad 2.05 | tok/s 30057
step    430 | loss 2.0948 | lr 3.00e-04 | grad 1.55 | tok/s 29556
step    440 | loss 2.1275 | lr 3.00e-04 | grad 1.37 | tok/s 28613
step    450 | loss 2.0210 | lr 3.00e-04 | grad 1.06 | tok/s 28925
step    460 | loss 2.0860 | lr 3.00e-04 | grad 1.00 | tok/s 29352
step    470 | loss 2.0751 | lr 3.00e-04 | grad 1.91 | tok/s 29110
step    480 | loss 2.1092 | lr 3.00e-04 | grad 1.89 | tok/s 29749
step    490 | loss 2.0567 | lr 3.00e-04 | grad 1.58 | tok/s 28563
step    500 | loss 2.2001 | lr 3.00e-04 | grad 1.23 | tok/s 29023
step    510 | loss 2.0599 | lr 3.00e-04 | grad 1.16 | tok/s 27709
step    520 | loss 1.9160 | lr 3.00e-04 | grad 1.08 | tok/s 29023
step    530 | loss 2.0672 | lr 3.00e-04 | grad 1.12 | tok/s 28556
step    540 | loss 2.0177 | lr 3.00e-04 | grad 0.86 | tok/s 27956
step    550 | loss 1.7078 | lr 3.00e-04 | grad 2.28 | tok/s 29219
step    560 | loss 1.8818 | lr 3.00e-04 | grad 1.21 | tok/s 30024
step    570 | loss 1.7722 | lr 3.00e-04 | grad 1.51 | tok/s 30059
step    580 | loss 1.7062 | lr 3.00e-04 | grad 1.07 | tok/s 30030
step    590 | loss 1.7480 | lr 3.00e-04 | grad 1.20 | tok/s 30030
step    600 | loss 1.6877 | lr 3.00e-04 | grad 1.25 | tok/s 30020
step    610 | loss 1.6717 | lr 3.00e-04 | grad 1.26 | tok/s 30019
step    620 | loss 1.6559 | lr 3.00e-04 | grad 1.22 | tok/s 29876
step    630 | loss 1.9312 | lr 3.00e-04 | grad 3.50 | tok/s 28238
step    640 | loss 2.0536 | lr 3.00e-04 | grad 1.34 | tok/s 28613
step    650 | loss 1.8653 | lr 3.00e-04 | grad 1.16 | tok/s 28595
step    660 | loss 1.9336 | lr 3.00e-04 | grad 1.19 | tok/s 29698
step    670 | loss 1.9534 | lr 3.00e-04 | grad 2.83 | tok/s 28710
step    680 | loss 1.9520 | lr 3.00e-04 | grad 1.55 | tok/s 28243
step    690 | loss 1.9068 | lr 3.00e-04 | grad 1.22 | tok/s 28025
step    700 | loss 1.8160 | lr 3.00e-04 | grad 1.07 | tok/s 28667
step    710 | loss 1.9657 | lr 3.00e-04 | grad 2.33 | tok/s 28224
step    720 | loss 1.7003 | lr 3.00e-04 | grad 1.35 | tok/s 29309
step    730 | loss 1.7909 | lr 3.00e-04 | grad 0.91 | tok/s 28833
step    740 | loss 2.2186 | lr 3.00e-04 | grad 2.25 | tok/s 29615
step    750 | loss 1.9972 | lr 3.00e-04 | grad 1.54 | tok/s 29964
step    760 | loss 1.8383 | lr 3.00e-04 | grad 2.08 | tok/s 29330
step    770 | loss 1.8436 | lr 3.00e-04 | grad 1.27 | tok/s 28807
step    780 | loss 1.7876 | lr 3.00e-04 | grad 1.32 | tok/s 29056
step    790 | loss 2.0920 | lr 3.00e-04 | grad 2.80 | tok/s 29716
step    800 | loss 1.6645 | lr 3.00e-04 | grad 1.06 | tok/s 29177
step    810 | loss 1.6221 | lr 3.00e-04 | grad 1.95 | tok/s 28196
step    820 | loss 1.7522 | lr 3.00e-04 | grad 1.20 | tok/s 28760
step    830 | loss 1.8088 | lr 3.00e-04 | grad 1.12 | tok/s 28350
step    840 | loss 1.9297 | lr 3.00e-04 | grad 1.19 | tok/s 28269
step    850 | loss 1.8851 | lr 3.00e-04 | grad 1.11 | tok/s 28843
step    860 | loss 1.9354 | lr 3.00e-04 | grad 1.35 | tok/s 29316
step    870 | loss 1.9338 | lr 3.00e-04 | grad 1.19 | tok/s 29520
step    880 | loss 1.8373 | lr 3.00e-04 | grad 1.08 | tok/s 28959
step    890 | loss 1.7255 | lr 3.00e-04 | grad 1.16 | tok/s 28838
step    900 | loss 1.7867 | lr 3.00e-04 | grad 0.99 | tok/s 28720
step    910 | loss 1.8363 | lr 3.00e-04 | grad 3.48 | tok/s 28415
step    920 | loss 1.7355 | lr 3.00e-04 | grad 1.20 | tok/s 28699
step    930 | loss 1.6913 | lr 3.00e-04 | grad 1.17 | tok/s 29059
step    940 | loss 1.6542 | lr 3.00e-04 | grad 1.16 | tok/s 28448
step    950 | loss 1.7465 | lr 3.00e-04 | grad 1.50 | tok/s 27956
step    960 | loss 1.6967 | lr 3.00e-04 | grad 1.16 | tok/s 28708
step    970 | loss 1.6942 | lr 3.00e-04 | grad 1.20 | tok/s 28732
step    980 | loss 2.3851 | lr 3.00e-04 | grad 2.00 | tok/s 29898
step    990 | loss 1.8856 | lr 3.00e-04 | grad 1.21 | tok/s 28658
step   1000 | loss 1.8112 | lr 3.00e-04 | grad 1.45 | tok/s 28739
  >>> saved checkpoint: checkpoint_step_001000_loss_1.8112.pt
step   1010 | loss 1.5527 | lr 3.00e-04 | grad 1.48 | tok/s 15848
step   1020 | loss 1.6139 | lr 3.00e-04 | grad 1.23 | tok/s 30236
step   1030 | loss 1.7739 | lr 3.00e-04 | grad 1.23 | tok/s 28733
step   1040 | loss 2.3048 | lr 3.00e-04 | grad 2.58 | tok/s 29416
step   1050 | loss 1.8677 | lr 3.00e-04 | grad 1.23 | tok/s 29605
step   1060 | loss 1.5036 | lr 3.00e-04 | grad 1.20 | tok/s 29216
step   1070 | loss 1.6188 | lr 3.00e-04 | grad 1.32 | tok/s 29161
step   1080 | loss 1.5161 | lr 3.00e-04 | grad 1.38 | tok/s 30130
step   1090 | loss 1.4915 | lr 3.00e-04 | grad 1.30 | tok/s 30137
step   1100 | loss 1.4641 | lr 3.00e-04 | grad 1.09 | tok/s 30098
step   1110 | loss 1.4004 | lr 3.00e-04 | grad 1.15 | tok/s 30090
step   1120 | loss 1.6283 | lr 3.00e-04 | grad 1.11 | tok/s 29280
step   1130 | loss 2.0217 | lr 3.00e-04 | grad 1.30 | tok/s 29642
step   1140 | loss 2.0210 | lr 3.00e-04 | grad 1.28 | tok/s 29962
step   1150 | loss 2.1337 | lr 3.00e-04 | grad 1.68 | tok/s 29301
step   1160 | loss 1.8973 | lr 3.00e-04 | grad 2.61 | tok/s 28339
step   1170 | loss 1.7519 | lr 3.00e-04 | grad 1.30 | tok/s 28285
step   1180 | loss 1.6475 | lr 3.00e-04 | grad 1.30 | tok/s 29688
step   1190 | loss 1.9335 | lr 3.00e-04 | grad 1.61 | tok/s 29816
step   1200 | loss 1.4751 | lr 3.00e-04 | grad 1.18 | tok/s 30081
step   1210 | loss 1.5519 | lr 3.00e-04 | grad 1.20 | tok/s 28329
step   1220 | loss 1.6286 | lr 3.00e-04 | grad 1.57 | tok/s 29232
step   1230 | loss 1.6753 | lr 3.00e-04 | grad 1.02 | tok/s 29437
step   1240 | loss 1.5387 | lr 3.00e-04 | grad 1.73 | tok/s 29795
step   1250 | loss 1.7696 | lr 3.00e-04 | grad 1.53 | tok/s 29070
step   1260 | loss 1.7978 | lr 3.00e-04 | grad 1.03 | tok/s 29862
step   1270 | loss 1.6175 | lr 3.00e-04 | grad 1.53 | tok/s 28959
step   1280 | loss 1.6190 | lr 3.00e-04 | grad 1.30 | tok/s 29034
step   1290 | loss 1.6261 | lr 3.00e-04 | grad 1.34 | tok/s 28341
step   1300 | loss 1.8563 | lr 3.00e-04 | grad 3.47 | tok/s 28290
step   1310 | loss 1.8448 | lr 3.00e-04 | grad 1.09 | tok/s 29481
step   1320 | loss 1.7185 | lr 3.00e-04 | grad 2.20 | tok/s 29404
step   1330 | loss 1.7344 | lr 3.00e-04 | grad 1.32 | tok/s 29312
step   1340 | loss 1.8059 | lr 3.00e-04 | grad 1.27 | tok/s 28378
step   1350 | loss 1.6944 | lr 3.00e-04 | grad 1.16 | tok/s 29510
step   1360 | loss 1.7540 | lr 3.00e-04 | grad 1.30 | tok/s 27719
step   1370 | loss 1.8484 | lr 3.00e-04 | grad 2.42 | tok/s 29628
step   1380 | loss 1.7112 | lr 3.00e-04 | grad 1.39 | tok/s 28675
step   1390 | loss 1.6638 | lr 3.00e-04 | grad 1.46 | tok/s 29256
step   1400 | loss 1.7319 | lr 3.00e-04 | grad 1.12 | tok/s 28601
step   1410 | loss 1.5737 | lr 3.00e-04 | grad 1.51 | tok/s 28131
step   1420 | loss 1.5329 | lr 3.00e-04 | grad 1.43 | tok/s 29847
step   1430 | loss 1.9833 | lr 3.00e-04 | grad 1.15 | tok/s 28899
step   1440 | loss 1.6958 | lr 3.00e-04 | grad 1.46 | tok/s 29111
step   1450 | loss 1.6789 | lr 3.00e-04 | grad 1.20 | tok/s 29445
step   1460 | loss 1.7791 | lr 3.00e-04 | grad 1.42 | tok/s 28573
step   1470 | loss 1.6138 | lr 3.00e-04 | grad 1.37 | tok/s 28177
step   1480 | loss 1.6192 | lr 3.00e-04 | grad 1.82 | tok/s 29185
step   1490 | loss 1.8539 | lr 3.00e-04 | grad 6.47 | tok/s 29011
step   1500 | loss 1.8560 | lr 3.00e-04 | grad 1.21 | tok/s 29410
step   1510 | loss 1.5088 | lr 3.00e-04 | grad 1.07 | tok/s 28845
step   1520 | loss 1.6718 | lr 3.00e-04 | grad 1.49 | tok/s 28731
step   1530 | loss 1.6153 | lr 3.00e-04 | grad 1.35 | tok/s 29493
step   1540 | loss 1.6993 | lr 3.00e-04 | grad 1.12 | tok/s 29515
step   1550 | loss 1.6837 | lr 3.00e-04 | grad 2.41 | tok/s 28992
step   1560 | loss 1.4489 | lr 3.00e-04 | grad 1.11 | tok/s 29918
step   1570 | loss 1.5606 | lr 3.00e-04 | grad 1.19 | tok/s 29253
step   1580 | loss 1.4806 | lr 3.00e-04 | grad 1.34 | tok/s 29391
step   1590 | loss 1.6622 | lr 3.00e-04 | grad 2.22 | tok/s 28318
step   1600 | loss 1.4516 | lr 3.00e-04 | grad 4.47 | tok/s 29885
step   1610 | loss 2.0897 | lr 3.00e-04 | grad 2.34 | tok/s 29136
step   1620 | loss 2.2742 | lr 3.00e-04 | grad 1.46 | tok/s 30087
step   1630 | loss 2.0269 | lr 3.00e-04 | grad 1.36 | tok/s 30094
step   1640 | loss 1.8704 | lr 3.00e-04 | grad 1.44 | tok/s 30087
step   1650 | loss 1.7815 | lr 3.00e-04 | grad 1.54 | tok/s 30095
step   1660 | loss 1.7292 | lr 3.00e-04 | grad 1.41 | tok/s 30076
step   1670 | loss 1.8223 | lr 3.00e-04 | grad 1.45 | tok/s 29116
step   1680 | loss 1.6198 | lr 3.00e-04 | grad 1.14 | tok/s 28868
step   1690 | loss 1.6449 | lr 3.00e-04 | grad 1.54 | tok/s 28215
step   1700 | loss 1.5215 | lr 3.00e-04 | grad 1.22 | tok/s 29264
step   1710 | loss 1.4809 | lr 3.00e-04 | grad 1.66 | tok/s 29396
step   1720 | loss 1.6370 | lr 3.00e-04 | grad 1.16 | tok/s 28501
step   1730 | loss 1.6878 | lr 3.00e-04 | grad 2.73 | tok/s 29390
step   1740 | loss 1.6134 | lr 3.00e-04 | grad 1.37 | tok/s 29564
step   1750 | loss 1.4878 | lr 3.00e-04 | grad 1.27 | tok/s 28902
step   1760 | loss 1.5952 | lr 3.00e-04 | grad 1.23 | tok/s 28627
step   1770 | loss 1.8521 | lr 3.00e-04 | grad 1.24 | tok/s 29306
step   1780 | loss 1.9099 | lr 3.00e-04 | grad 1.25 | tok/s 27700
step   1790 | loss 1.4979 | lr 3.00e-04 | grad 1.15 | tok/s 28163
step   1800 | loss 1.5268 | lr 3.00e-04 | grad 1.18 | tok/s 28818
step   1810 | loss 1.6022 | lr 3.00e-04 | grad 1.40 | tok/s 29066
step   1820 | loss 1.7085 | lr 3.00e-04 | grad 1.84 | tok/s 28662
step   1830 | loss 1.5571 | lr 3.00e-04 | grad 1.02 | tok/s 27855
step   1840 | loss 1.6051 | lr 3.00e-04 | grad 1.12 | tok/s 28823
step   1850 | loss 1.6428 | lr 3.00e-04 | grad 1.33 | tok/s 28669
step   1860 | loss 1.6017 | lr 3.00e-04 | grad 1.33 | tok/s 28560
step   1870 | loss 1.6032 | lr 3.00e-04 | grad 2.64 | tok/s 29055
step   1880 | loss 1.6723 | lr 3.00e-04 | grad 1.22 | tok/s 29292
step   1890 | loss 1.4636 | lr 3.00e-04 | grad 1.17 | tok/s 30051
step   1900 | loss 1.4021 | lr 3.00e-04 | grad 1.13 | tok/s 30027
step   1910 | loss 1.3741 | lr 3.00e-04 | grad 0.95 | tok/s 30019
step   1920 | loss 1.3547 | lr 3.00e-04 | grad 1.13 | tok/s 30073
step   1930 | loss 1.3875 | lr 3.00e-04 | grad 2.09 | tok/s 29983
step   1940 | loss 1.7302 | lr 3.00e-04 | grad 1.38 | tok/s 28519
step   1950 | loss 1.6023 | lr 3.00e-04 | grad 0.95 | tok/s 28271
step   1960 | loss 1.7030 | lr 3.00e-04 | grad 1.59 | tok/s 28638
step   1970 | loss 1.7353 | lr 3.00e-04 | grad 1.28 | tok/s 29237
step   1980 | loss 1.6234 | lr 3.00e-04 | grad 1.51 | tok/s 28336
step   1990 | loss 1.8066 | lr 3.00e-04 | grad 2.19 | tok/s 29158
step   2000 | loss 1.3607 | lr 3.00e-04 | grad 1.09 | tok/s 30089
  >>> saved checkpoint: checkpoint_step_002000_loss_1.3607.pt
step   2010 | loss 1.5591 | lr 3.00e-04 | grad 1.79 | tok/s 15728
step   2020 | loss 1.5511 | lr 3.00e-04 | grad 1.32 | tok/s 28622
step   2030 | loss 1.8755 | lr 3.00e-04 | grad 10.12 | tok/s 28270
step   2040 | loss 1.6373 | lr 3.00e-04 | grad 1.33 | tok/s 28776
step   2050 | loss 1.5110 | lr 3.00e-04 | grad 1.12 | tok/s 29199
step   2060 | loss 1.7492 | lr 3.00e-04 | grad 2.23 | tok/s 29216
step   2070 | loss 1.4505 | lr 3.00e-04 | grad 1.66 | tok/s 29255
step   2080 | loss 1.4945 | lr 3.00e-04 | grad 1.16 | tok/s 27797
step   2090 | loss 1.5579 | lr 3.00e-04 | grad 2.38 | tok/s 29723
step   2100 | loss 2.0000 | lr 3.00e-04 | grad 1.77 | tok/s 30007
step   2110 | loss 1.6042 | lr 3.00e-04 | grad 1.52 | tok/s 28686
step   2120 | loss 2.3462 | lr 3.00e-04 | grad 1.62 | tok/s 29379
step   2130 | loss 1.6021 | lr 3.00e-04 | grad 1.43 | tok/s 27942
step   2140 | loss 1.7927 | lr 3.00e-04 | grad 1.20 | tok/s 29511
step   2150 | loss 1.8602 | lr 3.00e-04 | grad 1.31 | tok/s 28901
step   2160 | loss 1.6551 | lr 3.00e-04 | grad 1.24 | tok/s 28999

Training complete! Final step: 2162
