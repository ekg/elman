Using device: cuda
Output directory: benchmark_results/cmaes_transformer_10min/transformer_480M_15gen_20260126_171317/eval_35/levelllama_100m_20260126_175426
Auto r_h_mode: none (level 0 has bounded/no W_h)
Model: Level llama, 275,637,760 parameters
Using schedule-free AdamW (lr=0.0003)

Starting training from step 0...
Batch size: 16, Chunk size: 512
Gradient accumulation: 1, Effective batch: 16

Time-based training: 10.0 minutes
step     10 | loss 5.7218 | lr 3.00e-04 | grad 5.53 | tok/s 11596
step     20 | loss 2.9707 | lr 3.00e-04 | grad 1.21 | tok/s 28591
step     30 | loss 3.2632 | lr 3.00e-04 | grad 1.98 | tok/s 30178
step     40 | loss 5.7742 | lr 3.00e-04 | grad 7.12 | tok/s 30672
step     50 | loss 4.5238 | lr 3.00e-04 | grad 4.25 | tok/s 31105
step     60 | loss 3.7972 | lr 3.00e-04 | grad 3.44 | tok/s 30994
step     70 | loss 3.2647 | lr 3.00e-04 | grad 3.42 | tok/s 30908
step     80 | loss 3.0614 | lr 3.00e-04 | grad 1.61 | tok/s 30818
step     90 | loss 2.7409 | lr 3.00e-04 | grad 1.64 | tok/s 30698
step    100 | loss 2.5282 | lr 3.00e-04 | grad 1.52 | tok/s 30628
step    110 | loss 2.6311 | lr 3.00e-04 | grad 2.00 | tok/s 30355
step    120 | loss 3.3994 | lr 3.00e-04 | grad 1.18 | tok/s 28892
step    130 | loss 2.6332 | lr 3.00e-04 | grad 2.44 | tok/s 29590
step    140 | loss 2.9565 | lr 3.00e-04 | grad 5.16 | tok/s 29630
step    150 | loss 2.7844 | lr 3.00e-04 | grad 4.66 | tok/s 30285
step    160 | loss 2.8377 | lr 3.00e-04 | grad 1.58 | tok/s 29284
step    170 | loss 2.7247 | lr 3.00e-04 | grad 0.79 | tok/s 28791
step    180 | loss 2.8813 | lr 3.00e-04 | grad 1.48 | tok/s 29505
step    190 | loss 2.4651 | lr 3.00e-04 | grad 1.69 | tok/s 28919
step    200 | loss 2.3967 | lr 3.00e-04 | grad 1.17 | tok/s 30213
step    210 | loss 2.4135 | lr 3.00e-04 | grad 2.52 | tok/s 28662
step    220 | loss 2.6811 | lr 3.00e-04 | grad 4.06 | tok/s 28974
step    230 | loss 2.4415 | lr 3.00e-04 | grad 1.77 | tok/s 28896
step    240 | loss 2.7670 | lr 3.00e-04 | grad 2.16 | tok/s 29319
step    250 | loss 2.3084 | lr 3.00e-04 | grad 1.77 | tok/s 29127
step    260 | loss 2.4517 | lr 3.00e-04 | grad 1.98 | tok/s 29948
step    270 | loss 2.3117 | lr 3.00e-04 | grad 1.30 | tok/s 29221
step    280 | loss 2.2414 | lr 3.00e-04 | grad 0.81 | tok/s 27441
step    290 | loss 2.1766 | lr 3.00e-04 | grad 1.87 | tok/s 28389
step    300 | loss 2.4391 | lr 3.00e-04 | grad 1.27 | tok/s 28609
step    310 | loss 2.1283 | lr 3.00e-04 | grad 1.00 | tok/s 28436
step    320 | loss 2.3904 | lr 3.00e-04 | grad 2.88 | tok/s 28744
step    330 | loss 2.1861 | lr 3.00e-04 | grad 1.45 | tok/s 29075
step    340 | loss 2.4838 | lr 3.00e-04 | grad 1.61 | tok/s 28955
step    350 | loss 2.4482 | lr 3.00e-04 | grad 1.27 | tok/s 29788
step    360 | loss 2.0938 | lr 3.00e-04 | grad 1.19 | tok/s 28471
step    370 | loss 2.1482 | lr 3.00e-04 | grad 1.59 | tok/s 30025
step    380 | loss 1.9731 | lr 3.00e-04 | grad 1.72 | tok/s 30291
step    390 | loss 1.8872 | lr 3.00e-04 | grad 1.22 | tok/s 30318
step    400 | loss 2.2513 | lr 3.00e-04 | grad 1.09 | tok/s 28733
step    410 | loss 2.1518 | lr 3.00e-04 | grad 1.23 | tok/s 28995
step    420 | loss 2.3088 | lr 3.00e-04 | grad 1.59 | tok/s 30258
step    430 | loss 2.1364 | lr 3.00e-04 | grad 1.59 | tok/s 29786
step    440 | loss 2.1489 | lr 3.00e-04 | grad 1.28 | tok/s 28802
step    450 | loss 2.0409 | lr 3.00e-04 | grad 1.02 | tok/s 29135
step    460 | loss 2.1164 | lr 3.00e-04 | grad 1.10 | tok/s 29590
step    470 | loss 2.1083 | lr 3.00e-04 | grad 1.81 | tok/s 29387
step    480 | loss 2.1363 | lr 3.00e-04 | grad 1.69 | tok/s 29963
step    490 | loss 2.0785 | lr 3.00e-04 | grad 1.56 | tok/s 28800
step    500 | loss 2.2126 | lr 3.00e-04 | grad 1.09 | tok/s 29314
step    510 | loss 2.0728 | lr 3.00e-04 | grad 1.02 | tok/s 27980
step    520 | loss 1.9342 | lr 3.00e-04 | grad 0.98 | tok/s 29290
step    530 | loss 2.0885 | lr 3.00e-04 | grad 1.16 | tok/s 28847
step    540 | loss 2.0526 | lr 3.00e-04 | grad 0.88 | tok/s 28210
step    550 | loss 1.7332 | lr 3.00e-04 | grad 1.90 | tok/s 29501
step    560 | loss 1.9088 | lr 3.00e-04 | grad 1.43 | tok/s 30386
step    570 | loss 1.7931 | lr 3.00e-04 | grad 1.22 | tok/s 30353
step    580 | loss 1.7239 | lr 3.00e-04 | grad 1.20 | tok/s 30364
step    590 | loss 1.7712 | lr 3.00e-04 | grad 1.46 | tok/s 30328
step    600 | loss 1.7257 | lr 3.00e-04 | grad 1.05 | tok/s 30366
step    610 | loss 1.6955 | lr 3.00e-04 | grad 1.07 | tok/s 30352
step    620 | loss 1.6836 | lr 3.00e-04 | grad 1.35 | tok/s 30229
step    630 | loss 1.9353 | lr 3.00e-04 | grad 3.03 | tok/s 28586
step    640 | loss 2.0766 | lr 3.00e-04 | grad 1.41 | tok/s 29000
step    650 | loss 1.8904 | lr 3.00e-04 | grad 1.05 | tok/s 28969
step    660 | loss 1.9523 | lr 3.00e-04 | grad 1.30 | tok/s 30086
step    670 | loss 1.9786 | lr 3.00e-04 | grad 2.59 | tok/s 29068
step    680 | loss 1.9754 | lr 3.00e-04 | grad 1.42 | tok/s 28634
step    690 | loss 1.9385 | lr 3.00e-04 | grad 1.09 | tok/s 28421
step    700 | loss 1.8384 | lr 3.00e-04 | grad 1.02 | tok/s 29032
step    710 | loss 1.9914 | lr 3.00e-04 | grad 2.16 | tok/s 28597
step    720 | loss 1.7367 | lr 3.00e-04 | grad 1.44 | tok/s 29692
step    730 | loss 1.8243 | lr 3.00e-04 | grad 0.90 | tok/s 29225
step    740 | loss 2.2489 | lr 3.00e-04 | grad 2.06 | tok/s 30072
step    750 | loss 2.0332 | lr 3.00e-04 | grad 1.70 | tok/s 30410
step    760 | loss 1.8608 | lr 3.00e-04 | grad 2.11 | tok/s 29782
step    770 | loss 1.8694 | lr 3.00e-04 | grad 1.26 | tok/s 29266
step    780 | loss 1.8157 | lr 3.00e-04 | grad 1.27 | tok/s 29404
step    790 | loss 2.1287 | lr 3.00e-04 | grad 2.20 | tok/s 30097
step    800 | loss 1.6983 | lr 3.00e-04 | grad 0.94 | tok/s 29624
step    810 | loss 1.6386 | lr 3.00e-04 | grad 1.86 | tok/s 28614
step    820 | loss 1.7851 | lr 3.00e-04 | grad 1.20 | tok/s 29135
step    830 | loss 1.8300 | lr 3.00e-04 | grad 1.09 | tok/s 28750
step    840 | loss 1.9511 | lr 3.00e-04 | grad 1.15 | tok/s 28562
step    850 | loss 1.9171 | lr 3.00e-04 | grad 1.10 | tok/s 29259
step    860 | loss 1.9627 | lr 3.00e-04 | grad 1.31 | tok/s 29733
step    870 | loss 1.9798 | lr 3.00e-04 | grad 1.26 | tok/s 29996
step    880 | loss 1.8611 | lr 3.00e-04 | grad 1.02 | tok/s 29379
step    890 | loss 1.7490 | lr 3.00e-04 | grad 1.04 | tok/s 29238
step    900 | loss 1.8100 | lr 3.00e-04 | grad 1.01 | tok/s 29114
step    910 | loss 1.8653 | lr 3.00e-04 | grad 3.28 | tok/s 28816
step    920 | loss 1.7602 | lr 3.00e-04 | grad 1.23 | tok/s 29156
step    930 | loss 1.7194 | lr 3.00e-04 | grad 1.19 | tok/s 29525
step    940 | loss 1.6864 | lr 3.00e-04 | grad 1.11 | tok/s 28883
step    950 | loss 1.7697 | lr 3.00e-04 | grad 1.51 | tok/s 28383
step    960 | loss 1.7189 | lr 3.00e-04 | grad 1.10 | tok/s 29171
step    970 | loss 1.7119 | lr 3.00e-04 | grad 1.09 | tok/s 29161
step    980 | loss 2.4449 | lr 3.00e-04 | grad 2.12 | tok/s 30369
step    990 | loss 1.9115 | lr 3.00e-04 | grad 1.34 | tok/s 29124
step   1000 | loss 1.8264 | lr 3.00e-04 | grad 1.42 | tok/s 29195
  >>> saved checkpoint: checkpoint_step_001000_loss_1.8264.pt
step   1010 | loss 1.5676 | lr 3.00e-04 | grad 1.36 | tok/s 17025
step   1020 | loss 1.6496 | lr 3.00e-04 | grad 1.23 | tok/s 30792
step   1030 | loss 1.8071 | lr 3.00e-04 | grad 1.15 | tok/s 29125
step   1040 | loss 2.3060 | lr 3.00e-04 | grad 2.36 | tok/s 29892
step   1050 | loss 1.9044 | lr 3.00e-04 | grad 1.09 | tok/s 30050
step   1060 | loss 1.5518 | lr 3.00e-04 | grad 0.91 | tok/s 29698
step   1070 | loss 1.6422 | lr 3.00e-04 | grad 1.47 | tok/s 29625
step   1080 | loss 1.5365 | lr 3.00e-04 | grad 1.26 | tok/s 30573
step   1090 | loss 1.5103 | lr 3.00e-04 | grad 1.30 | tok/s 30606
step   1100 | loss 1.4848 | lr 3.00e-04 | grad 1.29 | tok/s 30613
step   1110 | loss 1.4249 | lr 3.00e-04 | grad 1.19 | tok/s 30594
step   1120 | loss 1.6535 | lr 3.00e-04 | grad 1.17 | tok/s 29780
step   1130 | loss 2.0678 | lr 3.00e-04 | grad 1.15 | tok/s 30063
step   1140 | loss 2.0437 | lr 3.00e-04 | grad 1.37 | tok/s 30461
step   1150 | loss 2.1918 | lr 3.00e-04 | grad 1.70 | tok/s 29793
step   1160 | loss 1.9226 | lr 3.00e-04 | grad 2.84 | tok/s 28783
step   1170 | loss 1.7681 | lr 3.00e-04 | grad 1.30 | tok/s 28731
step   1180 | loss 1.6799 | lr 3.00e-04 | grad 1.37 | tok/s 30200
step   1190 | loss 1.9724 | lr 3.00e-04 | grad 1.45 | tok/s 30273
step   1200 | loss 1.4999 | lr 3.00e-04 | grad 1.15 | tok/s 30562
step   1210 | loss 1.5787 | lr 3.00e-04 | grad 1.14 | tok/s 28739
step   1220 | loss 1.6525 | lr 3.00e-04 | grad 1.48 | tok/s 29736
step   1230 | loss 1.6904 | lr 3.00e-04 | grad 1.01 | tok/s 29906
step   1240 | loss 1.5657 | lr 3.00e-04 | grad 1.72 | tok/s 30273
step   1250 | loss 1.8024 | lr 3.00e-04 | grad 1.53 | tok/s 29579
step   1260 | loss 1.8475 | lr 3.00e-04 | grad 1.16 | tok/s 30399
step   1270 | loss 1.6369 | lr 3.00e-04 | grad 1.59 | tok/s 29444
step   1280 | loss 1.6532 | lr 3.00e-04 | grad 1.41 | tok/s 29522
step   1290 | loss 1.6517 | lr 3.00e-04 | grad 1.35 | tok/s 28852
step   1300 | loss 1.8804 | lr 3.00e-04 | grad 3.38 | tok/s 28742
step   1310 | loss 1.8868 | lr 3.00e-04 | grad 1.12 | tok/s 29937
step   1320 | loss 1.7390 | lr 3.00e-04 | grad 2.20 | tok/s 29807
step   1330 | loss 1.7680 | lr 3.00e-04 | grad 1.45 | tok/s 29767
step   1340 | loss 1.8439 | lr 3.00e-04 | grad 1.25 | tok/s 28860
step   1350 | loss 1.7180 | lr 3.00e-04 | grad 1.13 | tok/s 29984
step   1360 | loss 1.7635 | lr 3.00e-04 | grad 1.25 | tok/s 28191
step   1370 | loss 1.8773 | lr 3.00e-04 | grad 2.36 | tok/s 30074
step   1380 | loss 1.7421 | lr 3.00e-04 | grad 1.51 | tok/s 29163
step   1390 | loss 1.7015 | lr 3.00e-04 | grad 1.38 | tok/s 29736
step   1400 | loss 1.7726 | lr 3.00e-04 | grad 1.25 | tok/s 29099
step   1410 | loss 1.5929 | lr 3.00e-04 | grad 1.50 | tok/s 28543
step   1420 | loss 1.5907 | lr 3.00e-04 | grad 1.42 | tok/s 30276
step   1430 | loss 2.0110 | lr 3.00e-04 | grad 1.09 | tok/s 29321
step   1440 | loss 1.7141 | lr 3.00e-04 | grad 1.58 | tok/s 29557
step   1450 | loss 1.7072 | lr 3.00e-04 | grad 1.11 | tok/s 29861
step   1460 | loss 1.7894 | lr 3.00e-04 | grad 1.44 | tok/s 29020
step   1470 | loss 1.6331 | lr 3.00e-04 | grad 1.41 | tok/s 28607
step   1480 | loss 1.6451 | lr 3.00e-04 | grad 1.86 | tok/s 29617
step   1490 | loss 1.8522 | lr 3.00e-04 | grad 3.83 | tok/s 29406
step   1500 | loss 1.8722 | lr 3.00e-04 | grad 1.22 | tok/s 29862
step   1510 | loss 1.5368 | lr 3.00e-04 | grad 1.05 | tok/s 29264
step   1520 | loss 1.6836 | lr 3.00e-04 | grad 1.52 | tok/s 29170
step   1530 | loss 1.6270 | lr 3.00e-04 | grad 1.36 | tok/s 29942
step   1540 | loss 1.7157 | lr 3.00e-04 | grad 1.04 | tok/s 29992
step   1550 | loss 1.7032 | lr 3.00e-04 | grad 2.28 | tok/s 29408
step   1560 | loss 1.4743 | lr 3.00e-04 | grad 1.12 | tok/s 30372
step   1570 | loss 1.5937 | lr 3.00e-04 | grad 1.09 | tok/s 29650
step   1580 | loss 1.5018 | lr 3.00e-04 | grad 1.42 | tok/s 29831
step   1590 | loss 1.6949 | lr 3.00e-04 | grad 2.09 | tok/s 28707
step   1600 | loss 1.4790 | lr 3.00e-04 | grad 4.12 | tok/s 30321
step   1610 | loss 2.1157 | lr 3.00e-04 | grad 2.50 | tok/s 29519
step   1620 | loss 2.2533 | lr 3.00e-04 | grad 1.33 | tok/s 30479
step   1630 | loss 2.0039 | lr 3.00e-04 | grad 1.37 | tok/s 30491
step   1640 | loss 1.8608 | lr 3.00e-04 | grad 1.20 | tok/s 30486
step   1650 | loss 1.7782 | lr 3.00e-04 | grad 1.53 | tok/s 30473
step   1660 | loss 1.7300 | lr 3.00e-04 | grad 1.44 | tok/s 30483
step   1670 | loss 1.8348 | lr 3.00e-04 | grad 1.47 | tok/s 29515
step   1680 | loss 1.6369 | lr 3.00e-04 | grad 1.16 | tok/s 29264
step   1690 | loss 1.6703 | lr 3.00e-04 | grad 1.49 | tok/s 28632
step   1700 | loss 1.5406 | lr 3.00e-04 | grad 1.38 | tok/s 29741
step   1710 | loss 1.5034 | lr 3.00e-04 | grad 1.59 | tok/s 29855
step   1720 | loss 1.6473 | lr 3.00e-04 | grad 1.05 | tok/s 28964
step   1730 | loss 1.7111 | lr 3.00e-04 | grad 2.42 | tok/s 29832
step   1740 | loss 1.6258 | lr 3.00e-04 | grad 1.24 | tok/s 29971
step   1750 | loss 1.5098 | lr 3.00e-04 | grad 1.21 | tok/s 29365
step   1760 | loss 1.6125 | lr 3.00e-04 | grad 1.24 | tok/s 29078
step   1770 | loss 1.8917 | lr 3.00e-04 | grad 1.29 | tok/s 29774
step   1780 | loss 1.9229 | lr 3.00e-04 | grad 1.24 | tok/s 28127
step   1790 | loss 1.5136 | lr 3.00e-04 | grad 1.16 | tok/s 28600
step   1800 | loss 1.5468 | lr 3.00e-04 | grad 1.20 | tok/s 29244
step   1810 | loss 1.6165 | lr 3.00e-04 | grad 1.30 | tok/s 29469
step   1820 | loss 1.7227 | lr 3.00e-04 | grad 1.72 | tok/s 29109
step   1830 | loss 1.5713 | lr 3.00e-04 | grad 1.05 | tok/s 28295
step   1840 | loss 1.6333 | lr 3.00e-04 | grad 1.14 | tok/s 29286
step   1850 | loss 1.6685 | lr 3.00e-04 | grad 1.44 | tok/s 29135
step   1860 | loss 1.6246 | lr 3.00e-04 | grad 1.38 | tok/s 29030
step   1870 | loss 1.6296 | lr 3.00e-04 | grad 2.23 | tok/s 29492
step   1880 | loss 1.6865 | lr 3.00e-04 | grad 1.25 | tok/s 29714
step   1890 | loss 1.4808 | lr 3.00e-04 | grad 1.29 | tok/s 30498
step   1900 | loss 1.4201 | lr 3.00e-04 | grad 1.07 | tok/s 30503
step   1910 | loss 1.3914 | lr 3.00e-04 | grad 1.12 | tok/s 30512
step   1920 | loss 1.3755 | lr 3.00e-04 | grad 1.08 | tok/s 30490
step   1930 | loss 1.4072 | lr 3.00e-04 | grad 2.17 | tok/s 30388
step   1940 | loss 1.7422 | lr 3.00e-04 | grad 1.45 | tok/s 28937
step   1950 | loss 1.6259 | lr 3.00e-04 | grad 0.93 | tok/s 28681
step   1960 | loss 1.7258 | lr 3.00e-04 | grad 1.62 | tok/s 29052
step   1970 | loss 1.7620 | lr 3.00e-04 | grad 1.39 | tok/s 29627
step   1980 | loss 1.6474 | lr 3.00e-04 | grad 1.48 | tok/s 28827
step   1990 | loss 1.8445 | lr 3.00e-04 | grad 2.12 | tok/s 29574
step   2000 | loss 1.3780 | lr 3.00e-04 | grad 1.17 | tok/s 30546
  >>> saved checkpoint: checkpoint_step_002000_loss_1.3780.pt
step   2010 | loss 1.5820 | lr 3.00e-04 | grad 1.64 | tok/s 16737
step   2020 | loss 1.5723 | lr 3.00e-04 | grad 1.34 | tok/s 29102
step   2030 | loss 1.9121 | lr 3.00e-04 | grad 8.31 | tok/s 28768
step   2040 | loss 1.6542 | lr 3.00e-04 | grad 1.39 | tok/s 29272
step   2050 | loss 1.5258 | lr 3.00e-04 | grad 1.10 | tok/s 29646
step   2060 | loss 1.7793 | lr 3.00e-04 | grad 2.12 | tok/s 29632
step   2070 | loss 1.4669 | lr 3.00e-04 | grad 1.39 | tok/s 29701
step   2080 | loss 1.5125 | lr 3.00e-04 | grad 1.21 | tok/s 28271
step   2090 | loss 1.5901 | lr 3.00e-04 | grad 1.82 | tok/s 30194
step   2100 | loss 2.0340 | lr 3.00e-04 | grad 1.91 | tok/s 30463
step   2110 | loss 1.6305 | lr 3.00e-04 | grad 1.55 | tok/s 29151
step   2120 | loss 2.4002 | lr 3.00e-04 | grad 1.81 | tok/s 29813
step   2130 | loss 1.6257 | lr 3.00e-04 | grad 1.44 | tok/s 28363
step   2140 | loss 1.8188 | lr 3.00e-04 | grad 1.24 | tok/s 29979
step   2150 | loss 1.8934 | lr 3.00e-04 | grad 1.31 | tok/s 29339
step   2160 | loss 1.6709 | lr 3.00e-04 | grad 1.29 | tok/s 29469
step   2170 | loss 1.5990 | lr 3.00e-04 | grad 3.08 | tok/s 29757
step   2180 | loss 1.3588 | lr 3.00e-04 | grad 1.88 | tok/s 30396

Training complete! Final step: 2188
