Using device: cuda
Output directory: benchmark_results/cmaes_transformer_10min/transformer_480M_15gen_20260126_171317/eval_97/levelllama_100m_20260126_191643
Auto r_h_mode: none (level 0 has bounded/no W_h)
Model: Level llama, 466,036,224 parameters
Using schedule-free AdamW (lr=0.0003)

Starting training from step 0...
Batch size: 8, Chunk size: 512
Gradient accumulation: 1, Effective batch: 8

Time-based training: 10.0 minutes
step     10 | loss 5.9930 | lr 3.00e-04 | grad 4.06 | tok/s 6253
step     20 | loss 2.8260 | lr 3.00e-04 | grad 1.67 | tok/s 16354
step     30 | loss 2.8445 | lr 3.00e-04 | grad 2.25 | tok/s 16500
step     40 | loss 3.0360 | lr 3.00e-04 | grad 3.28 | tok/s 15786
step     50 | loss 3.2444 | lr 3.00e-04 | grad 3.08 | tok/s 16041
step     60 | loss 2.5597 | lr 3.00e-04 | grad 3.69 | tok/s 16526
step     70 | loss 2.5047 | lr 3.00e-04 | grad 1.87 | tok/s 16704
step     80 | loss 5.3443 | lr 3.00e-04 | grad 7.97 | tok/s 16808
step     90 | loss 4.4466 | lr 3.00e-04 | grad 2.11 | tok/s 17097
step    100 | loss 3.8965 | lr 3.00e-04 | grad 4.84 | tok/s 17084
step    110 | loss 3.8327 | lr 3.00e-04 | grad 8.31 | tok/s 17066
step    120 | loss 3.7974 | lr 3.00e-04 | grad 9.12 | tok/s 17054
step    130 | loss 3.8409 | lr 3.00e-04 | grad 4.25 | tok/s 17048
step    140 | loss 3.3988 | lr 3.00e-04 | grad 4.41 | tok/s 17011
step    150 | loss 3.8374 | lr 3.00e-04 | grad 6.81 | tok/s 17014
step    160 | loss 3.3050 | lr 3.00e-04 | grad 6.19 | tok/s 16984
step    170 | loss 3.3174 | lr 3.00e-04 | grad 5.78 | tok/s 16944
step    180 | loss 3.0858 | lr 3.00e-04 | grad 3.38 | tok/s 16934
step    190 | loss 3.1713 | lr 3.00e-04 | grad 6.62 | tok/s 16888
step    200 | loss 2.8427 | lr 3.00e-04 | grad 3.22 | tok/s 16886
step    210 | loss 2.8073 | lr 3.00e-04 | grad 3.44 | tok/s 16850
step    220 | loss 2.8183 | lr 3.00e-04 | grad 3.25 | tok/s 16656
step    230 | loss 3.1087 | lr 3.00e-04 | grad 2.16 | tok/s 16431
step    240 | loss 2.6170 | lr 3.00e-04 | grad 3.31 | tok/s 15618
step    250 | loss 2.4689 | lr 3.00e-04 | grad 2.25 | tok/s 16018
step    260 | loss 2.2670 | lr 3.00e-04 | grad 2.12 | tok/s 16534
step    270 | loss 2.4963 | lr 3.00e-04 | grad 2.14 | tok/s 16352
step    280 | loss 2.6448 | lr 3.00e-04 | grad 3.06 | tok/s 16060
step    290 | loss 2.5058 | lr 3.00e-04 | grad 1.88 | tok/s 16927
step    300 | loss 1.5887 | lr 3.00e-04 | grad 2.48 | tok/s 16902
step    310 | loss 2.8546 | lr 3.00e-04 | grad 1.81 | tok/s 16588
step    320 | loss 2.5441 | lr 3.00e-04 | grad 3.36 | tok/s 16241
step    330 | loss 2.3462 | lr 3.00e-04 | grad 1.48 | tok/s 15685
step    340 | loss 2.5938 | lr 3.00e-04 | grad 1.57 | tok/s 15885
step    350 | loss 2.4225 | lr 3.00e-04 | grad 1.74 | tok/s 16339
step    360 | loss 2.5296 | lr 3.00e-04 | grad 2.55 | tok/s 16701
step    370 | loss 2.2387 | lr 3.00e-04 | grad 1.82 | tok/s 15117
step    380 | loss 2.1939 | lr 3.00e-04 | grad 1.46 | tok/s 16073
step    390 | loss 2.0809 | lr 3.00e-04 | grad 2.41 | tok/s 16776
step    400 | loss 2.0586 | lr 3.00e-04 | grad 1.68 | tok/s 16631
step    410 | loss 1.9801 | lr 3.00e-04 | grad 1.42 | tok/s 16245
step    420 | loss 2.1624 | lr 3.00e-04 | grad 2.05 | tok/s 15512
step    430 | loss 2.4489 | lr 3.00e-04 | grad 2.08 | tok/s 16517
step    440 | loss 2.4965 | lr 3.00e-04 | grad 1.98 | tok/s 15646
step    450 | loss 2.5133 | lr 3.00e-04 | grad 1.26 | tok/s 16187
step    460 | loss 2.1830 | lr 3.00e-04 | grad 2.59 | tok/s 15801
step    470 | loss 2.2508 | lr 3.00e-04 | grad 1.98 | tok/s 16317
step    480 | loss 2.6631 | lr 3.00e-04 | grad 2.81 | tok/s 16321
step    490 | loss 2.1471 | lr 3.00e-04 | grad 2.06 | tok/s 15397
step    500 | loss 2.1343 | lr 3.00e-04 | grad 1.76 | tok/s 16430
step    510 | loss 2.1294 | lr 3.00e-04 | grad 1.28 | tok/s 16649
step    520 | loss 2.1235 | lr 3.00e-04 | grad 1.27 | tok/s 16617
step    530 | loss 2.2742 | lr 3.00e-04 | grad 1.51 | tok/s 16014
step    540 | loss 2.0514 | lr 3.00e-04 | grad 1.95 | tok/s 15982
step    550 | loss 1.9059 | lr 3.00e-04 | grad 1.48 | tok/s 15651
step    560 | loss 2.0707 | lr 3.00e-04 | grad 1.59 | tok/s 15247
step    570 | loss 2.0160 | lr 3.00e-04 | grad 2.55 | tok/s 15675
step    580 | loss 1.9025 | lr 3.00e-04 | grad 1.57 | tok/s 15590
step    590 | loss 2.2413 | lr 3.00e-04 | grad 1.45 | tok/s 16034
step    600 | loss 2.1357 | lr 3.00e-04 | grad 1.30 | tok/s 15472
step    610 | loss 1.9728 | lr 3.00e-04 | grad 1.48 | tok/s 16270
step    620 | loss 1.8348 | lr 3.00e-04 | grad 1.15 | tok/s 15376
step    630 | loss 1.9887 | lr 3.00e-04 | grad 2.09 | tok/s 15471
step    640 | loss 2.1560 | lr 3.00e-04 | grad 1.56 | tok/s 15876
step    650 | loss 1.9949 | lr 3.00e-04 | grad 2.11 | tok/s 15985
step    660 | loss 2.0074 | lr 3.00e-04 | grad 1.09 | tok/s 16038
step    670 | loss 2.2313 | lr 3.00e-04 | grad 2.69 | tok/s 16179
step    680 | loss 1.9952 | lr 3.00e-04 | grad 1.20 | tok/s 15811
step    690 | loss 2.2869 | lr 3.00e-04 | grad 1.75 | tok/s 16408
step    700 | loss 2.0302 | lr 3.00e-04 | grad 1.61 | tok/s 16748
step    710 | loss 1.9033 | lr 3.00e-04 | grad 1.80 | tok/s 15625
step    720 | loss 1.7562 | lr 3.00e-04 | grad 1.59 | tok/s 15393
step    730 | loss 1.8178 | lr 3.00e-04 | grad 1.81 | tok/s 16700
step    740 | loss 1.8771 | lr 3.00e-04 | grad 1.54 | tok/s 16470
step    750 | loss 1.6764 | lr 3.00e-04 | grad 1.34 | tok/s 16701
step    760 | loss 1.5270 | lr 3.00e-04 | grad 1.82 | tok/s 16654
step    770 | loss 1.4981 | lr 3.00e-04 | grad 1.35 | tok/s 16675
step    780 | loss 1.4338 | lr 3.00e-04 | grad 1.33 | tok/s 16700
step    790 | loss 1.4918 | lr 3.00e-04 | grad 1.63 | tok/s 16164
step    800 | loss 2.2232 | lr 3.00e-04 | grad 2.66 | tok/s 16133
step    810 | loss 1.9457 | lr 3.00e-04 | grad 1.41 | tok/s 16018
step    820 | loss 1.9449 | lr 3.00e-04 | grad 1.80 | tok/s 15432
step    830 | loss 2.0063 | lr 3.00e-04 | grad 1.38 | tok/s 16604
step    840 | loss 1.8993 | lr 3.00e-04 | grad 1.34 | tok/s 16749
step    850 | loss 1.9215 | lr 3.00e-04 | grad 1.62 | tok/s 16685
step    860 | loss 1.8614 | lr 3.00e-04 | grad 2.16 | tok/s 16491
step    870 | loss 1.8088 | lr 3.00e-04 | grad 1.59 | tok/s 15896
step    880 | loss 1.9591 | lr 3.00e-04 | grad 1.26 | tok/s 15969
step    890 | loss 1.9410 | lr 3.00e-04 | grad 1.70 | tok/s 16203
step    900 | loss 1.8111 | lr 3.00e-04 | grad 1.34 | tok/s 16208
step    910 | loss 1.6698 | lr 3.00e-04 | grad 1.72 | tok/s 15871
step    920 | loss 1.8514 | lr 3.00e-04 | grad 2.19 | tok/s 16486
step    930 | loss 1.8532 | lr 3.00e-04 | grad 2.03 | tok/s 15720
step    940 | loss 1.7842 | lr 3.00e-04 | grad 1.38 | tok/s 16556
step    950 | loss 1.8171 | lr 3.00e-04 | grad 1.68 | tok/s 16633
step    960 | loss 1.7007 | lr 3.00e-04 | grad 1.44 | tok/s 16646
step    970 | loss 1.9105 | lr 3.00e-04 | grad 1.73 | tok/s 15633
step    980 | loss 1.8570 | lr 3.00e-04 | grad 1.19 | tok/s 16075
step    990 | loss 1.7482 | lr 3.00e-04 | grad 1.27 | tok/s 16344
step   1000 | loss 2.0822 | lr 3.00e-04 | grad 5.22 | tok/s 15647
  >>> saved checkpoint: checkpoint_step_001000_loss_2.0822.pt
step   1010 | loss 1.9307 | lr 3.00e-04 | grad 1.52 | tok/s 6726
step   1020 | loss 1.8342 | lr 3.00e-04 | grad 1.22 | tok/s 15356
step   1030 | loss 1.6898 | lr 3.00e-04 | grad 1.59 | tok/s 16044
step   1040 | loss 1.7018 | lr 3.00e-04 | grad 1.34 | tok/s 16536
step   1050 | loss 1.7950 | lr 3.00e-04 | grad 1.80 | tok/s 15312
step   1060 | loss 1.9712 | lr 3.00e-04 | grad 1.60 | tok/s 16507
step   1070 | loss 2.0128 | lr 3.00e-04 | grad 1.41 | tok/s 16438
step   1080 | loss 1.6139 | lr 3.00e-04 | grad 1.13 | tok/s 14951
step   1090 | loss 1.3491 | lr 3.00e-04 | grad 0.70 | tok/s 16480
step   1100 | loss 1.6404 | lr 3.00e-04 | grad 2.27 | tok/s 15985
step   1110 | loss 1.6901 | lr 3.00e-04 | grad 1.29 | tok/s 16785
step   1120 | loss 1.5886 | lr 3.00e-04 | grad 1.79 | tok/s 16775
step   1130 | loss 1.5260 | lr 3.00e-04 | grad 1.33 | tok/s 16787
step   1140 | loss 1.4996 | lr 3.00e-04 | grad 1.46 | tok/s 16778
step   1150 | loss 1.5197 | lr 3.00e-04 | grad 1.33 | tok/s 16771
step   1160 | loss 1.4276 | lr 3.00e-04 | grad 1.34 | tok/s 16773
step   1170 | loss 1.4440 | lr 3.00e-04 | grad 1.45 | tok/s 16755
step   1180 | loss 1.5679 | lr 3.00e-04 | grad 1.02 | tok/s 16748
step   1190 | loss 1.4475 | lr 3.00e-04 | grad 1.42 | tok/s 16757
step   1200 | loss 1.4421 | lr 3.00e-04 | grad 1.50 | tok/s 16768
step   1210 | loss 1.4745 | lr 3.00e-04 | grad 1.54 | tok/s 16757
step   1220 | loss 1.4742 | lr 3.00e-04 | grad 1.48 | tok/s 16776
step   1230 | loss 1.4579 | lr 3.00e-04 | grad 1.23 | tok/s 16749
step   1240 | loss 1.3977 | lr 3.00e-04 | grad 1.13 | tok/s 16746
step   1250 | loss 2.0856 | lr 3.00e-04 | grad 1.72 | tok/s 15892
step   1260 | loss 1.5591 | lr 3.00e-04 | grad 1.85 | tok/s 15732
step   1270 | loss 1.8324 | lr 3.00e-04 | grad 2.91 | tok/s 15689
step   1280 | loss 1.8312 | lr 3.00e-04 | grad 1.42 | tok/s 16132
step   1290 | loss 1.6759 | lr 3.00e-04 | grad 1.60 | tok/s 16018
step   1300 | loss 1.7217 | lr 3.00e-04 | grad 1.41 | tok/s 16077
step   1310 | loss 1.6915 | lr 3.00e-04 | grad 1.55 | tok/s 16372
step   1320 | loss 1.7731 | lr 3.00e-04 | grad 1.28 | tok/s 16428
step   1330 | loss 1.7916 | lr 3.00e-04 | grad 1.48 | tok/s 16413
step   1340 | loss 1.6770 | lr 3.00e-04 | grad 4.66 | tok/s 15689
step   1350 | loss 1.8723 | lr 3.00e-04 | grad 1.45 | tok/s 15158
step   1360 | loss 1.7504 | lr 3.00e-04 | grad 1.48 | tok/s 16124
step   1370 | loss 1.5736 | lr 3.00e-04 | grad 1.03 | tok/s 15944
step   1380 | loss 1.8801 | lr 3.00e-04 | grad 1.14 | tok/s 15328
step   1390 | loss 1.7141 | lr 3.00e-04 | grad 1.27 | tok/s 16248
step   1400 | loss 1.6107 | lr 3.00e-04 | grad 1.19 | tok/s 15666
step   1410 | loss 1.6400 | lr 3.00e-04 | grad 1.84 | tok/s 15715
step   1420 | loss 1.9170 | lr 3.00e-04 | grad 3.03 | tok/s 15739
step   1430 | loss 1.6006 | lr 3.00e-04 | grad 1.18 | tok/s 16021
step   1440 | loss 1.3620 | lr 3.00e-04 | grad 1.38 | tok/s 16532
step   1450 | loss 1.3417 | lr 3.00e-04 | grad 2.83 | tok/s 16670
step   1460 | loss 1.8374 | lr 3.00e-04 | grad 1.30 | tok/s 15725
step   1470 | loss 1.7415 | lr 3.00e-04 | grad 1.12 | tok/s 16288
step   1480 | loss 2.1938 | lr 3.00e-04 | grad 2.45 | tok/s 16405
step   1490 | loss 1.9732 | lr 3.00e-04 | grad 1.35 | tok/s 16636
step   1500 | loss 1.6034 | lr 3.00e-04 | grad 1.25 | tok/s 16702
step   1510 | loss 1.7018 | lr 3.00e-04 | grad 1.35 | tok/s 16497
step   1520 | loss 1.6113 | lr 3.00e-04 | grad 2.36 | tok/s 16158
step   1530 | loss 1.5764 | lr 3.00e-04 | grad 1.25 | tok/s 16558
step   1540 | loss 1.7770 | lr 3.00e-04 | grad 1.30 | tok/s 15580
step   1550 | loss 1.5253 | lr 3.00e-04 | grad 1.64 | tok/s 16589
step   1560 | loss 1.7252 | lr 3.00e-04 | grad 1.72 | tok/s 15727
step   1570 | loss 1.5476 | lr 3.00e-04 | grad 1.30 | tok/s 16706
step   1580 | loss 2.0544 | lr 3.00e-04 | grad 3.48 | tok/s 16325
step   1590 | loss 1.9431 | lr 3.00e-04 | grad 1.49 | tok/s 15686
step   1600 | loss 1.2087 | lr 3.00e-04 | grad 0.91 | tok/s 16750
step   1610 | loss 1.1693 | lr 3.00e-04 | grad 1.55 | tok/s 16201
step   1620 | loss 1.6081 | lr 3.00e-04 | grad 1.73 | tok/s 15184
step   1630 | loss 1.6454 | lr 3.00e-04 | grad 1.34 | tok/s 16232
step   1640 | loss 1.4975 | lr 3.00e-04 | grad 1.36 | tok/s 15852
step   1650 | loss 1.6559 | lr 3.00e-04 | grad 1.28 | tok/s 15193
step   1660 | loss 1.6243 | lr 3.00e-04 | grad 1.12 | tok/s 16220
step   1670 | loss 1.6067 | lr 3.00e-04 | grad 3.89 | tok/s 16177
step   1680 | loss 1.8912 | lr 3.00e-04 | grad 1.30 | tok/s 15534
step   1690 | loss 1.6588 | lr 3.00e-04 | grad 2.91 | tok/s 15832
step   1700 | loss 1.6759 | lr 3.00e-04 | grad 1.48 | tok/s 16186
step   1710 | loss 1.6749 | lr 3.00e-04 | grad 1.19 | tok/s 15844
step   1720 | loss 1.7561 | lr 3.00e-04 | grad 1.52 | tok/s 16545
step   1730 | loss 1.6448 | lr 3.00e-04 | grad 1.39 | tok/s 16713
step   1740 | loss 1.6415 | lr 3.00e-04 | grad 1.62 | tok/s 16266
step   1750 | loss 1.7317 | lr 3.00e-04 | grad 1.54 | tok/s 15955
step   1760 | loss 1.6732 | lr 3.00e-04 | grad 1.29 | tok/s 16055
step   1770 | loss 1.5880 | lr 3.00e-04 | grad 1.41 | tok/s 15775
step   1780 | loss 1.6358 | lr 3.00e-04 | grad 1.32 | tok/s 16405
step   1790 | loss 1.5570 | lr 3.00e-04 | grad 1.05 | tok/s 15984
step   1800 | loss 1.7519 | lr 3.00e-04 | grad 1.37 | tok/s 16101
step   1810 | loss 1.6126 | lr 3.00e-04 | grad 1.27 | tok/s 15547
step   1820 | loss 1.6829 | lr 3.00e-04 | grad 3.02 | tok/s 15750
step   1830 | loss 1.5806 | lr 3.00e-04 | grad 1.41 | tok/s 16403
step   1840 | loss 1.6613 | lr 3.00e-04 | grad 1.59 | tok/s 15712
step   1850 | loss 1.5587 | lr 3.00e-04 | grad 1.21 | tok/s 16448
step   1860 | loss 1.4772 | lr 3.00e-04 | grad 1.38 | tok/s 15914
step   1870 | loss 1.5773 | lr 3.00e-04 | grad 2.14 | tok/s 15979
step   1880 | loss 1.4230 | lr 3.00e-04 | grad 1.29 | tok/s 15643
step   1890 | loss 1.6829 | lr 3.00e-04 | grad 1.16 | tok/s 14884
step   1900 | loss 1.5247 | lr 3.00e-04 | grad 1.48 | tok/s 16060
step   1910 | loss 1.5806 | lr 3.00e-04 | grad 1.41 | tok/s 15245
step   1920 | loss 1.5649 | lr 3.00e-04 | grad 1.38 | tok/s 16703
step   1930 | loss 1.5805 | lr 3.00e-04 | grad 1.44 | tok/s 15657
step   1940 | loss 1.5713 | lr 3.00e-04 | grad 1.33 | tok/s 16282
step   1950 | loss 2.1939 | lr 3.00e-04 | grad 1.97 | tok/s 16537
step   1960 | loss 1.9216 | lr 3.00e-04 | grad 2.06 | tok/s 16689
step   1970 | loss 1.7659 | lr 3.00e-04 | grad 1.60 | tok/s 16288
step   1980 | loss 1.7119 | lr 3.00e-04 | grad 1.25 | tok/s 15599
step   1990 | loss 1.7561 | lr 3.00e-04 | grad 5.22 | tok/s 15893
step   2000 | loss 1.6182 | lr 3.00e-04 | grad 1.41 | tok/s 16094
  >>> saved checkpoint: checkpoint_step_002000_loss_1.6182.pt
step   2010 | loss 1.1807 | lr 3.00e-04 | grad 1.20 | tok/s 7240
step   2020 | loss 1.4424 | lr 3.00e-04 | grad 1.34 | tok/s 16009
step   2030 | loss 1.3012 | lr 3.00e-04 | grad 0.50 | tok/s 16864
step   2040 | loss 1.5147 | lr 3.00e-04 | grad 1.15 | tok/s 16776
step   2050 | loss 1.4933 | lr 3.00e-04 | grad 1.32 | tok/s 16435
step   2060 | loss 1.7009 | lr 3.00e-04 | grad 1.28 | tok/s 15493
step   2070 | loss 1.7804 | lr 3.00e-04 | grad 1.69 | tok/s 16068
step   2080 | loss 2.3845 | lr 3.00e-04 | grad 2.81 | tok/s 16624
step   2090 | loss 1.8969 | lr 3.00e-04 | grad 2.05 | tok/s 16645
step   2100 | loss 1.5819 | lr 3.00e-04 | grad 1.69 | tok/s 16219
step   2110 | loss 1.7535 | lr 3.00e-04 | grad 6.62 | tok/s 15904
step   2120 | loss 1.0950 | lr 3.00e-04 | grad 1.43 | tok/s 16497
step   2130 | loss 1.2142 | lr 3.00e-04 | grad 1.99 | tok/s 16457
step   2140 | loss 1.6635 | lr 3.00e-04 | grad 1.27 | tok/s 15921
step   2150 | loss 1.4146 | lr 3.00e-04 | grad 1.36 | tok/s 16710
step   2160 | loss 1.3217 | lr 3.00e-04 | grad 1.21 | tok/s 16727
step   2170 | loss 1.3696 | lr 3.00e-04 | grad 1.09 | tok/s 16709
step   2180 | loss 1.3246 | lr 3.00e-04 | grad 1.32 | tok/s 16708
step   2190 | loss 1.3315 | lr 3.00e-04 | grad 1.08 | tok/s 16693
step   2200 | loss 1.3305 | lr 3.00e-04 | grad 1.24 | tok/s 16692
step   2210 | loss 1.2672 | lr 3.00e-04 | grad 1.08 | tok/s 16692
step   2220 | loss 1.2670 | lr 3.00e-04 | grad 1.30 | tok/s 16692
step   2230 | loss 1.4663 | lr 3.00e-04 | grad 1.23 | tok/s 16383
step   2240 | loss 1.4983 | lr 3.00e-04 | grad 1.27 | tok/s 16665
step   2250 | loss 1.7660 | lr 3.00e-04 | grad 2.27 | tok/s 16077
step   2260 | loss 1.7701 | lr 3.00e-04 | grad 1.24 | tok/s 16269
step   2270 | loss 2.0810 | lr 3.00e-04 | grad 2.28 | tok/s 16550
step   2280 | loss 1.6655 | lr 3.00e-04 | grad 1.41 | tok/s 16486
step   2290 | loss 1.4932 | lr 3.00e-04 | grad 1.56 | tok/s 16100
step   2300 | loss 2.1394 | lr 3.00e-04 | grad 3.48 | tok/s 16459
step   2310 | loss 1.6406 | lr 3.00e-04 | grad 1.24 | tok/s 15617
step   2320 | loss 1.7515 | lr 3.00e-04 | grad 3.16 | tok/s 15675
step   2330 | loss 1.8645 | lr 3.00e-04 | grad 1.69 | tok/s 15948
step   2340 | loss 1.5777 | lr 3.00e-04 | grad 3.41 | tok/s 15515
step   2350 | loss 1.4871 | lr 3.00e-04 | grad 2.64 | tok/s 16310
step   2360 | loss 1.5061 | lr 3.00e-04 | grad 1.48 | tok/s 16523
step   2370 | loss 1.6178 | lr 3.00e-04 | grad 2.12 | tok/s 16346
step   2380 | loss 1.7723 | lr 3.00e-04 | grad 1.33 | tok/s 16727

Training complete! Final step: 2382
