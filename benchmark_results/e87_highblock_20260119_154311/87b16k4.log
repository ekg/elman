Using device: cuda
Output directory: benchmark_results/e87_highblock_20260119_154311/87b16k4/level87b16k4_100m_20260119_154317
Auto r_h_mode: none (level 0 has bounded/no W_h)
Model: Level 87b16k4, 63,022,976 parameters

Starting training from step 0...
Batch size: 32, Chunk size: 512
Gradient accumulation: 1, Effective batch: 32

Time-based training: 10.0 minutes
step     10 | loss 5.1305 | lr 1.00e-06 | grad 11.00 | tok/s 21552
step     20 | loss 4.2498 | lr 1.00e-06 | grad 10.62 | tok/s 61732
step     30 | loss 5.2490 | lr 1.00e-06 | grad 3.91 | tok/s 65167
step     40 | loss 4.5080 | lr 1.00e-06 | grad 4.22 | tok/s 65436
step     50 | loss 4.2208 | lr 1.00e-06 | grad 5.50 | tok/s 65282
step     60 | loss 4.0145 | lr 1.00e-06 | grad 2.28 | tok/s 64133
step     70 | loss 3.2141 | lr 1.00e-06 | grad 2.20 | tok/s 61788
step     80 | loss 3.6040 | lr 1.00e-06 | grad 6.66 | tok/s 63910
step     90 | loss 3.3986 | lr 1.00e-06 | grad 4.78 | tok/s 61363
step    100 | loss 3.0873 | lr 1.00e-06 | grad 2.52 | tok/s 62252
step    110 | loss 2.9726 | lr 1.00e-06 | grad 2.67 | tok/s 61338
step    120 | loss 3.2671 | lr 1.00e-06 | grad 2.50 | tok/s 60185
step    130 | loss 2.9730 | lr 1.00e-06 | grad 2.02 | tok/s 61456
step    140 | loss 2.7277 | lr 1.00e-06 | grad 1.19 | tok/s 61542
step    150 | loss 2.6205 | lr 1.00e-06 | grad 2.89 | tok/s 58696
step    160 | loss 2.5179 | lr 1.00e-06 | grad 1.50 | tok/s 59131
step    170 | loss 2.7064 | lr 1.00e-06 | grad 4.84 | tok/s 61052
step    180 | loss 2.7694 | lr 1.00e-06 | grad 1.55 | tok/s 61024
step    190 | loss 2.5091 | lr 1.00e-06 | grad 1.53 | tok/s 61805
step    200 | loss 2.3814 | lr 1.00e-06 | grad 1.54 | tok/s 63170
step    210 | loss 2.6208 | lr 1.00e-06 | grad 2.39 | tok/s 60608
step    220 | loss 2.6119 | lr 1.00e-06 | grad 1.15 | tok/s 62323
step    230 | loss 2.4202 | lr 1.00e-06 | grad 1.76 | tok/s 60287
step    240 | loss 2.4859 | lr 1.00e-06 | grad 1.89 | tok/s 61479
step    250 | loss 2.4194 | lr 1.00e-06 | grad 1.71 | tok/s 60545
step    260 | loss 2.3957 | lr 1.00e-06 | grad 1.02 | tok/s 57695
step    270 | loss 2.3073 | lr 1.00e-06 | grad 2.31 | tok/s 59864
step    280 | loss 2.2320 | lr 1.00e-06 | grad 1.84 | tok/s 59894
step    290 | loss 2.1715 | lr 1.00e-06 | grad 1.21 | tok/s 63040
step    300 | loss 2.0907 | lr 1.00e-06 | grad 1.43 | tok/s 63315
step    310 | loss 2.0469 | lr 1.00e-06 | grad 1.73 | tok/s 63232
step    320 | loss 2.2037 | lr 1.00e-06 | grad 2.47 | tok/s 60751
step    330 | loss 2.2826 | lr 1.00e-06 | grad 1.10 | tok/s 59260
step    340 | loss 2.2882 | lr 1.00e-06 | grad 1.93 | tok/s 60586
step    350 | loss 2.2721 | lr 1.00e-06 | grad 1.31 | tok/s 58750
step    360 | loss 2.2593 | lr 1.00e-06 | grad 2.94 | tok/s 59591
step    370 | loss 2.1285 | lr 1.00e-06 | grad 1.29 | tok/s 60737
step    380 | loss 2.6396 | lr 1.00e-06 | grad 1.38 | tok/s 62260
step    390 | loss 2.1860 | lr 1.00e-06 | grad 1.29 | tok/s 59911
step    400 | loss 2.3037 | lr 1.00e-06 | grad 4.19 | tok/s 61494
step    410 | loss 2.0415 | lr 1.00e-06 | grad 2.19 | tok/s 59548
step    420 | loss 2.1529 | lr 1.00e-06 | grad 1.52 | tok/s 59232
step    430 | loss 2.3272 | lr 1.00e-06 | grad 1.89 | tok/s 59018
step    440 | loss 2.4970 | lr 1.00e-06 | grad 3.88 | tok/s 60998
step    450 | loss 2.1470 | lr 1.00e-06 | grad 1.23 | tok/s 59705
step    460 | loss 2.1288 | lr 1.00e-06 | grad 1.03 | tok/s 59924
step    470 | loss 2.1192 | lr 1.00e-06 | grad 1.52 | tok/s 60683
step    480 | loss 2.0447 | lr 1.00e-06 | grad 0.91 | tok/s 58693
step    490 | loss 1.9566 | lr 1.00e-06 | grad 0.86 | tok/s 59823
step    500 | loss 2.8698 | lr 1.00e-06 | grad 1.75 | tok/s 61406
step    510 | loss 2.0400 | lr 1.00e-06 | grad 1.42 | tok/s 60104
step    520 | loss 2.0510 | lr 1.00e-06 | grad 1.22 | tok/s 61877
step    530 | loss 2.5154 | lr 1.00e-06 | grad 1.70 | tok/s 60656
step    540 | loss 2.0841 | lr 1.00e-06 | grad 1.59 | tok/s 60599
step    550 | loss 1.9205 | lr 1.00e-06 | grad 0.89 | tok/s 62274
step    560 | loss 1.7586 | lr 1.00e-06 | grad 0.75 | tok/s 63175
step    570 | loss 2.1044 | lr 1.00e-06 | grad 2.42 | tok/s 61642
step    580 | loss 2.4237 | lr 1.00e-06 | grad 1.12 | tok/s 60906
step    590 | loss 2.6120 | lr 1.00e-06 | grad 1.53 | tok/s 59605
step    600 | loss 2.1069 | lr 1.00e-06 | grad 1.60 | tok/s 59819
step    610 | loss 2.1738 | lr 1.00e-06 | grad 1.42 | tok/s 62729
step    620 | loss 2.0137 | lr 1.00e-06 | grad 1.28 | tok/s 59408
step    630 | loss 1.9731 | lr 1.00e-06 | grad 1.05 | tok/s 61349
step    640 | loss 2.4431 | lr 1.00e-06 | grad 1.28 | tok/s 61387
step    650 | loss 2.0121 | lr 1.00e-06 | grad 1.50 | tok/s 60378
step    660 | loss 2.3239 | lr 1.00e-06 | grad 4.91 | tok/s 59584
step    670 | loss 2.1690 | lr 1.00e-06 | grad 1.96 | tok/s 61749
step    680 | loss 2.1272 | lr 1.00e-06 | grad 1.34 | tok/s 59653
step    690 | loss 2.1317 | lr 1.00e-06 | grad 1.24 | tok/s 60273
step    700 | loss 2.1860 | lr 1.00e-06 | grad 1.30 | tok/s 60540
step    710 | loss 2.1259 | lr 1.00e-06 | grad 1.70 | tok/s 60883
step    720 | loss 2.1466 | lr 1.00e-06 | grad 3.77 | tok/s 60552
step    730 | loss 2.2204 | lr 1.00e-06 | grad 1.44 | tok/s 60979
step    740 | loss 2.1070 | lr 1.00e-06 | grad 2.41 | tok/s 60660
step    750 | loss 1.9212 | lr 1.00e-06 | grad 1.51 | tok/s 59996
step    760 | loss 2.3122 | lr 1.00e-06 | grad 0.93 | tok/s 60623
step    770 | loss 1.9264 | lr 1.00e-06 | grad 1.31 | tok/s 60344
step    780 | loss 1.9810 | lr 1.00e-06 | grad 1.67 | tok/s 60851
step    790 | loss 1.9642 | lr 1.00e-06 | grad 1.12 | tok/s 61132
step    800 | loss 1.9420 | lr 1.00e-06 | grad 1.11 | tok/s 61561
step    810 | loss 2.0156 | lr 1.00e-06 | grad 2.47 | tok/s 60939
step    820 | loss 2.6818 | lr 1.00e-06 | grad 2.33 | tok/s 62264
step    830 | loss 2.3597 | lr 1.00e-06 | grad 1.16 | tok/s 63195
step    840 | loss 2.0625 | lr 1.00e-06 | grad 0.98 | tok/s 63275
step    850 | loss 2.3689 | lr 1.00e-06 | grad 1.61 | tok/s 60395
step    860 | loss 2.0968 | lr 1.00e-06 | grad 1.14 | tok/s 59117
step    870 | loss 2.0145 | lr 1.00e-06 | grad 1.09 | tok/s 60824
step    880 | loss 2.0613 | lr 1.00e-06 | grad 1.35 | tok/s 60599
step    890 | loss 1.9160 | lr 1.00e-06 | grad 0.95 | tok/s 60311
step    900 | loss 2.3979 | lr 1.00e-06 | grad 1.08 | tok/s 58826
step    910 | loss 1.9468 | lr 1.00e-06 | grad 1.06 | tok/s 60105
step    920 | loss 1.9068 | lr 1.00e-06 | grad 0.88 | tok/s 59625
step    930 | loss 2.0023 | lr 1.00e-06 | grad 1.43 | tok/s 59554
step    940 | loss 1.9045 | lr 1.00e-06 | grad 1.48 | tok/s 59190
step    950 | loss 1.9982 | lr 1.00e-06 | grad 1.51 | tok/s 60531
step    960 | loss 1.7774 | lr 1.00e-06 | grad 0.80 | tok/s 63209
step    970 | loss 1.6059 | lr 1.00e-06 | grad 0.62 | tok/s 63395
step    980 | loss 1.7867 | lr 1.00e-06 | grad 2.17 | tok/s 61691
step    990 | loss 2.1171 | lr 1.00e-06 | grad 0.97 | tok/s 60073
step   1000 | loss 1.9537 | lr 1.00e-06 | grad 0.77 | tok/s 58656
  >>> saved checkpoint: checkpoint_step_001000_loss_1.9537.pt
step   1010 | loss 2.2258 | lr 1.00e-06 | grad 1.61 | tok/s 52286
step   1020 | loss 1.8821 | lr 1.00e-06 | grad 0.94 | tok/s 60247
step   1030 | loss 2.2192 | lr 1.00e-06 | grad 0.92 | tok/s 59263
step   1040 | loss 1.8437 | lr 1.00e-06 | grad 1.48 | tok/s 60371
step   1050 | loss 1.8700 | lr 1.00e-06 | grad 0.96 | tok/s 60728
step   1060 | loss 2.1630 | lr 1.00e-06 | grad 1.66 | tok/s 60791
step   1070 | loss 2.2268 | lr 1.00e-06 | grad 1.04 | tok/s 60950
step   1080 | loss 2.5354 | lr 1.00e-06 | grad 1.45 | tok/s 60156
step   1090 | loss 2.2607 | lr 1.00e-06 | grad 1.31 | tok/s 60707
step   1100 | loss 1.9420 | lr 1.00e-06 | grad 1.16 | tok/s 60347
step   1110 | loss 1.9808 | lr 1.00e-06 | grad 0.93 | tok/s 61333
step   1120 | loss 2.1340 | lr 1.00e-06 | grad 1.12 | tok/s 61877
step   1130 | loss 1.9478 | lr 1.00e-06 | grad 0.76 | tok/s 58897
step   1140 | loss 1.8027 | lr 1.00e-06 | grad 1.05 | tok/s 60508
step   1150 | loss 2.1103 | lr 1.00e-06 | grad 1.30 | tok/s 60403
step   1160 | loss 1.7656 | lr 1.00e-06 | grad 0.77 | tok/s 59669
step   1170 | loss 2.0420 | lr 1.00e-06 | grad 0.84 | tok/s 60451
step   1180 | loss 1.7940 | lr 1.00e-06 | grad 0.88 | tok/s 63463
step   1190 | loss 1.6824 | lr 1.00e-06 | grad 0.74 | tok/s 63460
step   1200 | loss 1.6047 | lr 1.00e-06 | grad 0.73 | tok/s 63341
step   1210 | loss 1.5699 | lr 1.00e-06 | grad 0.82 | tok/s 63261
step   1220 | loss 1.6086 | lr 1.00e-06 | grad 1.01 | tok/s 62968
step   1230 | loss 1.7661 | lr 1.00e-06 | grad 1.20 | tok/s 60834
step   1240 | loss 1.8634 | lr 1.00e-06 | grad 0.99 | tok/s 59700
step   1250 | loss 1.9515 | lr 1.00e-06 | grad 3.30 | tok/s 61510
step   1260 | loss 1.9942 | lr 1.00e-06 | grad 2.25 | tok/s 61238
step   1270 | loss 2.0658 | lr 1.00e-06 | grad 1.38 | tok/s 60547
step   1280 | loss 1.9048 | lr 1.00e-06 | grad 0.92 | tok/s 60040
step   1290 | loss 1.8319 | lr 1.00e-06 | grad 0.99 | tok/s 59743
step   1300 | loss 1.8921 | lr 1.00e-06 | grad 0.97 | tok/s 59482
step   1310 | loss 1.9774 | lr 1.00e-06 | grad 0.93 | tok/s 59381
step   1320 | loss 1.9199 | lr 1.00e-06 | grad 1.27 | tok/s 60312
step   1330 | loss 1.8548 | lr 1.00e-06 | grad 1.04 | tok/s 60566
step   1340 | loss 1.8314 | lr 1.00e-06 | grad 1.09 | tok/s 60605
step   1350 | loss 1.8739 | lr 1.00e-06 | grad 1.95 | tok/s 62149
step   1360 | loss 1.7760 | lr 1.00e-06 | grad 0.80 | tok/s 59048
step   1370 | loss 1.8867 | lr 1.00e-06 | grad 0.79 | tok/s 59884
step   1380 | loss 1.9573 | lr 1.00e-06 | grad 1.02 | tok/s 60239
step   1390 | loss 1.8337 | lr 1.00e-06 | grad 1.40 | tok/s 58909
step   1400 | loss 1.8844 | lr 1.00e-06 | grad 6.09 | tok/s 61346
step   1410 | loss 1.9183 | lr 1.00e-06 | grad 1.15 | tok/s 61772
step   1420 | loss 1.9286 | lr 1.00e-06 | grad 0.96 | tok/s 58905
step   1430 | loss 1.7176 | lr 1.00e-06 | grad 0.84 | tok/s 57657
step   1440 | loss 1.6526 | lr 1.00e-06 | grad 0.82 | tok/s 60730
step   1450 | loss 1.7281 | lr 1.00e-06 | grad 2.22 | tok/s 61924
step   1460 | loss 1.7856 | lr 1.00e-06 | grad 0.81 | tok/s 57954
step   1470 | loss 1.8874 | lr 1.00e-06 | grad 2.11 | tok/s 60024
step   1480 | loss 1.7888 | lr 1.00e-06 | grad 2.23 | tok/s 60711
step   1490 | loss 1.9427 | lr 1.00e-06 | grad 2.52 | tok/s 60572
step   1500 | loss 2.0328 | lr 1.00e-06 | grad 2.16 | tok/s 59018
step   1510 | loss 1.9226 | lr 1.00e-06 | grad 1.36 | tok/s 62027
step   1520 | loss 1.8858 | lr 1.00e-06 | grad 1.11 | tok/s 61287
step   1530 | loss 1.8363 | lr 1.00e-06 | grad 0.93 | tok/s 60906
step   1540 | loss 1.7956 | lr 1.00e-06 | grad 0.79 | tok/s 59843
step   1550 | loss 1.7905 | lr 1.00e-06 | grad 2.84 | tok/s 61894
step   1560 | loss 2.3925 | lr 1.00e-06 | grad 1.24 | tok/s 60597
step   1570 | loss 1.8105 | lr 1.00e-06 | grad 1.23 | tok/s 59531
step   1580 | loss 1.9945 | lr 1.00e-06 | grad 1.22 | tok/s 61412
step   1590 | loss 1.7242 | lr 1.00e-06 | grad 0.90 | tok/s 59980
step   1600 | loss 1.8034 | lr 1.00e-06 | grad 1.05 | tok/s 58773
step   1610 | loss 1.6480 | lr 1.00e-06 | grad 0.81 | tok/s 62374
step   1620 | loss 1.8079 | lr 1.00e-06 | grad 0.80 | tok/s 61334
step   1630 | loss 1.8345 | lr 1.00e-06 | grad 1.14 | tok/s 61867
step   1640 | loss 1.7329 | lr 1.00e-06 | grad 0.71 | tok/s 59840
step   1650 | loss 1.7651 | lr 1.00e-06 | grad 1.32 | tok/s 58890
step   1660 | loss 1.7650 | lr 1.00e-06 | grad 0.92 | tok/s 59117
step   1670 | loss 1.8326 | lr 1.00e-06 | grad 1.94 | tok/s 61791
step   1680 | loss 2.2744 | lr 1.00e-06 | grad 0.76 | tok/s 61765
step   1690 | loss 1.7699 | lr 1.00e-06 | grad 1.12 | tok/s 60379
step   1700 | loss 2.1793 | lr 1.00e-06 | grad 0.98 | tok/s 61521
step   1710 | loss 1.8649 | lr 1.00e-06 | grad 1.10 | tok/s 59675
step   1720 | loss 1.8593 | lr 1.00e-06 | grad 1.07 | tok/s 59896
step   1730 | loss 1.9741 | lr 1.00e-06 | grad 1.02 | tok/s 60085
step   1740 | loss 1.8185 | lr 1.00e-06 | grad 0.80 | tok/s 60891
step   1750 | loss 1.7370 | lr 1.00e-06 | grad 0.78 | tok/s 58967
step   1760 | loss 2.0128 | lr 1.00e-06 | grad 0.80 | tok/s 59415
step   1770 | loss 1.8890 | lr 1.00e-06 | grad 0.77 | tok/s 60997
step   1780 | loss 1.7605 | lr 1.00e-06 | grad 1.17 | tok/s 58733
step   1790 | loss 1.9691 | lr 1.00e-06 | grad 0.85 | tok/s 59868
step   1800 | loss 1.6763 | lr 1.00e-06 | grad 0.75 | tok/s 60930
step   1810 | loss 1.7783 | lr 1.00e-06 | grad 1.04 | tok/s 60493
step   1820 | loss 1.7195 | lr 1.00e-06 | grad 0.97 | tok/s 60018
step   1830 | loss 1.7388 | lr 1.00e-06 | grad 0.80 | tok/s 59866
step   1840 | loss 1.7182 | lr 1.00e-06 | grad 1.02 | tok/s 59277
step   1850 | loss 1.9517 | lr 1.00e-06 | grad 1.20 | tok/s 59858
step   1860 | loss 1.7245 | lr 1.00e-06 | grad 0.66 | tok/s 59733
step   1870 | loss 1.7680 | lr 1.00e-06 | grad 1.45 | tok/s 60995
step   1880 | loss 1.7302 | lr 1.00e-06 | grad 0.80 | tok/s 61153
step   1890 | loss 1.8651 | lr 1.00e-06 | grad 0.81 | tok/s 60038
step   1900 | loss 1.8639 | lr 1.00e-06 | grad 1.03 | tok/s 60723
step   1910 | loss 1.8754 | lr 1.00e-06 | grad 1.49 | tok/s 60047
step   1920 | loss 1.7421 | lr 1.00e-06 | grad 0.91 | tok/s 61790
step   1930 | loss 1.7308 | lr 1.00e-06 | grad 1.13 | tok/s 61198
step   1940 | loss 1.6473 | lr 1.00e-06 | grad 0.94 | tok/s 62418
step   1950 | loss 1.7729 | lr 1.00e-06 | grad 0.98 | tok/s 60692
step   1960 | loss 2.1649 | lr 1.00e-06 | grad 4.50 | tok/s 62122
step   1970 | loss 1.8265 | lr 1.00e-06 | grad 1.52 | tok/s 59735
step   1980 | loss 1.8142 | lr 1.00e-06 | grad 2.27 | tok/s 59790
step   1990 | loss 1.9398 | lr 1.00e-06 | grad 1.12 | tok/s 60749
step   2000 | loss 1.8028 | lr 1.00e-06 | grad 1.28 | tok/s 61942
  >>> saved checkpoint: checkpoint_step_002000_loss_1.8028.pt
step   2010 | loss 1.5741 | lr 1.00e-06 | grad 0.76 | tok/s 51979
step   2020 | loss 1.4393 | lr 1.00e-06 | grad 0.68 | tok/s 63453
step   2030 | loss 1.7545 | lr 1.00e-06 | grad 1.04 | tok/s 63158
step   2040 | loss 1.5746 | lr 1.00e-06 | grad 0.70 | tok/s 63711
step   2050 | loss 1.5230 | lr 1.00e-06 | grad 1.06 | tok/s 62815
step   2060 | loss 1.8218 | lr 1.00e-06 | grad 0.93 | tok/s 60077
step   2070 | loss 1.7612 | lr 1.00e-06 | grad 1.42 | tok/s 62980
step   2080 | loss 1.9155 | lr 1.00e-06 | grad 3.03 | tok/s 59693
step   2090 | loss 1.8072 | lr 1.00e-06 | grad 0.94 | tok/s 61771
step   2100 | loss 1.7630 | lr 1.00e-06 | grad 0.92 | tok/s 60034
step   2110 | loss 1.5525 | lr 1.00e-06 | grad 0.73 | tok/s 62080
step   2120 | loss 1.6396 | lr 1.00e-06 | grad 1.20 | tok/s 61502
step   2130 | loss 1.7520 | lr 1.00e-06 | grad 2.80 | tok/s 59621
step   2140 | loss 1.8105 | lr 1.00e-06 | grad 2.80 | tok/s 59655
step   2150 | loss 1.8272 | lr 1.00e-06 | grad 0.78 | tok/s 60474
step   2160 | loss 1.7646 | lr 1.00e-06 | grad 0.81 | tok/s 59855
step   2170 | loss 1.8862 | lr 1.00e-06 | grad 0.82 | tok/s 60597
step   2180 | loss 1.7520 | lr 1.00e-06 | grad 0.83 | tok/s 61727
step   2190 | loss 2.0905 | lr 1.00e-06 | grad 0.87 | tok/s 61419
step   2200 | loss 1.5047 | lr 1.00e-06 | grad 0.62 | tok/s 63586
step   2210 | loss 1.4852 | lr 1.00e-06 | grad 0.57 | tok/s 63584
step   2220 | loss 1.4432 | lr 1.00e-06 | grad 0.63 | tok/s 63552
step   2230 | loss 1.6887 | lr 1.00e-06 | grad 1.05 | tok/s 61387
step   2240 | loss 1.9622 | lr 1.00e-06 | grad 1.76 | tok/s 62640
step   2250 | loss 1.8944 | lr 1.00e-06 | grad 1.11 | tok/s 62187
step   2260 | loss 1.9202 | lr 1.00e-06 | grad 1.17 | tok/s 61394
step   2270 | loss 1.7346 | lr 1.00e-06 | grad 1.24 | tok/s 60091
step   2280 | loss 1.8518 | lr 1.00e-06 | grad 0.78 | tok/s 59973
step   2290 | loss 1.7099 | lr 1.00e-06 | grad 0.96 | tok/s 60809
step   2300 | loss 1.6679 | lr 1.00e-06 | grad 0.97 | tok/s 58820

Training complete! Final step: 2302
