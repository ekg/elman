/home/erikg/.local/lib/python3.12/site-packages/cma/s.py:15: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Starting from known best config: {'expansion': 2, 'depth': 20}
Encoded x0: ['0.333', '0.286']
======================================================================
CMA-ES Search for MINGRU
======================================================================
Search space (2 dimensions):
  expansion: [1, 4] (int) - Expansion factor
  depth: [12, 40] (int) - Number of layers
Target params: 480M Â± 30M
Training time per config: 10.0 min
Generations: 15
Population: 8
GPUs: [0, 1, 2, 3, 4, 5, 6, 7] (8 parallel)
Total evaluations: ~120
Estimated time: ~150 min (2.5 hours)
======================================================================
(4_w,8)-aCMA-ES (mu_w=2.6,w_1=52%) in dimension 2 (seed=534564, Mon Jan 26 20:14:33 2026)

--- Generation 1/15 ---
  [Eval 2] Skip - params 523.7M vs target 480M
  [Eval 5] Skip - params 443.4M vs target 480M
  [Eval 8] GPU 7 | expansion=3, depth=18 | dim=1024 | 453.2M params
  [Eval 8] Loss: 2.1581
  [Eval 7] GPU 6 | expansion=2, depth=19 | dim=1408 | 452.4M params
  [Eval 7] Loss: 2.1206
  [Eval 6] Skip - params 430.3M vs target 480M
  [Eval 4] GPU 3 | expansion=2, depth=14 | dim=1664 | 465.6M params
  [Eval 4] Loss: 2.1007
  [Eval 3] GPU 2 | expansion=3, depth=12 | dim=1280 | 472.2M params
  [Eval 3] Loss: 2.0938
  [Eval 1] GPU 0 | expansion=2, depth=20 | dim=1408 | 476.2M params
  [Eval 1] Loss: 2.1383
  *** NEW BEST: 2.1383 | {'expansion': 2, 'depth': 20} | dim=1408 ***
  *** NEW BEST: 2.0938 | {'expansion': 3, 'depth': 12} | dim=1280 ***
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      8 2.093765000000000e+00 1.0e+00 2.26e-01  2e-01  2e-01 10:12.7

--- Generation 2/15 ---
  [Eval 15] GPU 6 | expansion=3, depth=24 | dim=896 | 462.7M params
  [Eval 15] Loss: 2.2168
  [Eval 12] Skip - params 511.5M vs target 480M
  [Eval 14] GPU 5 | expansion=3, depth=15 | dim=1152 | 478.1M params
  [Eval 14] Loss: 2.1352
  [Eval 9] GPU 0 | expansion=3, depth=15 | dim=1152 | 478.1M params
  [Eval 9] Loss: 2.1412
  [Eval 13] GPU 4 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 13] Loss: 2.0936
  [Eval 11] GPU 2 | expansion=3, depth=18 | dim=1024 | 453.2M params
  [Eval 11] Loss: 2.1581
  [Eval 10] GPU 1 | expansion=2, depth=21 | dim=1408 | 499.9M params
  [Eval 10] Loss: 1.9357
  [Eval 16] GPU 7 | expansion=2, depth=20 | dim=1408 | 476.2M params
  [Eval 16] Loss: 2.1362
  *** NEW BEST: 1.9357 | {'expansion': 2, 'depth': 21} | dim=1408 ***
    2     16 1.935712000000000e+00 1.3e+00 1.90e-01  2e-01  2e-01 20:26.9

--- Generation 3/15 ---
  [Eval 23] Skip - params 510.0M vs target 480M
  [Eval 17] GPU 0 | expansion=3, depth=15 | dim=1152 | 478.1M params
  [Eval 17] Loss: 2.1370
  [Eval 18] Skip - params 511.5M vs target 480M
  [Eval 22] GPU 5 | expansion=3, depth=12 | dim=1280 | 472.2M params
  [Eval 22] Loss: 2.0938
  [Eval 20] GPU 3 | expansion=3, depth=12 | dim=1280 | 472.2M params
  [Eval 20] Loss: 2.0912
  [Eval 24] GPU 7 | expansion=2, depth=14 | dim=1664 | 465.6M params
  [Eval 24] Loss: 2.1007
  [Eval 21] GPU 4 | expansion=2, depth=13 | dim=1792 | 501.4M params
  [Eval 21] Loss: 1.9049
  [Eval 19] GPU 2 | expansion=2, depth=13 | dim=1792 | 501.4M params
  [Eval 19] Loss: 1.9051
  *** NEW BEST: 1.9051 | {'expansion': 2, 'depth': 13} | dim=1792 ***
  *** NEW BEST: 1.9049 | {'expansion': 2, 'depth': 13} | dim=1792 ***
    3     24 1.904862000000000e+00 1.5e+00 1.84e-01  1e-01  2e-01 30:39.9

--- Generation 4/15 ---
  [Eval 26] Skip - params 511.5M vs target 480M
  [Eval 25] GPU 0 | expansion=2, depth=14 | dim=1664 | 465.6M params
  [Eval 25] Loss: 2.1099
  [Eval 29] GPU 4 | expansion=3, depth=15 | dim=1152 | 478.1M params
  [Eval 29] Loss: 2.1370
  [Eval 31] GPU 6 | expansion=3, depth=12 | dim=1280 | 472.2M params
  [Eval 31] Loss: 2.0957
  [Eval 28] GPU 3 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 28] Loss: 2.0906
  [Eval 27] GPU 2 | expansion=2, depth=17 | dim=1536 | 481.7M params
  [Eval 27] Loss: 1.9259
  [Eval 30] GPU 5 | expansion=2, depth=13 | dim=1792 | 501.4M params
  [Eval 30] Loss: 1.9004
  [Eval 32] GPU 7 | expansion=2, depth=15 | dim=1664 | 498.8M params
  [Eval 32] Loss: 1.9007
  *** NEW BEST: 1.9004 | {'expansion': 2, 'depth': 13} | dim=1792 ***
    4     32 1.900433000000000e+00 1.4e+00 2.58e-01  2e-01  3e-01 40:53.3

--- Generation 5/15 ---
  [Eval 33] GPU 0 | expansion=2, depth=17 | dim=1536 | 481.7M params
  [Eval 33] Loss: 1.9213
  [Eval 35] Skip - params 511.5M vs target 480M
  [Eval 36] GPU 3 | expansion=1, depth=20 | dim=2432 | 473.8M params
  [Eval 36] Loss: 1.7324
  [Eval 39] GPU 6 | expansion=1, depth=19 | dim=2560 | 498.7M params
  [Eval 39] Loss: 1.5709
  [Eval 40] GPU 7 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 40] Loss: 1.7126
  [Eval 37] GPU 4 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 37] Loss: 1.7132
  [Eval 38] GPU 5 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 38] Loss: 1.5470
  [Eval 34] GPU 1 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 34] Loss: 1.5408
  *** NEW BEST: 1.5408 | {'expansion': 1, 'depth': 13} | dim=3072 ***
    5     40 1.540778000000000e+00 1.5e+00 3.01e-01  2e-01  3e-01 51:07.7

--- Generation 6/15 ---
  [Eval 43] Skip - params 446.2M vs target 480M
  [Eval 46] GPU 5 | expansion=3, depth=16 | dim=1152 | 509.9M params
  [Eval 46] Loss: 1.9603
  [Eval 47] GPU 6 | expansion=1, depth=22 | dim=2304 | 467.7M params
  [Eval 47] Loss: 1.7284
  [Eval 48] GPU 7 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 48] Loss: 2.0906
  [Eval 44] GPU 3 | expansion=2, depth=15 | dim=1664 | 498.8M params
  [Eval 44] Loss: 1.8961
  [Eval 41] GPU 0 | expansion=2, depth=13 | dim=1792 | 501.4M params
  [Eval 41] Loss: 1.9084
  [Eval 45] GPU 4 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 45] Loss: 1.7144
  [Eval 42] GPU 1 | expansion=2, depth=20 | dim=1408 | 476.2M params
  [Eval 42] Loss: 2.1323
    6     48 1.714401000000000e+00 1.6e+00 3.14e-01  2e-01  3e-01 61:21.0

--- Generation 7/15 ---
  [Eval 55] Skip - params 510.0M vs target 480M
  [Eval 50] GPU 1 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 50] Loss: 1.7047
  [Eval 56] GPU 7 | expansion=1, depth=20 | dim=2432 | 473.8M params
  [Eval 56] Loss: 1.7324
  [Eval 54] GPU 5 | expansion=2, depth=14 | dim=1664 | 465.6M params
  [Eval 54] Loss: 2.1007
  [Eval 53] GPU 4 | expansion=1, depth=19 | dim=2560 | 498.7M params
  [Eval 53] Loss: 1.5660
  [Eval 52] GPU 3 | expansion=1, depth=18 | dim=2560 | 472.5M params
  [Eval 52] Loss: 1.7232
  [Eval 51] GPU 2 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 51] Loss: 1.5331
  [Eval 49] GPU 0 | expansion=1, depth=17 | dim=2688 | 492.0M params
  [Eval 49] Loss: 1.5588
  *** NEW BEST: 1.5331 | {'expansion': 1, 'depth': 13} | dim=3072 ***
    7     56 1.533071000000000e+00 1.3e+00 2.86e-01  2e-01  2e-01 71:34.8

--- Generation 8/15 ---
  [Eval 58] GPU 1 | expansion=1, depth=20 | dim=2432 | 473.8M params
  [Eval 58] Loss: 1.7316
  [Eval 59] GPU 2 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 59] Loss: 2.0936
  [Eval 57] GPU 0 | expansion=2, depth=20 | dim=1408 | 476.2M params
  [Eval 57] Loss: 2.1383
  [Eval 61] GPU 4 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 61] Loss: 2.0936
  [Eval 60] GPU 3 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 60] Loss: 1.7126
  [Eval 63] GPU 6 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 63] Loss: 1.5465
  [Eval 64] GPU 7 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 64] Loss: 1.5500
  [Eval 62] GPU 5 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 62] Loss: 1.5430
    8     64 1.542992000000000e+00 1.1e+00 2.73e-01  2e-01  2e-01 81:49.3

--- Generation 9/15 ---
  [Eval 66] GPU 1 | expansion=1, depth=23 | dim=2304 | 489.0M params
  [Eval 66] Loss: 1.5660
  [Eval 70] GPU 5 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 70] Loss: 1.7144
  [Eval 65] GPU 0 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 65] Loss: 1.7132
  [Eval 71] GPU 6 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 71] Loss: 1.7144
  [Eval 72] GPU 7 | expansion=1, depth=19 | dim=2560 | 498.7M params
  [Eval 72] Loss: 1.5606
  [Eval 68] GPU 3 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 68] Loss: 1.5430
  [Eval 69] GPU 4 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 69] Loss: 1.5476
  [Eval 67] GPU 2 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 67] Loss: 1.5325
  *** NEW BEST: 1.5325 | {'expansion': 1, 'depth': 14} | dim=2944 ***
    9     72 1.532475000000000e+00 1.1e+00 2.21e-01  1e-01  1e-01 92:05.6

--- Generation 10/15 ---
  [Eval 75] GPU 2 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 75] Loss: 1.7132
  [Eval 74] GPU 1 | expansion=1, depth=20 | dim=2432 | 473.8M params
  [Eval 74] Loss: 1.7363
  [Eval 73] GPU 0 | expansion=2, depth=20 | dim=1408 | 476.2M params
  [Eval 73] Loss: 2.1383
  [Eval 80] GPU 7 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 80] Loss: 1.5281
  [Eval 79] GPU 6 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 79] Loss: 1.5381
  [Eval 77] GPU 4 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 77] Loss: 1.7144
  [Eval 76] GPU 3 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 76] Loss: 1.5507
  [Eval 78] GPU 5 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 78] Loss: 1.5298
  *** NEW BEST: 1.5298 | {'expansion': 1, 'depth': 14} | dim=2944 ***
  *** NEW BEST: 1.5281 | {'expansion': 1, 'depth': 14} | dim=2944 ***
   10     80 1.528077000000000e+00 1.1e+00 2.07e-01  1e-01  1e-01 102:20.3

--- Generation 11/15 ---
  [Eval 81] GPU 0 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 81] Loss: 1.7132
  [Eval 85] GPU 4 | expansion=2, depth=13 | dim=1792 | 501.4M params
  [Eval 85] Loss: 1.9044
  [Eval 88] GPU 7 | expansion=2, depth=16 | dim=1536 | 453.4M params
  [Eval 88] Loss: 2.1234
  [Eval 83] GPU 2 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 83] Loss: 1.7143
  [Eval 87] GPU 6 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 87] Loss: 1.5407
  [Eval 86] GPU 5 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 86] Loss: 1.7113
  [Eval 84] GPU 3 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 84] Loss: 1.5486
  [Eval 82] GPU 1 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 82] Loss: 1.5425
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     88 1.540707000000000e+00 1.4e+00 2.92e-01  2e-01  2e-01 112:35.8

--- Generation 12/15 ---
  [Eval 95] Skip - params 510.0M vs target 480M
  [Eval 92] GPU 3 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 92] Loss: 2.0906
  [Eval 90] GPU 1 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 90] Loss: 1.7058
  [Eval 93] GPU 4 | expansion=2, depth=16 | dim=1536 | 453.4M params
  [Eval 93] Loss: 2.1208
  [Eval 89] GPU 0 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 89] Loss: 1.5382
  [Eval 94] GPU 5 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 94] Loss: 2.0906
  [Eval 91] GPU 2 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 91] Loss: 1.5300
  [Eval 96] GPU 7 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 96] Loss: 1.5430
   12     96 1.529976000000000e+00 1.3e+00 2.37e-01  1e-01  1e-01 122:50.3

--- Generation 13/15 ---
  [Eval 98] GPU 1 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 98] Loss: 1.7058
  [Eval 103] GPU 6 | expansion=1, depth=17 | dim=2688 | 492.0M params
  [Eval 103] Loss: 1.5526
  [Eval 102] GPU 5 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 102] Loss: 1.5369
  [Eval 104] GPU 7 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 104] Loss: 1.5369
  [Eval 97] GPU 0 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 97] Loss: 1.5318
  [Eval 100] GPU 3 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 100] Loss: 1.5422
  [Eval 101] GPU 4 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 101] Loss: 1.5325
  [Eval 99] GPU 2 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 99] Loss: 1.5465
   13    104 1.531810000000000e+00 1.3e+00 2.07e-01  1e-01  1e-01 133:05.8

--- Generation 14/15 ---
  [Eval 106] GPU 1 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 106] Loss: 2.0916
  [Eval 112] GPU 7 | expansion=2, depth=12 | dim=1792 | 462.9M params
  [Eval 112] Loss: 2.0906
  [Eval 109] GPU 4 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 109] Loss: 1.5467
  [Eval 110] GPU 5 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 110] Loss: 1.5482
  [Eval 111] GPU 6 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 111] Loss: 1.5412
  [Eval 107] GPU 2 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 107] Loss: 1.5325
  [Eval 108] GPU 3 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 108] Loss: 1.5370
  [Eval 105] GPU 0 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 105] Loss: 1.5325
   14    112 1.532475000000000e+00 1.1e+00 2.00e-01  9e-02  1e-01 143:22.6

--- Generation 15/15 ---
  [Eval 118] GPU 5 | expansion=1, depth=15 | dim=2816 | 476.5M params
  [Eval 118] Loss: 1.7046
  [Eval 117] GPU 4 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 117] Loss: 1.5301
  [Eval 119] GPU 6 | expansion=1, depth=14 | dim=2944 | 486.1M params
  [Eval 119] Loss: 1.5372
  [Eval 115] GPU 2 | expansion=1, depth=16 | dim=2688 | 463.1M params
  [Eval 115] Loss: 1.7143
  [Eval 116] GPU 3 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 116] Loss: 1.5422
  [Eval 113] GPU 0 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 113] Loss: 1.5300
  [Eval 114] GPU 1 | expansion=1, depth=12 | dim=3200 | 492.3M params
  [Eval 114] Loss: 1.5395
  [Eval 120] GPU 7 | expansion=1, depth=13 | dim=3072 | 491.5M params
  [Eval 120] Loss: 1.5421
   15    120 1.529976000000000e+00 1.4e+00 1.81e-01  7e-02  9e-02 153:36.6

======================================================================
SEARCH COMPLETE
======================================================================
Best loss: 1.5281
Best params: {'expansion': 1, 'depth': 14}
Total evaluations: 120

To train with best config:
python train.py --level mingru --dim 2944 --depth 14 --expansion 1 --lr 3e-4 --train_minutes 30
